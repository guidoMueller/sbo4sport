//Copyright (c) 2013 SAP AG, All Rights Reserved
(function(g){"use strict";sap.ui.core.Control.extend("SearchResultListWithDetail",{metadata:{properties:{},aggregations:{"resultList":{type:"sap.ui.core.Control",multiple:false},"preview":{type:"sap.ui.core.Control",multiple:false}}},renderer:function(r,c){r.write("<div");r.writeControlData(c);r.addClass("searchResultListWithDetail");r.writeClasses();r.write('>');r.write('<div class="searchLayout-left">');if(c.getResultList()){r.renderControl(c.getResultList())}r.write('</div>');r.write('<div');r.addClass("searchLayout-right");r.writeClasses();r.write('>');if(c.getPreview()){r.renderControl(c.getPreview())}r.write('</div>');r.write("</div>")},onAfterRendering:function(){var s=this;var p=$(this.getDomRef()).find('.searchResultListItemDetail');var h=$("#searchPage-cont")?$("#searchPage-cont").offset().top:$("#searchResultPage-cont").offset().top;var u=function(){if($("#searchResultPage-scroll").length>0||$("#searchPage-scroll").length>0){var r=$('.searchResultListWithDetail');if(r.length>0){if(r.offset().top-h<0){p.css('margin-top',-r.offset().top+h)}else{p.css('margin-top',0)}}}d()};var d=function(){if(s.lastScrollTimeout){window.clearTimeout(s.lastScrollTimeout)}s.lastScrollTimeout=setTimeout(function(){u()},1000)};$("#searchResultPage-cont").on("scroll",u);$("#searchResultPage-cont").bind('touchmove',function(e){e.preventDefault();u()});$("#searchPage-cont").on("scroll",u);$("#searchPage-cont").bind('touchmove',function(e){e.preventDefault();u()});u()}});sap.ui.core.Control.extend("SearchLayout",{metadata:{properties:{showMainHeader:{type:"boolean",defaultValue:false},enableNoResults:{type:"boolean",defaultValue:false},searchTerm:"string",topHeader:"string",topCount:"int",bottomHeader:"string",bottomHeaderIsUnspecific:{type:"boolean",defaultValue:true},bottomCount:"int",searchBusy:{type:"boolean",defaultValue:false},showBottomList:{type:"boolean",defaultValue:true}},aggregations:{"topList":{type:"sap.ui.core.Control",multiple:false},"bottomList":{type:"sap.ui.core.Control",multiple:false},"facets":{type:"sap.ui.core.Control",multiple:false}}},renderer:function(r,c){c.renderResultPage=false;c.renderNoResultPage=false;r.write("<div");r.writeControlData(c);r.addClass("searchLayout");r.writeClasses();r.write('>');this.busy=new sap.m.BusyIndicator({size:"50px"});this.busy.addStyleClass('searchBusyIcon');this.busy.addStyleClass('hidden');if(c.getSearchBusy()===true){this.busy.removeStyleClass('hidden');r.write("<div");r.addClass("searchBusy");r.writeClasses();r.write('>');r.renderControl(this.busy);r.write("</div>");r.write("<div");r.addClass("searchBusyBG");r.writeClasses();r.write('>');r.write("</div>");c.renderResultPage=false;c.renderNoResultPage=false}var t=0;if(c.getTopCount())t=t+c.getTopCount();if(c.getBottomCount())t=t+c.getBottomCount();var s=t===0&&c.getEnableNoResults();if(c.getShowMainHeader()===true&&c.getSearchBusy()===false){r.write('<div class="searchLayout-mainHeader">');r.renderControl((new sap.m.Label({text:sap.ushell.resources.i18n.getText("searchResults")})).addStyleClass('searchLayout-mainHeaderName'));r.renderControl((new sap.m.Label({text:'('+t+')'})).addStyleClass('searchLayout-mainHeaderCount'));r.write('</div>')}if(s&&c.getSearchBusy()===false){var e=$('<div>').text(c.getSearchTerm()).html();r.write('<div class="no-result"><div class="no-result-icon">');r.writeIcon(sap.ui.core.IconPool.getIconURI("travel-request"));r.write('</div><div class="no-result-text">');r.write('<div class="no-result-info">'+sap.ushell.resources.i18n.getText("no_results_info").replace('&1',e)+'</div>');r.write('<div class="no-result-tips">'+sap.ushell.resources.i18n.getText("no_results_tips")+'</div> ');r.write('</div></div>');c.renderNoResultPage=true;c.renderResultPage=false}if(c.getFacets()){r.write('<div class="searchLayout-facets">');r.renderControl(c.getFacets());r.write('</div>')}if(c.getTopList()&&c.getTopHeader()&&c.getSearchBusy()===false){r.write('<div class="searchLayout-bucket">');if(c.getTopHeader()&&c.getTopList()){r.renderControl((new sap.m.Label({text:c.getTopHeader()})).addStyleClass('searchLayout-bucketName'))}if(c.getTopCount())r.renderControl((new sap.m.Label({text:'('+c.getTopCount()+')'})).addStyleClass('searchLayout-bucketCount'));r.write('</div>')}if(c.getTopList()&&c.getSearchBusy()===false){r.renderControl(c.getTopList())}if(c.getShowBottomList()&&c.getBottomList()&&c.getBottomHeader()&&c.getSearchBusy()===false){if(c.getBottomHeaderIsUnspecific()===true&&c.getTopCount()===0||s){}else{r.write('<div class="searchLayout-bucket">');if(c.getBottomHeader()&&c.getBottomList())r.renderControl((new sap.m.Label({text:c.getBottomHeader()})).addStyleClass('searchLayout-bucketName'));if(c.getBottomCount())r.renderControl((new sap.m.Label({text:'('+c.getBottomCount()+')'})).addStyleClass('searchLayout-bucketCount'));r.write('</div>')}}if(c.getShowBottomList()&&c.getBottomList()){r.renderControl(c.getBottomList())}if(t!==0){c.renderResultPage=true}else{c.renderResultPage=false}r.write("</div>")}})}(window));
