// Copyright (c) 2013 SAP AG, All Rights Reserved
(function(){"use strict";sap.ui.core.Control.extend("SearchResultListItemDetail",{metadata:{properties:{itemTitle:"string",itemTitleUrl:"string",itemType:"string",itemData:"object",firstDetailAttribute:{type:"int",defaultValue:4},maxDetailAttributes:{type:"int",defaultValue:8}}},renderer:function(r,c){r.write('<div');r.writeControlData(c);r.addClass('searchResultListItemDetail');r.writeClasses();r.write('>');r.write('<div class="searchResultListItemDetail-content">');r.write('<div class="searchResultListItemDetail-contentTitle">');r.write("</div>");r.write('<div class="searchResultListItemDetail-attributes">');if(c.getItemData()){var d=c.getFirstDetailAttribute()+c.getMaxDetailAttributes();var w={};var p=function(i,s,t){r.write('<div class="searchResultListItemDetail-attribute">');var u=new sap.m.Label({text:i});u.setTooltip((''+i).replace(/<b>/gi,'').replace(/<\/b>/gi,''));u.addStyleClass("searchResultListItemDetail-attribute-label");r.renderControl(u);var x=new sap.m.Text({text:s});x.setTooltip((''+s).replace(/<b>/gi,'').replace(/<\/b>/gi,''));x.addStyleClass("searchResultListItemDetail-attribute-value");r.renderControl(x);r.write("</div>")};for(var j=c.getFirstDetailAttribute();j<d;j++){var a="attr"+j+"Name";var b="attr"+j;var l=c.getItemData()[a];var v=c.getItemData()[b];if(l===undefined||v===undefined){continue}p(l,v,false)}for(var z=d;z<=c.getItemData().numberofattributes;z++){var e="attr"+z+"Whyfound";if(c.getItemData()[e]===true){var f="attr"+z+"Name";var g="attr"+z;if(!(c.getItemData()[f]in w)){w[c.getItemData()[f]]=c.getItemData()[g]}}}if($.isArray(c.getItemData().whyfounds)&&c.getItemData().whyfounds.length>0){c.getItemData().whyfounds.forEach(function(s,i){w[s.label]=s.valueHighlighted})}var h=true;for(var k in w){h=false;break}if(h===false){r.write('<div class="searchResultListItemDetail-whyfound-container">');var m=0;for(var n in w){var o=n;var q=w[n];if(o===undefined||q===undefined){continue}else{m=m+1;if(m<3){p(o,q,true)}else{break}}}r.write("</div>")}}r.write("</div>");r.write("</div>");r.write("</div>")},setSafeText:function(o){o.each(function(i,d){var a=$(d);var s=a.text().replace(/<b>/gi,'').replace(/<\/b>/gi,'');if(s.indexOf('<')===-1){a.html(a.text())}var p=a.html().indexOf("<b>");if(p>-1&&d.offsetWidth<d.scrollWidth){var e="..."+a.html().substring(p);a.html(e)}})}})}());
