(function(g){"use strict";var s=g.sap;var c=g.console;var T=function(){this.init.apply(this,arguments)};T.prototype={init:function(t){this.text=t||"";this.lower=this.text.toLocaleLowerCase();this.globalBold=false;this.bold=new Array(this.text.length);for(var i=0;i<this.bold.length;++i){this.bold[i]=false}},highlight:function(t){if(t===""||this.lower==="")return;t=t.toLowerCase();var a=-1;while(a<this.lower.length){a=this.lower.indexOf(t,a);if(a>=0){for(var i=a;i<a+t.length;++i){this.bold[i]=true;this.globalBold=true}a+=t.length}else{break}}},render:function(){if(!this.globalBold){return this.text}var b=false;var r=[];var a=0;for(var i=0;i<this.text.length;++i){if(b&&!this.bold[i]||!b&&this.bold[i]){r.push(this.text.substring(a,i));if(b){r.push("</b>")}else{r.push("<b>")}b=!b;a=i}}r.push(this.text.substring(a,i));if(b){r.push("</b>")}return r.join("")}};s.ui.model.json.JSONModel.extend("sap.ushell.renderers.fiori2.search.SearchModel",{searchInit:function(){var a=this;a.sina=s.ushell.Container.getService("Search").getSina();var p={templateFactsheet:true};a.suggestionid=0;a.suggestionQuery=a.sina.createSuggestionQuery();this.oUserRecentsService=s.ushell.Container.getService("UserRecents");a.query=a.sina.createPerspectiveQuery(p);a.searchRequestID=0;a.setProperty('/dataSourceName','');a.setProperty('/dataSourceLabelRaw','');a.setProperty('/searchBoxTerm','');a.setProperty('/headSelectedDataSource',{});a.setProperty('/facets',{});a.setProperty('/facets/dataSources',[]);a.setProperty('/facets/attributes',[]);a.setProperty('/results',[]);a.setProperty('/detail',{});a.setProperty('/detail',{});a.setProperty('/detail/title',"");a.setProperty('/detail/titleUrl',"");a.setProperty('/detail/type',"");a.setProperty('/detail/data',{});a.setProperty('/count',0);a.setProperty('/isResultAppended',false);a.setProperty('/attributeFacetFilterLists',[]);a.resetDataSource(false);a.resetDataSources(false);a.resetAttributeFacets(false);a.resetFilterConditions(false);a.dsSuggestionQuery=a.sina.createPerspectiveQuery(p);if(jQuery.device.is.phone){this.appSuggestionLimit=3;this.normalAppSuggestionLimit=3;this.singleAppSuggestionLimit=5;this.normalSuggestionLimit=5;this.dataSourceSuggestionLimit=5}else{this.appSuggestionLimit=3;this.normalAppSuggestionLimit=3;this.singleAppSuggestionLimit=7;this.normalSuggestionLimit=7;this.dataSourceSuggestionLimit=7}if(s.ui.getCore().byId("mainShell").getViewData().config.searchBusinessObjects){a.setProperty('/isNormalSearchEnable',s.ui.getCore().byId("mainShell").getViewData().config.searchBusinessObjects!=="hidden")}else{a.setProperty('/isNormalSearchEnable',true)}a.setProperty("/tiles",[]);var d=[];if(a.isNormalSearchEnable()){d.push({dataSourceLabel:s.ushell.resources.i18n.getText("label_all"),label:s.ushell.resources.i18n.getText("label_all"),labelRaw:"$$ALL$$"})}d.push({dataSourceLabel:s.ushell.resources.i18n.getText("label_apps"),label:s.ushell.resources.i18n.getText("label_apps"),labelRaw:"$$APP$$"});a.setProperty("/connectors",d);var h=function(b){var e=[];e.push({dataSourceLabel:s.ushell.resources.i18n.getText("label_all"),label:s.ushell.resources.i18n.getText("label_all"),labelRaw:"$$ALL$$"});e.push({dataSourceLabel:s.ushell.resources.i18n.getText("label_apps"),label:s.ushell.resources.i18n.getText("label_apps"),labelRaw:"$$APP$$"});for(var i=0;i<b.length;i++){var f=b[i];if(f.DESCRIPTION&&f.OBJECT_NAME){var j;if(f.DESCRIPTION.value!==null){j={dataSourceLabel:a.getHighlightingForTerms(f.DESCRIPTION.value,"*"),label:f.DESCRIPTION.value,labelRaw:f.OBJECT_NAME.value,}}else{j={dataSourceLabel:a.getHighlightingForTerms(f.DESCRIPTION.value,"*"),label:f.OBJECT_NAME.value,labelRaw:f.OBJECT_NAME.value,}}if(j.label&&j.labelRaw){e.push(j)}}}a.setProperty("/connectors",e)};if(a.isNormalSearchEnable()){a.getConnectors(h,function(){})}},isNormalSearchEnable:function(){return this.getProperty("/isNormalSearchEnable")},doSuggestion:function(){var a=this;if(a.suggestionTimeoutId){g.clearTimeout(a.suggestionTimeoutId)}a.suggestionTimeoutId=g.setTimeout(function(){var b=a.getProperty("/searchBoxTerm");a.setProperty("/appSection",[]);a.setProperty("/dataSourceSection",[]);a.setProperty("/suggestSection",[]);a.setProperty("/mixedSection",[]);a.suggestionid=a.suggestionid+1;if(a.isNormalSearchEnable()){if((b.length>=3||!a.isAllCategory())&&!a.isAppCategory()){a.doNormalSuggestions(b,a.suggestionid)}if(!a.isAppCategory()){a.appSuggestionLimit=a.normalAppSuggestionLimit}else{a.appSuggestionLimit=a.singleAppSuggestionLimit}if(a.isAllCategory()||a.isAppCategory()){a.doAppSuggestions(b,a.suggestionid)}if(a.isAllCategory()){a.doDataSourceSuggestions(b)}}else{a.appSuggestionLimit=a.singleAppSuggestionLimit;a.doAppSuggestions(b,a.suggestionid)}},400)},isAllCategory:function(){var d=this.getProperty("/dataSource");if((d&&d.objectName&&d.objectName.value&&d.objectName.value.toLowerCase()==="$$all$$")||(d&&d.objectName&&d.objectName.toLowerCase&&d.objectName.toLowerCase()==="$$all$$"))return true;return false},isAppCategory:function(){var d=this.getProperty("/dataSource");if(d&&d.objectName&&d.objectName.value==="$$APP$$")return true;return false},doAppSuggestions:function(a,b){var d=this;var q={searchTerm:a,top:d.appSuggestionLimit};var e=s.ushell.Container.getService("Search").queryApplications(q).done(function(r){var R=r.getElements();var u=[];if(b!==d.suggestionid)return;for(var i=0;i<R.length;++i){var f=R[i];var h={pos:i,label:f.title,icon:f.icon,targetURL:f.url,labelRaw:"",mixedLabel:f.title};u.push(h)}d.setProperty("/appSection",u);var k=d.getProperty("/appSection");var l=d.getProperty("/dataSourceSection");var n=d.getProperty("/suggestSection");var m=k.concat(l).concat(n);for(var j=0;j<m.length;j++){var o=m[j];if(d.isAllCategory()&&o.dataSourceLabel){o.mixedLabel=o.label+" <i>in "+o.dataSourceLabel+"</i>"}else{o.mixedLabel=o.label}}d.setProperty("/mixedSection",m)})},doDataSourceSuggestions:function(a){var b=this;b.suggestDataSources(a,2)},suggestDataSources:function(a,l){var b=this;var d=a.replace(/([.+?^=!:${}()|\[\]\/\\])/g,"\\$1");d=d.replace(/\*/g,".*");var e=new RegExp('\\b'+d,'i');var t=b.tokenizeSuggestionTerm(a);var f=b.getProperty("/connectors");if(f){var h=[];for(var i=0;i<f.length;++i){var j=f[i];if(e.test(j.label)&&j.label.toLowerCase()!=='all'&&j.label.toLowerCase()!=='apps'){var k={};k.label='<i>'+s.ushell.resources.i18n.getText("searchIn")+': </i>'+b.getHighlightingForTerms(j.label,t);k.labelRaw=j.labelRaw;k.mixedLabel=k.label;k.suggestType="dataSourceSuggest";h.push(k);if(h.length===l){break}}}b.setProperty("/dataSourceSection",h);var m=b.getProperty("/appSection");var n=b.getProperty("/dataSourceSection");var o=b.getProperty("/suggestSection");var p=m.concat(n).concat(o);b.setProperty("/mixedSection",p)}},getConnectors:function(o,a){var b=this;var d=b.sina.sinaSystem();d.getServerInfo().done(function(){var e;if(d&&d.properties&&d.properties.rawServerInfo&&d.properties.rawServerInfo.ServerInfo)e=d.properties.rawServerInfo.ServerInfo.SystemId;var f=d.properties.rawServerInfo.ServerInfo.Client;b.searchConnector=e+f+"~ESH_CONNECTOR~";var h=b.sina.createDataSource({objectName:b.searchConnector,packageName:"ABAP",type:"Connector",label:""});b.dsSuggestionQuery.setDataSource(h);b.dsSuggestionQuery.setSearchTerms("*");b.dsSuggestionQuery.setTop(1000);b.dsSuggestionQuery.setOrderBy({orderBy:'DESCRIPTION',sortOrder:'ASC'});b.dsSuggestionQuery.getResultSet(jQuery.proxy(function(r){var i=r.searchresultset.getElements();o(i)},this),function(i){a(i)})})},getDataSourceSuggestions:function(a,o,b){var d=this;var e=d.sina.sinaSystem();e.getServerInfo().done(function(){var f;if(e&&e.properties&&e.properties.rawServerInfo&&e.properties.rawServerInfo.ServerInfo)f=e.properties.rawServerInfo.ServerInfo.SystemId;var h=e.properties.rawServerInfo.ServerInfo.Client;d.searchConnector=f+h+"~ESH_CONNECTOR~";var i=d.sina.createDataSource({objectName:d.searchConnector,packageName:"ABAP",type:"Connector",label:""});d.dsSuggestionQuery.setDataSource(i);d.dsSuggestionQuery.setSearchTerms(a);d.dsSuggestionQuery.setTop(1000);d.dsSuggestionQuery.setOrderBy({orderBy:'DESCRIPTION',sortOrder:'ASC'});d.dsSuggestionQuery.getResultSet(jQuery.proxy(function(r){var j=r.searchresultset.getElements();o(j)},this),function(j){b(j)})})},doNormalSuggestions:function(a,b){var d=this;d.suggestionQuery.setSuggestionTerm(a);d.suggestionQuery.setDataSource(d.getProperty("/dataSource"));d.suggestionQuery.getResultSet(function(r){if(b!==d.suggestionid)return;var e=r.getElements();var f=[];var t=d.tokenizeSuggestionTerm(a);for(var i=0;i<e.length;i++){var h=e[i];var j;if(i===0){j=h.labelRaw}if(h.attribute.value!=="$$AllAttributes$$"){continue}if(d.isAllCategory()){if(h.dataSource.getObjectName().value!=="$$AllDataSources$$"){if(j!==h.labelRaw){continue}h.dataSourceLabel=d.getLabelForSinaDataSource(h.dataSource)}else{h.dataSource=d.sina.createDataSource({objectName:"$$ALL$$",packageName:"ABAP",type:"Category",label:"All Categories"})}}else{if(h.dataSource.getObjectName().value!=="$$AllDataSources$$"){continue}else{h.dataSource=d.sina.createDataSource({objectName:"$$ALL$$",packageName:"ABAP",type:"Category",label:"All Categories"})}h.dataSource=d.getProperty("/dataSource");h.dataSourceLabel=d.getLabelForSinaDataSource(h.dataSource)}h.label=d.getHighlightingForTerms(h.labelRaw,t);f.push(h);if(d.normalSuggestionLimit===f.length)break}d.setProperty("/suggestSection",f);var k=d.getProperty("/appSection");var l=d.getProperty("/dataSourceSection");var n=d.getProperty("/suggestSection");var m=k.concat(l).concat(n);for(var i=0;i<m.length;i++){var o=m[i];if(d.isAllCategory()&&o.dataSourceLabel){o.mixedLabel=o.label+" <i>in "+o.dataSourceLabel+"</i>"}else{o.mixedLabel=o.label}}d.setProperty("/mixedSection",m)})},addTitle:function(t,i){if(i.length!==0){i.unshift({isTitle:true,title:t})}},createAllDataSource:function(){return this.sina.createDataSource({objectName:{label:"$$ALL$$",value:"$$ALL$$"},packageName:{label:"ABAP",value:"ABAP"},type:"Category",label:"All Categories"})},createAppDataSource:function(){return this.sina.createDataSource({objectName:{label:"$$APP$$",value:"$$APP$$"},packageName:"",type:"",label:"App Category"})},getLabelForSinaDataSource:function(d){var a=d.label||d.objectName.label||d.objectName.value;return a},getHighlightingForTerms:function(t,a){var m=new T(t);for(var j=0;j<a.length;++j){var b=a[j];m.highlight(b)}return m.render()},tokenizeSuggestionTerm:function(a){var t=a;var b=t.split(" ");var n=[];$.each(b,function(i,d){d=$.trim(d);if(d.length>0){var e=d.split("*");$.each(e,function(i,f){if(f.length>0){n.push(f)}})}});return n},correctServerErrorHighlighting:function(a,t){var m;var b=/<b>[^<]+<\/b>/igm;while(m=b.exec(a)){var d=m.index;var e=b.lastIndex-4;var S=a.substring(d+3,e);var f=new T(S);for(var i=0;i<t.length;++i){m={};var h=t[i];f.highlight(h)}S=f.render();a=a.substring(0,d)+S+a.substring(e+4)}return a},buildSuggestions:function(S,a){var r={};var t=a;var b=t.split(" ");var n=[];$.each(b,function(i,e){e=$.trim(e);if(e.length>0){var f=e.split("*");$.each(f,function(i,h){if(h.length>0){h=h.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");n.push(h)}})}});t=n;var d=/<b>[^<]+<\/b>/igm;jQuery.each(S,function(i,v){if(v.filter.attribute!=="$$AllAttributes$$"){return}if(!r[v.labelRaw]){r[v.labelRaw]=v;r[v.labelRaw].categories=[];r[v.labelRaw].visible=true;r[v.labelRaw].type="suggestion"}var e=r[v.labelRaw].label;if(e.length===0){r[v.labelRaw].label=v.labelRaw;e=r[v.labelRaw].label}var m;while(m=d.exec(e)){var f=m.index;var h=d.lastIndex-4;var j=e.substring(f+3,h);var k=new T(j);for(i=0;i<t.length;++i){m={};var l=t[i];var o=new RegExp(l,"ig");if(j!==l){var p=j.match(o);if(p&&p instanceof Array&&p.length>0){k.highlight(l)}}}j=k.render();e=e.substring(0,f)+j+e.substring(h+4)}r[v.labelRaw].label=e;if(v.dataSource.getObjectName().value!=="$$AllDataSources$$"){r[v.labelRaw].categories.push({label:v.dataSource.getObjectName().label,data:v})}});return jQuery.map(r,function(v,k){return[v]})},addFilterCondition:function(a,o,v,f){var b=this;b.query.addFilterCondition(a,o,v);if(f||f===undefined){b._searchFireQuery()}},addFilterConditionGroup:function(a,f){var b=this;b.query.getFilter().addFilterConditionGroup(a);if(f||f===undefined){b._searchFireQuery()}},resetFilterConditions:function(f){var a=this;a.query.resetFilterConditions();a.query.addFilterCondition('$$RenderingTemplatePlatform$$','=','html');a.query.addFilterCondition('$$RenderingTemplateTechnology$$','=','Tempo');a.query.addFilterCondition('$$RenderingTemplateVariant$$','=','');a.query.addFilterCondition('$$RenderingTemplateType$$','=','ItemDetails');a.query.addFilterCondition('$$RenderingTemplateType$$','=','ResultItem');if(f||f===undefined){a._searchFireQuery()}},resetAttributeFacets:function(f){var a=this;a.setProperty('/facets/attributes',[]);if(f||f===undefined){a._searchFireQuery()}},getDataSources:function(){var a=this;return a.getProperty("/facets/dataSources")},resetDataSources:function(f){var a=this;a.setProperty('/facets/dataSources',[]);if(f||f===undefined){a._searchFireQuery()}},getResultList:function(){var a=this;return a.perspective.getSearchResultSet()},getFacets:function(){var a=this;return a.perspective.getChartFacets()},getFilter:function(){var a=this;return a.query.getFilter()},setFilter:function(f,a){var b=this;b.query.setFilter(f);if(a||a===undefined){b._searchFireQuery()}},getTop:function(){var a=this;return a.query.getTop()},setTop:function(t,f){var a=this;a.query.setTop(t);if(f||f===undefined){a._searchFireQuery()}},getSkip:function(){var a=this;return a.query.getSkip()},setSkip:function(a,f){var b=this;b.query.setSkip(a);if(f||f===undefined){b._searchFireQuery()}},resetDataSource:function(f){var a=this;if(s.bc===undefined)return;var d=a.sina.createDataSource({objectName:"$$ALL$$",packageName:"ABAP",type:"Category",label:"All Categories"});a.setDataSource(d,f)},getDataSource:function(){var a=this;return a.query.getDataSource()},getDataSourceJson:function(){var a=this;var d=a.getProperty("/dataSource");var j={"SchemaName":{"label":d.getSchemaName().label,"value":d.getSchemaName().value},"PackageName":{"label":d.getPackageName().label,"value":d.getPackageName().value},"ObjectName":{"label":d.getObjectName().label,"value":d.getObjectName().value}};if(d.getType().value){j.Type=d.getType().value}return j},setDataSource:function(d,f){var a=this;d=a.sina.createDataSource(d);var b=d.getLabel();a.setProperty('/dataSourceName',b);a.setProperty('/dataSourceLabelRaw',d.objectName.value);a.setSkip(0,false);a.setProperty("/dataSource",d);if(a.isAllCategory()){a.setProperty('/dataSourceName',"");a.setProperty('/dataSourceLabelRaw',"$$ALL$$")}this.oUserRecentsService.noticeDataSource(d);if(f||f===undefined){a._searchFireQuery()}},getSearchTerm:function(){var a=this;return a.getProperty("/searchBoxTerm")},setSearchTerm:function(a,f){var b=this;b.setProperty("/searchBoxTerm",a);if(f||f===undefined){b._searchFireQuery()}},getResultsForDataSource:function(d,r){var a=[];for(var i=0;i<r.length;i++){var b=r[i];var e=b.$$DataSourceMetaData$$;if(d.objectName.value===e.objectName.value){a.push(b)}}return a},_searchFireQuery:function(){var a=this;if(!a.sina){jQuery.sap.log.info("Current Search adapter does not support Sina queries");return}var b=a.getProperty('/searchBoxTerm');var d=a.getProperty("/dataSource");s.ui.getCore().getEventBus().publish("search",{searchTerm:b,dataSource:d});if(a.getSkip()>0&&a.query.getSearchTerms()===b&&a.query.getDataSource().equals(d)){a.setProperty("/isResultAppended",true)}else{a.setProperty("/results",[]);a.setProperty("/isResultAppended",false)}a.query.setSearchTerms(b);a.query.setDataSource(d);a.searchRequestID=a.searchRequestID+1;var e=a.searchRequestID;s.ui.getCore().getEventBus().publish("searchStarted");var p=2;var f=function(){if(!--p){s.ui.getCore().getEventBus().publish("allSearchFinished")}};a.setProperty("/tiles",[]);if(a.isAllCategory()||a.isAppCategory()){var h={searchTerm:a.getProperty('/searchBoxTerm'),searchInKeywords:true};s.ushell.Container.getService("Search").queryApplications(h).done(function(r){if(e!==a.searchRequestID){jQuery.sap.log.debug("Searchrequest deprecated");return}var m=[];var t=r.getElements();a.setProperty("/tiles",t);s.ui.getCore().getEventBus().publish("appSearchFinished",r)})}else{s.ui.getCore().getEventBus().publish("appSearchFinished")}f();a.perspective=a.getEmptyPerspective();if(a.isNormalSearchEnable()&&!a.isAppCategory()){var j=a.query.getResultSet();j.always(function(i){if(this.state()!=="resolved"){i=a.getEmptyPerspective()}if(e!==a.searchRequestID){jQuery.sap.log.debug("Searchrequest deprecated");return}a.perspective=i;a._afterSearchPrepareResultList(i,a.getProperty("/isResultAppended"));s.ui.getCore().getEventBus().publish("searchFinished",{append:a.getProperty("/isResultAppended"),resultset:i})});j.fail(function(k){var l=["ESH_FED_MSG016"];if(k&&k.responseText){var m=true;var n=jQuery.parseJSON(k.responseText);var o='Search Error: ';var q='';if(n.Error){if(n.Error.Message){o+=''+n.Error.Message}if(n.Error.Code){o+=' (Code '+n.Error.Code+').'}}if(n.ErrorDetails){q+='';for(var i=0;i<n.ErrorDetails.length;i++){q+=n.ErrorDetails[i].Message+' (Code '+n.ErrorDetails[i].Code+')';if(l.indexOf(n.ErrorDetails[i].Code)!==-1){m=false}}}jQuery.sap.log.error(o+' Details: '+q);if(m){jQuery.sap.require("sap.ca.ui.message.message");s.ca.ui.message.showMessageBox({type:s.ca.ui.message.Type.ERROR,message:o,details:q})}}});j.always(function(i){f()})}else{f()}},getEmptyPerspective:function(r){return{getSearchResultSet:function(){return{getElements:function(){return[]},totalcount:0}}}},_searchGetGenericResults:function(r){function d(h){var A={imageUrl:'',name:''};for(var p in h){if(h[p].label&&h[p].value){if(h[p].value&&jQuery.type(h[p].value)==='string'&&(h[p].value.split('.').pop()==='jpg'||h[p].value.split('.').pop()==='png')){A.imageUrl=h[p].value;A.name=p;return A}}}return A}var m=function(w,a){var l=w.length;while(l--){if(w[l].labelRaw===a.labelRaw&&a!==undefined){a.value=w[l].value;a.whyfound=true;w.splice(l,1)}}};var e=function(a,b){return a.displayOrder-b.displayOrder};var f=[];for(var i=0;i<r.length;i++){var h=r[i];var u='';var j=h.$$RelatedActions$$;for(var k in j){if(j[k].type==="Navigation"){u=j[k].uri}}var w=h.$$WhyFound$$||[];var n=[];var o=[];var t='';for(var p in h){if(h[p].label&&h[p].$$MetaData$$){var q=h[p].$$MetaData$$.presentationUsage||[];if(q&&q.length>0){if(q.indexOf("Title")>-1&&h[p].value){m(w,h[p]);t=t+" "+h[p].value}if(q.indexOf("Summary")>-1){n.push({property:p,displayOrder:h[p].$$MetaData$$.displayOrder})}else if(q.indexOf("Detail")>-1){o.push({property:p,displayOrder:h[p].$$MetaData$$.displayOrder})}}}}n.sort(e);o.sort(e);var v=n.concat(o);var x=1;var y={};var A=d(h);y.imageUrl=A.imageUrl;y.dataSourceName=this._highlight(h.$$DataSourceMetaData$$.label);y.uri=u;y.$$Name$$='';for(var z=0;z<v.length;z++){var B=v[z].property;if(B!==A.name){m(w,h[B]);y["attr"+x+"Name"]=h[B].label;y["attr"+x]=h[B].value;if(h[B].whyfound){y["attr"+x+"Whyfound"]=h[B].whyfound}x=x+1}}y.$$Name$$=t.trim();y.numberofattributes=v.length;y.title=h.title;y.whyfounds=w;f.push(y)}return f},_highlight:function(t){var a=this.query.filter.searchTerms;a=a.replace(new RegExp("[*]","g"),"");a=a.split(" ");var n=[];a=$.each(a,function(i,b){b=$.trim(b);if(b.length>0){n.push(b)}});a=n;var m=new T(t);for(var i=0;i<a.length;++i){var b=a[i];m.highlight(b)}return m.render()},_afterSearchPrepareResultList:function(r,a){var b=this;var v=b.getProperty("/results");var d;if(a){v.pop()}var e=r.getSearchResultSet().getElements();e=b._searchGetGenericResults(e);d=v.concat(e);if(d.length<r.getSearchResultSet().totalcount){var f={};f.type="footer";d.push(f)}b.setProperty("/resultListHeading",s.ushell.resources.i18n.getText("searchResults"));b.setProperty("/count",r.getSearchResultSet().totalcount);b.setProperty("/results",d);if(window.f2p)window.f2p.add(window.f2p.m.endSearch,{st:""})},mockScopes:function(){var a=[{label:'Supplier',labelRaw:'Q7D004~VENDOR_H~',objectName:{label:'Supplier',value:'Q7D004~VENDOR_H~'},packageName:{label:"",value:""},schemaName:{label:"",value:""}},{label:'Goods Issue',labelRaw:'Q7D004~GOODS_ISSUE_H~',objectName:{label:'Goods Issue',value:'Q7D004~GOODS_ISSUE_H~'},packageName:{label:"",value:""},schemaName:{label:"",value:""}},{label:'Material',labelRaw:'Q7D004~MATERIAL_H~',objectName:{label:'Material',value:'Q7D004~MATERIAL_H~'},packageName:{label:"",value:""},schemaName:{label:"",value:""}},{label:'Purchasing Info Record',labelRaw:'Q7D004~PURCHASE_INFO_REC_H~',objectName:{label:'Purchasing Info Record',value:'Q7D004~PURCHASE_INFO_REC_H~'},packageName:{label:"",value:""},schemaName:{label:"",value:""}},{label:'Purchase Order',labelRaw:'Q7D004~PURCHASE_ORDER_H~',objectName:{label:'Purchase Order',value:'Q7D004~PURCHASE_ORDER_H~'},packageName:{label:"",value:""},schemaName:{label:"",value:""}},{label:'Sales Order',labelRaw:'Q7D004~SALES_ORDER_H~',objectName:{label:'Sales Order',value:'Q7D004~SALES_ORDER_H~'},packageName:{label:"",value:""},schemaName:{label:"",value:""}}];return a},_searchInvoked:function(C,e,d){var a=this;if(window.f2p){window.f2p.add(window.f2p.m.startSearch,{st:d.searchTerm})}if(d.searchTerm.toLowerCase().indexOf(a.getSearchTerm().toLowerCase())===-1){a.resetDataSource(false)}a.setSearchTerm(d.searchTerm,false);if(d.dataSource){a.setDataSource(d.dataSource,false)}a.setSkip(0,false);a.setTop(10)},_afterSearchPrepareFacets:function(){var a=this;var f=a.getFacets();var d=f.filter(function(e){return e.facetType==="datasource"});a._afterSearchPrepareDataSourceFacet(d);var b=f.filter(function(e){return e.facetType==="attribute"});a._afterSearchPrepareAttributeFacet(b)},_afterSearchPrepareDataSourceFacet:function(d){var a=this;var b=a.getProperty("/facets/dataSources");if(d.length>0){d=d[0];if(d.query.resultSet&&d.query.resultSet.elements&&d.query.resultSet.elements.length>0){for(var i=0;i<d.query.resultSet.elements.length;i++){var e={id:d.query.resultSet.elements[i].dataSource.label+(i+1),text:d.query.resultSet.elements[i].dataSource.label,count:d.query.resultSet.elements[i].valueRaw,dataSource:d.query.resultSet.elements[i].dataSource,selected:a.getDataSource()===d.query.resultSet.elements[i].dataSource};b.push(e)}}}a.setProperty("/facets/dataSources",b)},_afterSearchPrepareAttributeFacet:function(a){var b=this;function f(m){var r=false;for(var i=0,l=m.items.length;i<l;i++){var n=m.items[i];if(n.selected){r=true;break}}return r}var d=b.getProperty("/facets/attributes").filter(f);for(var i=0,l=a.length;i<l;i++){var e={title:a[i].title,dimension:a[i].dimension,items:[],allCount:0};for(var j=0,h=a[j].query.resultSet.elements.length;j<h;j++){var m=a[i].query.resultSet.elements[j];var n={text:m.label,count:m.valueRaw,filterCondition:m.labelRaw,selected:false};e.items.push(n);e.allCount+=n.count}var o=false;for(var k=0,p=d.length;k<p;k++){var q=d[k];if(q.title===e.title&&q.dimension===e.dimension){o=true;break}}if(!o){d.push(e)}}b.setProperty("/facets/attributes",d)}})})(window);
