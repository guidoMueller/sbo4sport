/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.controller("sap.apf.ui.reuse.controller.stepGallery",{getGalleryElementsData:function(){var g=[];var c=this.oCoreApi.getCategories();var l=this.oCoreApi.getTextNotHtmlEncoded("label");var s=this.oCoreApi.getTextNotHtmlEncoded("steps");var a=this.oCoreApi.getTextNotHtmlEncoded("category");var m;if(c.length===0){m=this.oCoreApi.createMessageObject({code:"6001",aParameters:["Categories"]});this.oCoreApi.putMessage(m)}var i;for(i=0;i<c.length;i++){var G={};var C=c[i];var b=this.oCoreApi.getTextNotHtmlEncoded(C.label);var o={};if(!C.label){m=this.oCoreApi.createMessageObject({code:"6002",aParameters:[l,a+": "+b]});this.oCoreApi.putMessage(m)}o.title=this.oCoreApi.getTextNotHtmlEncoded(C.label).toUpperCase();o.id=C.id;G.categoryDetails=o;G.stepTemplates=[];g.push(G)}var S=this.oCoreApi.getStepTemplates();if(S.length===0){m=this.oCoreApi.createMessageObject({code:"6002",aParameters:[s,a]});this.oCoreApi.putMessage(m)}var j,k;for(i=0;i<S.length;i++){var d=S[i];c=d.categories;for(j=0;j<c.length;j++){var e=c[j];for(k=0;k<g.length;k++){var f=g[k];if(f.categoryDetails.id===e.id){var h={};if(!d.title){m=this.oCoreApi.createMessageObject({code:"6003",aParameters:["Title"]});this.oCoreApi.putMessage(m)}h.maintitle=this.oCoreApi.getTextNotHtmlEncoded(d.title);h.id=d.id;h.representationtypes=d.getRepresentationInfo();h.defaultRepresentationType=h.representationtypes[0];f.stepTemplates.push(h)}}}}var n={GalleryElements:g};return n},onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;var g=this.getGalleryElementsData().GalleryElements;var m=new sap.ui.model.json.JSONModel({"GalleryElements":g});this.getView().setModel(m,"json")},getStepDetails:function(c,s){var g=this.getGalleryElementsData().GalleryElements;var a=g[c].stepTemplates[s];return a},openHierarchicalSelectDialog:function(){if(this.oHierchicalSelectDialog){this.oHierchicalSelectDialog.destroy()}this.oHierchicalSelectDialog=new sap.ui.jsfragment("sap.apf.ui.reuse.fragment.stepGallery",this);this.oHierchicalSelectDialog.setModel(this.getView().getModel("json"),"json");this.oHierchicalSelectDialog.open()},onStepPress:function(i,r){this.oHierchicalSelectDialog.close();this.oUiApi.getLayoutView().setBusy(true);this.oCoreApi.createStep(i,this.oUiApi.getAnalysisPath().getController().callBackForUpdatePathAndSetLastStepAsActive.bind(this.oUiApi.getAnalysisPath().getController()),r);this.oUiApi.getLayoutView().setBusy(true);this.oUiApi.getAnalysisPath().getController().refresh(-1)}});
