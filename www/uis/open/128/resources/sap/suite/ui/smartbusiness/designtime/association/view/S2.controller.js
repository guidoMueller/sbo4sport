/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2013 SAP SE. All rights reserved
 */
jQuery.sap.require("sap.ca.scfld.md.controller.ScfldMasterController");sap.ca.scfld.md.controller.ScfldMasterController.extend("sap.suite.ui.smartbusiness.designtime.association.view.S2",{onInit:function(){var t=this;t.oApplicationFacade.getODataModel().setSizeLimit(100000);if(!(t.oApplicationFacade.currentLogonHanaUser)){this.oApplicationFacade.getODataModel().read("/SESSION_USER",null,null,true,function(d){t.oApplicationFacade.currentLogonHanaUser=(d.results&&d.results.length)?d.results[0].LOGON_USER:null},function(e){t.oApplicationFacade.currentLogonHanaUser=null;sap.suite.smartbusiness.utils.showErrorMessage(t.oApplicationFacade.getResourceBundle().getText("YMSG_ERROR_RETRIEVING_DATA"),e.response.body)})}this.byId("list").getBinding("items").filter(new sap.ui.model.Filter("IS_ACTIVE",sap.ui.model.FilterOperator.EQ,1))},createFilterOptions:function(){var t=this;var f=new sap.m.ViewSettingsDialog({id:this.createId("filterOptionsDialog"),filterItems:[new sap.m.ViewSettingsFilterItem({text:t.oApplicationFacade.getResourceBundle().getText("ACTIVITY"),key:"activity",items:[new sap.m.ViewSettingsItem({text:t.oApplicationFacade.getResourceBundle().getText("SELF_CREATED"),key:"self_created"}),new sap.m.ViewSettingsItem({text:t.oApplicationFacade.getResourceBundle().getText("RECENTLY_WORKED_UPON"),key:"recently_worked_upon"}),new sap.m.ViewSettingsItem({text:t.oApplicationFacade.getResourceBundle().getText("FAVOURITE"),key:"favorite"}),]})],confirm:function(e){t.setFiltering(e.getParameter("filterItems"))}});return f},createSortOptions:function(){var t=this;var s=new sap.m.ViewSettingsDialog({id:this.createId("sortOptionsDialog"),sortItems:[new sap.m.ViewSettingsItem({text:t.oApplicationFacade.getResourceBundle().getText("BY_NEWEST"),key:"newest"}),new sap.m.ViewSettingsItem({text:t.oApplicationFacade.getResourceBundle().getText("BY_OLDEST"),key:"oldest"}),new sap.m.ViewSettingsItem({text:t.oApplicationFacade.getResourceBundle().getText("BY_TYPE"),key:"type"}),new sap.m.ViewSettingsItem({text:t.oApplicationFacade.getResourceBundle().getText("ALPHABETICALLY"),key:"alphabetically"})],confirm:function(e){if(e.getParameter("sortItem")){t.setSorting(e.getParameter("sortItem").getKey(),e.getParameter("sortDescending"))}else{t.setGrouping("workspace",true)}}});return s},createGroupOptions:function(){var t=this;var g=new sap.m.ViewSettingsDialog({id:this.createId("groupOptionsDialog"),groupItems:[new sap.m.ViewSettingsItem({text:t.oApplicationFacade.getResourceBundle().getText("BY_WORKSPACE"),key:"workspace"}),new sap.m.ViewSettingsItem({text:t.oApplicationFacade.getResourceBundle().getText("BY_TYPE"),key:"type"}),new sap.m.ViewSettingsItem({text:t.oApplicationFacade.getResourceBundle().getText("BY_STATUS"),key:"status"}),new sap.m.ViewSettingsItem({text:t.oApplicationFacade.getResourceBundle().getText("BY_OWNER"),key:"owner"})],confirm:function(e){if(e.getParameter("groupItem")){t.setGrouping(e.getParameter("groupItem").getKey(),e.getParameter("groupDescending"))}else{t.setGrouping("workspace",true)}}});return g},getHeaderFooterOptions:function(){var t=this;return{sI18NMasterTitle:"MASTER_TITLE",onBack:function(){window.history.back()},oFilterOptions:{onFilterPressed:function(e){t.getView().filterOptionDialog=t.getView().filterOptionDialog||t.createFilterOptions();t.getView().filterOptionDialog.open()}},oSortOptions:{onSortPressed:function(e){t.getView().sortOptionDialog=t.getView().sortOptionDialog||t.createSortOptions();t.getView().sortOptionDialog.open()}},oGroupOptions:{onGroupPressed:function(e){t.getView().groupOptionDialog=t.getView().groupOptionDialog||t.createGroupOptions();t.getView().groupOptionDialog.open()}}}},formatTitle:function(t){return(t||"")},formatAssociationCount:function(s,t){if(s==null&&t==null){return 0}if(s==null){return parseInt(t)}if(t==null){return parseInt(s)}return(parseInt(s)+parseInt(t))},formatID:function(i,t){if(t=="KPI"){return(this.oApplicationFacade.getResourceBundle().getText(t,i))}else{return(this.oApplicationFacade.getResourceBundle().getText(t)+": "+i)}},formatOwnerName:function(o){return(this.oApplicationFacade.getResourceBundle().getText("ADDED_BY",o))},formatState:function(s){return(s?"ACTIVE":"DRAFT")},formatGroupName:function(c){var t=this;var i=c.getProperty("MANUAL_ENTRY");var g="";switch(i){case 1:g=t.oApplicationFacade.getResourceBundle().getText("MY_FAVOURITES");break;case 0:g=t.oApplicationFacade.getResourceBundle().getText("MY_LAST_WORKED_UPON");break;default:g=t.oApplicationFacade.getResourceBundle().getText("ALL_KPI_OPI")}return{key:g,text:g}},setGrouping:function(k,g){var t=this;g=g||false;var l=this.getView().byId("list");if(k=="type"){l.getBinding("items").sort([new sap.ui.model.Sorter("TYPE",g,function(c){return{key:c.getProperty("TYPE"),text:(c.getProperty("TYPE")+"S")}})])}else if(k=="status"){l.getBinding("items").sort([new sap.ui.model.Sorter("IS_ACTIVE",g,function(c){return{key:c.getProperty("IS_ACTIVE")?"ACTIVE":"DRAFT",text:c.getProperty("IS_ACTIVE")?t.oApplicationFacade.getResourceBundle().getText("ACTIVE_KPI_OPI"):t.oApplicationFacade.getResourceBundle().getText("DRAFT_KPI_OPI"),}})])}else if(k=="owner"){l.getBinding("items").sort([new sap.ui.model.Sorter("OWNER_NAME",g,function(c){var o=c.getProperty("OWNER_NAME");var a="";switch(o){case null:a=t.oApplicationFacade.getResourceBundle().getText("NO_OWNER");break;case"":a=t.oApplicationFacade.getResourceBundle().getText("NO_OWNER");break;default:a=o}return{key:a,text:a}})])}else if(k=="workspace"){l.getBinding("items").sort([new sap.ui.model.Sorter("MANUAL_ENTRY",g,function(c){var i=c.getProperty("MANUAL_ENTRY");var a="";switch(i){case 1:a=t.oApplicationFacade.getResourceBundle().getText("MY_FAVOURITES");break;case 0:a=t.oApplicationFacade.getResourceBundle().getText("MY_LAST_WORKED_UPON");break;default:a=t.oApplicationFacade.getResourceBundle().getText("ALL_KPI_OPI")}return{key:a,text:a}})])}},setFiltering:function(i){var t=this;var f=[];var l=this.getView().byId("list");var a={"drafts":(new sap.ui.model.Filter("IS_ACTIVE",sap.ui.model.FilterOperator.EQ,0)),"activated":(new sap.ui.model.Filter("IS_ACTIVE",sap.ui.model.FilterOperator.EQ,1)),"self_created":(new sap.ui.model.Filter("CREATED_BY",sap.ui.model.FilterOperator.EQ,t.oApplicationFacade.currentLogonHanaUser)),"recently_worked_upon":(new sap.ui.model.Filter("MANUAL_ENTRY",sap.ui.model.FilterOperator.EQ,0)),"favorite":(new sap.ui.model.Filter("MANUAL_ENTRY",sap.ui.model.FilterOperator.EQ,1))};f=sap.suite.smartbusiness.utils.getFilterArray(i,a);if(f.length){l.getBinding("items").filter(new sap.ui.model.Filter(f,true))}else{l.getBinding("items").filter(f)}},setSorting:function(k,g){var t=this;g=g||false;var l=t.getView().byId("list");if(k=="newest"){l.getBinding("items").sort([new sap.ui.model.Sorter("CREATED_ON",true,null)])}else if(k=="oldest"){l.getBinding("items").sort([new sap.ui.model.Sorter("CREATED_ON",false,null)])}else if(k=="type"){l.getBinding("items").sort([new sap.ui.model.Sorter("TYPE",g,null)])}else if(k=="alphabetically"){l.getBinding("items").sort([new sap.ui.model.Sorter("TITLE",g,null)])}},onExit:function(){var h=hasher||window.hasher;if(!(h.getHash())){sap.suite.smartbusiness.utils.backToHome()}},applySearchPatternToListItem:function(i,f){if(sap.ca.scfld.md.controller.ScfldMasterController.prototype.applySearchPatternToListItem.apply(this,arguments)){return true}else{}return false}});
