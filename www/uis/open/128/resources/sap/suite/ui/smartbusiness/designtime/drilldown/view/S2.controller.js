jQuery.sap.require("sap.ca.scfld.md.controller.ScfldMasterController");sap.ca.scfld.md.controller.ScfldMasterController.extend("sap.suite.ui.smartbusiness.designtime.drilldown.view.S2",{onInit:function(){var t=this;t.oApplicationFacade.getODataModel().setSizeLimit(100000);if(!(t.oApplicationFacade.currentLogonHanaUser)){this.oApplicationFacade.getODataModel().read("/SESSION_USER",null,null,true,function(d){t.oApplicationFacade.currentLogonHanaUser=(d.results&&d.results.length)?d.results[0].LOGON_USER:null},function(e){t.oApplicationFacade.currentLogonHanaUser=null;sap.suite.smartbusiness.utils.showErrorMessage(t.getView().getModel("i18n").getProperty("YMSG_ERROR_RETRIEVING_DATA"),e.response.body)})}},formatIndicatorId:function(c){return{text:("KPI: "+c.getProperty("INDICATOR")),key:c.getProperty("INDICATOR")}},_handleItemPress:function(){},createGroupOptions:function(){var t=this;var g=new sap.m.ViewSettingsDialog({id:this.createId("groupOptionsDialog"),groupItems:[new sap.m.ViewSettingsItem({text:t.getView().getModel("i18n").getProperty("BY_INDICATOR"),key:"indicator"}),new sap.m.ViewSettingsItem({text:t.getView().getModel("i18n").getProperty("BY_OWNER"),key:"owner"})],confirm:function(e){if(e.getParameter("groupItem")){t.setGrouping(e.getParameter("groupItem").getKey(),e.getParameter("groupDescending"))}else{t.setGrouping("indicator",(e.getParameter("groupDescending")||false))}}});return g},getHeaderFooterOptions:function(){var t=this;return{sI18NMasterTitle:"ALL_ACTIVE_EVALUATIONS",oFilterOptions:{onFilterPressed:function(e){t.getView().filterOptionDialog=t.getView().filterOptionDialog||t.createFilterOptions();t.getView().filterOptionDialog.open()}},oSortOptions:{onSortPressed:function(e){t.getView().sortOptionDialog=t.getView().sortOptionDialog||t.createSortOptions();t.getView().sortOptionDialog.open()}},oGroupOptions:{onGroupPressed:function(e){t.getView().groupOptionDialog=t.getView().groupOptionDialog||t.createGroupOptions();t.getView().groupOptionDialog.open()}},}},setGrouping:function(k,g){var t=this;g=g||false;var l=this.getView().byId("list");if(k=="indicator"){l.getBinding("items").sort([new sap.ui.model.Sorter("INDICATOR",g,function(c){return{key:c.getProperty("INDICATOR"),text:("KPI: "+c.getProperty("INDICATOR"))}})])}else if(k=="owner"){l.getBinding("items").sort([new sap.ui.model.Sorter("OWNER_NAME",g,function(c){var o=c.getProperty("OWNER_NAME");var a="";switch(o){case null:a=t.getView().getModel("i18n").getProperty("NO_OWNER");break;case"":a=t.getView().getModel("i18n").getProperty("NO_OWNER");break;default:a=o}return{key:a,text:a}})])}},createSortOptions:function(){var t=this;var s=new sap.m.ViewSettingsDialog({id:this.createId("sortOptionsDialog"),sortItems:[new sap.m.ViewSettingsItem({text:t.getView().getModel("i18n").getProperty("CREATION_DATE"),key:"newest"}),new sap.m.ViewSettingsItem({text:t.getView().getModel("i18n").getProperty("ALPHABETICALLY"),key:"alphabetically"}),new sap.m.ViewSettingsItem({text:t.getView().getModel("i18n").getProperty("NONE"),key:"none"})],confirm:function(e){if(e.getParameter("sortItem")){if(e.getParameter("sortItem").getKey()=="none"){t.setGrouping("indicator",(e.getParameter("groupDescending")||false))}else{t.setSorting(e.getParameter("sortItem").getKey(),e.getParameter("sortDescending"))}}else{t.setGrouping("indicator",(e.getParameter("groupDescending")||false))}}});return s},setSorting:function(k,g){g=g||false;var l=this.getView().byId("list");if(k=="newest"){l.getBinding("items").sort([new sap.ui.model.Sorter("CREATED_ON",g,null)])}else if(k=="alphabetically"){l.getBinding("items").sort([new sap.ui.model.Sorter("TITLE",g,null)])}},setFiltering:function(i){var f=[];var l=this.getView().byId("list");var a={"self_created":(new sap.ui.model.Filter("CREATED_BY",sap.ui.model.FilterOperator.EQ,this.oApplicationFacade.currentLogonHanaUser)),};for(var b in i){f.push(a[b])}if(f.length){l.getBinding("items").filter(new sap.ui.model.Filter(f,false))}else{l.getBinding("items").filter(f)}},createFilterOptions:function(){var t=this;var f=new sap.m.ViewSettingsDialog({id:this.createId("filterOptionsDialog"),filterItems:[new sap.m.ViewSettingsFilterItem({text:t.getView().getModel("i18n").getProperty("ACTIVITY"),key:"activity",items:[new sap.m.ViewSettingsItem({text:t.getView().getModel("i18n").getProperty("SELF_CREATED"),key:"self_created"}),]})],confirm:function(e){var a="";var s=e.getParameter("filterItems");t.setFiltering(e.getParameter("filterKeys"));if(s&&s.length){var b={};for(var i=0,l=s.length;i<l;i++){b[s[i].getParent().getKey()]=b[s[i].getParent().getKey()]||"";b[s[i].getParent().getKey()]+=(b[s[i].getParent().getKey()])?(","):"";b[s[i].getParent().getKey()]+=s[i].getText()}for(var c in b){if(b.hasOwnProperty(c)){a+=(a)?" ; ":"";a+=b[c]}}}}});return f},});
