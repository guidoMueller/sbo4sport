jQuery.sap.declare("sap.zen.crosstab.rendering.CrossRequestManager");jQuery.sap.require("sap.zen.crosstab.rendering.ScrollManager");jQuery.sap.require("sap.zen.crosstab.rendering.PixelScrollManager");jQuery.sap.require("sap.zen.crosstab.rendering.HeaderScrollManager");jQuery.sap.require("sap.zen.crosstab.rendering.RenderingConstants");jQuery.sap.require("sap.zen.crosstab.utils.Utils");
sap.zen.crosstab.rendering.CrossRequestManager=function(c,r){"use strict";var s=null;var h=null;var H=0;var a="";var v=0;var V="";var b=false;var C=null;var d=null;var D=null;var R=null;var e=false;var f="";var g="";var t=0;var T=0;var i=0;var j=0;var A=false;var k=false;var l=false;var m=undefined;var n=undefined;var o=null;var p=c.getDataArea();var q=c.getRowHeaderArea();var u=c.getColumnHeaderArea();var w=c.getDimensionHeaderArea();this.reset=function(){if(s){s.destroy()}s=null;if(h){h.destroy()}h=null};this.clearSavedData=function(){s=null;h=null;H=0;a="";v=0;V="";b=false;C=null;d=null;D=null;R=null;e=false;f="";g="";t=0;T=0;o=null};this.saveTableDimensions=function(){if(c.getPropertyBag().isPixelScrolling()){var B=$('#'+c.getId()+"_dataArea");i=B.outerHeight();j=B.outerWidth()}t=c.getTotalRows();T=c.getTotalCols()};function x(B){if(g==="expanded"){return(B<0)}else if(g==="collapsed"){return(B>0)}else{return false}}this.handleRootCause=function(){var O=v;var B=H;var E=m;var F=n;if(f==="plan"){if(a!=="plan"&&V!=="plan"){this.clearSavedData()}}else if(f==="sorting"){if(a!=="sort"){this.clearSavedData()}else{var S=c.getSelectedCellData();if(S&&S.sAreaType===sap.zen.crosstab.rendering.RenderingConstants.TYPE_ROW_HEADER_AREA){v=Math.max(0,(S.iRow-1));r.setDeferredVScrollPosDetermination(c.getPropertyBag().isPixelScrolling())}else{v=0;n=false}}}else if(f==="hierarchy"){if(a==="hier"&&V==="hier"){var G=t-c.getTotalRows();var I=T-c.getTotalCols();if(G!==0){if(x(G)){if(!e){if(c.getPropertyBag().isPixelScrolling()){k=true}else{v=Math.max(0,v-G)}}}else{this.clearSavedData()}}else if(I!==0){if(x(I)){if(!e){if(c.getPropertyBag().isPixelScrolling()){A=true}else{H=Math.max(0,H-I)}}}else{this.clearSavedData()}}}else{this.clearSavedData()}}e=false;f="";g="";t=0;T=0;if(B!==H||O!==v||E!==m||F!==n){c.getUtils().sendScrollPosUpdate(H,m,v,n)}l=true};this.getHPixelScrollPosAfterRendering=function(){var P=-1;if(c.getPropertyBag().isPixelScrolling()){var B=$('#'+c.getId()+"_dataArea");if(A){var E=B.outerWidth()-j;P=H+E;A=false}}return P};this.getVPixelScrollPosAfterRendering=function(){var P=-1;if(c.getPropertyBag().isPixelScrolling()){var B=$('#'+c.getId()+"_dataArea");if(k){var E=B.outerHeight()-i;P=v+E;k=false}}return P};this.setRootCause=function(B){f=B};this.setHierarchyAction=function(B){g=B};this.setIsHierarchyDirectionDown=function(I){e=I};this.getScrollManager=function(){if(!s){if(c.getPropertyBag().isPixelScrolling()){s=new sap.zen.crosstab.rendering.PixelScrollManager(c,r)}else{s=new sap.zen.crosstab.rendering.ScrollManager(c,r)}if(b){if(a){s.setHScrollPos(H)}if(V){s.setVScrollPos(v)}}}return s};this.getHeaderScrollManager=function(){if(!h){h=new sap.zen.crosstab.rendering.HeaderScrollManager(c,r);if(b){h.setHScrollData(o)}}return h};this.saveHScrollInfo=function(B,E){if(c.getPropertyBag().isPixelScrolling()){var F=$('#'+c.getId()+"_lowerRight_scrollDiv");H=0;if(F&&F.length>0){H=F.scrollLeft()}}else{H=c.getColumnHeaderArea().getRenderStartCol();if(s&&s.isHScrolledToEnd()){H++;m=true}}if(E){v=0}a=B;b=true};this.saveVScrollInfo=function(B,E){if(c.getPropertyBag().isPixelScrolling()){var F=$('#'+c.getId()+"_lowerRight_scrollDiv");v=0;if(F&&F.length>0){v=F.scrollTop()}}else{v=c.getRowHeaderArea().getRenderStartRow();if(s&&s.isVScrolledToEnd()){v++;n=true}}if(E){H=0}V=B;b=true};this.saveSDKVScrollInfo=function(B,E){v=B;b=true;V=E};this.saveSDKHScrollInfo=function(B,E){H=B;b=true;a=E};this.savedInfoHandled=function(){if(l===true){H=0;a="";v=0;V="";b=false;C=null;d=null;D=null;R=null;l=false;m=undefined;n=undefined;o=null}};this.hasSavedInfo=function(){return b};this.getSavedHScrollInfo=function(){var B=null;if(a){B={};B.iPos=H;B.sAction=a;B.bScrolledToEnd=m}return B};this.getSavedVScrollInfo=function(){var B=null;if(V){B={};B.iPos=v;B.sAction=V;B.bScrolledToEnd=n}return B};this.saveColWidths=function(){var u=c.getColumnHeaderArea();var w=c.getDimensionHeaderArea();var q=c.getRowHeaderArea();var p=c.getDataArea();if(!u.hasLoadingPages()){C=u.getColWidths();b=true}if(!p.hasLoadingPages()){D=p.getColWidths();b=true}if(!w.hasLoadingPages()){d=w.getColWidths();b=true}if(!q.hasLoadingPages()){R=q.getColWidths();b=true}};this.restoreColWidths=function(){var u=c.getColumnHeaderArea();var w=c.getDimensionHeaderArea();var q=c.getRowHeaderArea();var p=c.getDataArea();if(C){u.setColWidths(C);C=null}if(D){p.setColWidths(D);D=null}if(d){w.setColWidths(d);d=null}if(R){q.setColWidths(R);R=null}};function y(B,E,F,G){var I={iHScrollPos:B,bHScrolledToEnd:E,iVScrollPos:F,bVScrolledToEnd:G};if(I.iHScrollPos<0){I.iHScrollPos=0;I.bHScrolledToEnd=false}if(I.iVScrollPos<0){I.iVScrollPos=0;I.bVScrolledToEnd=false}var J=p?p:u;var L=J.getColCnt()-1;if(I.iHScrollPos>L){I.iHScrollPos=0;I.bHScrolledToEnd=false}J=p?p:q;var K=J.getRowCnt()-1;if(I.iVScrollPos>K){I.iVScrollPos=0;I.bVScrolledToEnd=false}if((I.iHScrollPos!==B)||(I.iVScrollPos!==F)){c.getUtils().sendScrollPosUpdate(0,false,0,false)}return I}this.setScrollData=function(B,E,F,G){var I=y(B,E,F,G);H=I.iHScrollPos;v=I.iVScrollPos;m=I.bHScrolledToEnd;n=I.bVScrolledToEnd;b=true;a="GEN";V="GEN"};function z(B){var E=B;if(E.iHPos<0){E.iHPos=0}if(E.iHPos!==B.iHPos){c.getUtils().sendScrollPosUpdate(E.iHPos,undefined,undefined,undefined,true)}return E}this.setHeaderScrollData=function(B){var E=z(B);b=true;o=E};this.getHeaderScrollData=function(){return o}};
