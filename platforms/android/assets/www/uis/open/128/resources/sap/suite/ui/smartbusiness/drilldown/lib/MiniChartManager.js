jQuery.sap.declare("sap.suite.ui.smartbusiness.drilldown.lib.MiniChartManager");sap.suite=sap.suite||{};sap.suite.smartbusiness=sap.suite.smartbusiness||{};sap.suite.smartbusiness.miniChartManager=(function(){"use strict";var h=[];var V={NT:"Numeric",CT:"Comparison",AT:"Bullet",TT:"AreaChart",CM:"MeasureComparison"};var a={"NT":4,"AT":3,"CT":2,"TT":1,"CM":0};var u=sap.ushell.Container.getService("URLParsing");var g=function(p,o){var e="";if(o.isAssociated())e=o.getReferenceEvaluationId();else e=o.getReferenceEvaluationId();var r=[];var d="";if(sap.suite.smartbusiness.cache.getEvaluationById(e))d=sap.suite.smartbusiness.cache.getEvaluationById(e).ODATA_URL;if(d){var U=u.addSystemToServiceUrl(sap.suite.smartbusiness.cache.getEvaluationById(e).ODATA_URL,p.sapSystem);var b=sap.suite.smartbusiness.cache.getEvaluationById(e).ODATA_ENTITYSET;var c=sap.suite.smartbusiness.odata.getAllDimensions(U,b);for(var i=0;i<p.urlFilters.length;i++){if(c.indexOf(p.urlFilters[i].NAME)!=-1)r.push(p.urlFilters[i])}}return r};return{renderHeaders:function(p){if(p.allTiles.length){var b=p.allTiles;h=[];b.forEach(function(o){var t=o.getVisualizationType();if(V[t]){var c=V[t];jQuery.sap.require("sap.suite.ui.smartbusiness.tiles."+c);if(sap.suite.ui.smartbusiness.tiles[c]){var f=g(p,o);var d=new sap.suite.ui.smartbusiness.tiles[c]({dimension:o.getDimension(),evaluationId:o.getEvaluationId(),associationEvaluationId:o.getReferenceEvaluationId(),sapSystem:p.sapSystem,additionalFilters:f,tileConfiguration:o.getTileConfiguration()}).addStyleClass("drilldownKpiTiles");h.push(d);var e=new sap.suite.ui.commons.HeaderCellItem();var i=new sap.suite.ui.commons.HeaderCell();p.headerContainer.addItem(d);if(p.urlFilters.length){if(f&&f.length){}else{d.setVisible(false);d.setClick(false)}}}else{jQuery.sap.log.error("Ignoring the tile "+c+" : Not Implemented Yet")}}else{jQuery.sap.log.error("No Tile Mapping  for Visualisation Type : "+t)}})}},hashChangeListner:function(p){if(p.firstTimeFlag){var b=[];var c=p.allTiles;for(var i=0;i<c.length;i++){var d=null;var o=c[i];var e=h[i];e.abortODataCalls();var f=g(p,o);if(p.urlFilters.length){if(f&&f.length){e.$().css("opacity","1");e.setAdditionalFilters(f);e.$().off("click")}else{e.$().css("opacity","0.2");e.$().click(function(){return false})}}else{e.$().css("opacity","1");e.setAdditionalFilters(f);e.$().off("click")}}}},}})();
