
function TestObject(){this.name="TestObject"}
;
TestObject.prototype.getName=function(){return this.name};
TestObject.prototype.setName=function(n){this.name=n};
jQuery.sap.declare('sap.zen.crosstab.library-all');jQuery.sap.declare('sap.zen.crosstab.nonphx.logic');if(!jQuery.sap.isDeclared('sap.zen.crosstab.CrosstabCellApi')){jQuery.sap.declare("sap.zen.crosstab.CrosstabCellApi");sap.zen.crosstab.CrosstabCellApi=function(c,f,F,t,T){"use strict";var d=c.getDataArea();var C=c.getColumnHeaderArea();var r=c.getRowHeaderArea();var D=c.getDimensionHeaderArea();this.getTableCell=function(R,i){var o=null;if(i>=f&&R>=F){o=d.getCell(R-F,i-f)}else if(i<f&&R<F){o=D.getCell(R,i)}else if(i>=f&&R<F){o=C.getCell(R,i-f)}else if(i<f&&R>=F){o=r.getCell(R-F,i)}return o};this.getTableCellWithSpans=function(R,i){var o=this.getTableCell(R,i);var a=i--;while(!o&&a>=0){var b=R;o=this.getTableCell(b,a);if(o&&o.isLoading()){return o}if(!o){b--;while(!o&&b>=0){o=this.getTableCell(b,a);b--}if(o){if(o.isLoading()){return o}var l=o.getTableRow()+o.getRowSpan()-1;if(l<R){o=null}}}a--}return o};this.getTableRowCnt=function(){return T+F};this.getTableColCnt=function(){return t+f};this.getTableMaxScrollRowCnt=function(){return T};this.getTableMaxScrollColCnt=function(){return t};this.getTableFixedRowHeaderColCnt=function(){return f};this.getTableFixedColHeaderRowCnt=function(){return F}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.CrosstabTestProxy')){jQuery.sap.declare("sap.zen.crosstab.CrosstabTestProxy");sap.zen.crosstab.CrosstabTestProxy=function(c,E,r){var t=false;function f(a,R,C,A){var o=a.getDataModel().getCellWithSpan(R,C);if(o){var e={};var d=$('#'+o.getId());if(d&&d.length>0){e.target=d[0];A(e)}}}this.hoverCell=function(a,R,C){f(a,R,C,E.executeOnMouseEnter)};this.selectCell=function(a,R,C){f(a,R,C,E.executeOnClickAction)};this.setTestAction=function(i){t=i};this.getTestAction=function(){return t};this.testClickSortOrHierarchy=function(a,R,C){var o=a.getDataModel().getCellWithSpan(R,C);if(o){var T=$('#sort_'+o.getId());if(T&&T.length>0){var e={};e.target=T[0];E.executeOnClickAction(e)}}};this.doubleClickColResize=function(R,C){var o=c.getColumnHeaderArea().getCell(R,C);if(o){var i="resi_"+o.getId();var e={};e.target={};e.target.id=i;E.executeOnDblClickAction(e)}}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.IDataCell')){jQuery.sap.declare("sap.zen.crosstab.IDataCell");sap.zen.crosstab.IDataCell=function(d){"use strict";this.getText=function(){return d.getText()};this.getId=function(){return d.getId()};this.getRow=function(){return d.getRow()};this.getCol=function(){return d.getCol()}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.IHeaderCell')){jQuery.sap.declare("sap.zen.crosstab.IHeaderCell");sap.zen.crosstab.IHeaderCell=function(h){"use strict";this.getText=function(){return h.getText()};this.getId=function(){return h.getId()};this.getRow=function(){return h.getRow()};this.getCol=function(){return h.getCol()}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.PropertyBag')){jQuery.sap.declare("sap.zen.crosstab.PropertyBag");sap.zen.crosstab.PropertyBag=function(c){var d=false;var m=false;var p=false;var s=false;var h=false;var t=0;var D=false;var e=true;var T=false;var C=null;var M=0;this.setMaxHeaderWidth=function(a){M=a};this.getMaxHeaderWidth=function(){return M};this.isDebugMode=function(){return d};this.setDebugMode=function(a){d=a};this.isMobileMode=function(){return m};this.isTestMobileMode=function(){return T};this.setMobileMode=function(a){m=a};this.isPixelScrolling=function(){return p};this.setPixelScrolling=function(a){p=a};this.isSelectionEnabled=function(){return s};this.setSelectionEnabled=function(a){s=a};this.isDisplayExceptions=function(){return D};this.setDisplayExceptions=function(a){D=a};this.addText=function(k,a){sap.zen.CrosstabTextCache.oTexts[k]=a};this.getText=function(k){return sap.zen.CrosstabTextCache.oTexts[k]};this.setContextMenuCommand=function(a){C=a};this.getContextMenuCommand=function(){return C};this.setHasToolbar=function(a){h=a};this.hasToolbar=function(){return h};this.setToolbarHeight=function(a){t=a};this.getToolbarHeight=function(){var H=0;if(h){H=t}return H};this.setEnableColResize=function(a){e=a};this.isEnableColResize=function(){return e};this.addSortingTextLookup=function(k,S){sap.zen.CrosstabTextCache.oSortingTextLookupTable[k]=S};this.getSortingAltText=function(k){var a="";if(sap.zen.CrosstabTextCache.oSortingTextLookupTable[k]){a=sap.zen.CrosstabTextCache.oSortingTextLookupTable[k].alttext}return a};this.getSortingToolTip=function(k){var a=null;var b="";if(sap.zen.CrosstabTextCache.oSortingTextLookupTable[k]){a=sap.zen.CrosstabTextCache.oSortingTextLookupTable[k].tooltipidx}if(a!==undefined){if(sap.zen.CrosstabTextCache.oSortingTextLookupTable[a]){b=sap.zen.CrosstabTextCache.oSortingTextLookupTable[a].alttext}}return b}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.TextConstants')){jQuery.sap.declare("sap.zen.crosstab.TextConstants");sap.zen.crosstab.TextConstants=sap.zen.crosstab.TextConstants||{};sap.zen.crosstab.TextConstants.ROW_TEXT_KEY="ROW_TEXT";sap.zen.crosstab.TextConstants.COL_TEXT_KEY="COL_TEXT";sap.zen.crosstab.TextConstants.COLWIDTH_ADJUST_TEXT_KEY="COLWIDTH_ADJUST_TEXT";sap.zen.crosstab.TextConstants.MOBILE_MENUITEM_COLWIDTH_ADJUST_TEXT_KEY="MOBILE_MENUITEM_COLWIDTH_ADJUST"};if(!jQuery.sap.isDeclared('sap.zen.crosstab.library')){jQuery.sap.declare("sap.zen.crosstab.library");jQuery.sap.require('sap.ui.core.Core');jQuery.sap.require('sap.ui.core.library');sap.ui.getCore().initLibrary({name:"sap.zen.crosstab",dependencies:["sap.ui.core"],types:[],interfaces:[],controls:["sap.zen.crosstab.Crosstab","sap.zen.crosstab.DataCell","sap.zen.crosstab.HeaderCell"],elements:[],version:"14.1.0"})};if(!jQuery.sap.isDeclared('sap.zen.crosstab.paging.PagingConstants')){jQuery.sap.declare("sap.zen.crosstab.paging.PagingConstants");sap.zen.crosstab.paging.PagingConstants=sap.zen.crosstab.paging.PagingConstants||{};sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_UNKNOWN=0;sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADING=1;sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADED=2};if(!jQuery.sap.isDeclared('sap.zen.crosstab.paging.RequestStack')){jQuery.sap.declare("sap.zen.crosstab.paging.RequestStack");sap.zen.crosstab.paging.RequestStack=function(m){"use strict";var e=[];var E=[];var M=m;this.push=function(o){var r=null;var b=false;var a=$.inArray(o,e);if(a!=-1){e.splice(a,1)}if(M){if(e.length===M){r=e[0];b=true;e=e.splice(1,e.length-1)}e.push(o);if(b){s(r)}}else{e.push(o)}};this.pop=function(){return e.pop()};this.peek=function(){var p=null;if(e.length>0){p=e[e.length-1]}return p};this.containsElement=function(o){return($.inArray(o,e)!=-1)};this.clear=function(){e=[]};this.getActualSize=function(){return e.length};this.getMaxSize=function(){return M};this.getElementAt=function(i){var o=null;if(i>=0&&i<e.length){o=e[i]}return o};this.resetStack=function(m){e=[];M=m};this.unlimitStack=function(){M=0};this.addElementRemovedHandler=function(h){E.push(h)};this.removeElementRemovedHandler=function(h){var i=$.inArray(h,E);if(i!==-1){E.splice(i,1)}};this.removeAllElementRemovedHandlers=function(){E=[]};function s(o){var i=0;var h=null;for(i=0;i<E.length;i++){h=E[i];if(h){h(o)}}}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.rendering.DataModel')){jQuery.sap.declare("sap.zen.crosstab.rendering.DataModel");sap.zen.crosstab.rendering.DataModel=function(a){"use strict";var m=[];var r=0;var c=0;var p=null;this.insertCell=function(C,R,d){if(R>r-1||d>c-1){throw{name:"DataModelIndexOutOfBounds",message:"A cell cannot be inserted out of the bounds defined by iRowCnt and iColCnt"}}var M=g(R);M[d]=C;if(C){var i=0;var j=0;for(i=1;i<C.getColSpan();i++){M[d+i]=null}for(i=0;i<C.getColSpan();i++){for(j=1;j<C.getRowSpan();j++){M=g(R+j);M[d+i]=null}}}};this.getCellDirect=function(R,C){var o=null;var M=m[R];if(M){o=M[C]}if(o&&o.setEffectiveRowSpan&&o.setEffectiveColSpan){o.setEffectiveRowSpan(o.getRowSpan());o.setEffectiveColSpan(o.getColSpan())}return o};function g(R){var M=m[R];if(!M){M=[];m[R]=M}return M}this.getCell=function(R,C,d){var o=b(R,C,d);if(o&&o.setEffectiveRowSpan&&o.setEffectiveColSpan){o.setEffectiveRowSpan(o.getRowSpan());o.setEffectiveColSpan(o.getColSpan())}return o};function b(R,C,d){if(!p&&a){p=a.getPageManager()}if(p&&!d){p.ensureCellAvailable(a,R,C)}var o=null;var M=m[R];if(M){o=M[C]}return o}this.setRowCnt=function(R){r=R};this.getRowCnt=function(){return r};this.setColCnt=function(C){c=C};this.getColCnt=function(){return c};this.clear=function(){m=[];r=0;c=0};this.hasData=function(){return m.length>0};this.getCellWithSpan=function(R,C){var o=this.getCellWithColSpan(R,C);if(!o){o=this.getCellWithRowSpan(R,C)}return o};this.getCellWithRowSpan=function(R,C,d){var o=this.getCell(R,C,d);if(!o){var i=1;while(!o&&R>0){R--;i++;o=this.getCell(R,C,d)}if(o&&o.getRowSpan()<i){o=null}if(o&&o.setEffectiveRowSpan){o.setEffectiveRowSpan(o.getRowSpan()-i+1)}}else{if(o.setEffectiveRowSpan){o.setEffectiveRowSpan(o.getRowSpan())}}return o};this.getCellWithColSpan=function(R,C,d){var o=this.getCell(R,C,d);if(!o){var i=1;while(!o&&C>0){C--;i++;o=this.getCell(R,C,d)}if(o&&o.getColSpan()<i){o=null}if(o&&o.setEffectiveColSpan){o.setEffectiveColSpan(o.getColSpan()-i+1)}}else{if(o.setEffectiveColSpan){o.setEffectiveColSpan(o.getColSpan())}}return o};this.getCellsByCol=function(C,s,r){var d=[];var o=null;var R=s;var M=s+r;for(R;R<M;R++){o=this.getCellWithColSpan(R,C);if(o){d.push(o)}}return d};this.getCellsByRow=function(R,s,c){var C=[];var i=s;var M=s+c;var o=null;for(i;i<M;i++){o=this.getCellWithRowSpan(R,i);if(o){C.push(o)}}return C};this.getModelRows=function(){return m}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.rendering.DomElementProvider')){jQuery.sap.declare("sap.zen.crosstab.rendering.DomElementProvider");sap.zen.crosstab.rendering.DomElementProvider=function(){var d={};this.addElement=function(i,D){d[i]=D};this.getElement=function(i){return d[i]}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.rendering.HeaderScrollManager')){jQuery.sap.declare("sap.zen.crosstab.rendering.HeaderScrollManager");sap.zen.crosstab.rendering.HeaderScrollManager=function(c,r){"use strict";var s={};var C=0;var t=this;var o=r.getCrossRequestManager();var u=null;this.destroy=function(){};this.onNewScrollbars=function(){s={}};r.registerNewScrollbarsNotification(this.onNewScrollbars);function g(S){var j=s[S];if(!j){j=$('#'+c.getId()+S);if(j&&j.length>0){s[S]=j}}return j}function m(){g("_lowerLeft_scrollDiv").scrollLeft(C);g("_upperLeft_scrollDiv").scrollLeft(C)}this.hScrollHandler=function(e){var O=C;C=e.getParameters().newScrollPos;m();if(O!==C){t.sendClientScrollPosUpdate()}};this.sendClientScrollPosUpdate=function(){if(u){clearTimeout(u);u=null}u=setTimeout(t.doSendPosUpdate,200,null)};this.doSendPosUpdate=function(){c.getUtils().sendClientScrollPosUpdate(C,undefined,undefined,undefined,true)};this.setHScrollData=function(h){if(h){C=h.iHPos}else{C=0}};this.moveScrollbars=function(){var h=c.getHorizontalHeaderScrollbar();if(h){m();h.setScrollPosition(C)}}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.rendering.PixelScrollManager')){jQuery.sap.declare("sap.zen.crosstab.rendering.PixelScrollManager");sap.zen.crosstab.rendering.PixelScrollManager=function(c,r){"use strict";var s={};var C=0;var i=0;var o=r.getCrossRequestManager();var t=this;var u=null;this.destroy=function(){};this.onNewScrollbars=function(){s={}};r.registerNewScrollbarsNotification(this.onNewScrollbars);function g(S){var D=s[S];if(!D){D=$('#'+c.getId()+S);if(D&&D.length>0){s[S]=D}}return D}function m(p){g("_lowerLeft_scrollDiv").scrollTop(p);g("_lowerRight_scrollDiv").scrollTop(p)}function a(p){g("_lowerRight_scrollDiv").scrollLeft(p);g("_upperRight_scrollDiv").scrollLeft(p)}this.hScrollHandler=function(e){var p=e.getParameters().newScrollPos;a(p);i=p;t.sendClientScrollPosUpdate()};this.vScrollHandler=function(e){var p=e.getParameters().newScrollPos;m(p);C=p;t.sendClientScrollPosUpdate()};this.sendClientScrollPosUpdate=function(){if(u){clearTimeout(u);u=null}u=setTimeout(t.doSendPosUpdate,200,null)};this.doSendPosUpdate=function(){c.getUtils().sendClientScrollPosUpdate(i,undefined,C,undefined)};function b(p){var h=c.getHScrollbar();if(h){h.setScrollPosition(p)}var D=$('#'+c.getId()+"_lowerRight_scrollDiv");if(D&&D.length){D.scrollLeft(p)}var e=$('#'+c.getId()+"_upperRight_scrollDiv");if(e&&e.length){e.scrollLeft(p)}}function d(p){var v=c.getVScrollbar();if(v){v.setScrollPosition(p)}var D=$('#'+c.getId()+"_lowerRight_scrollDiv");if(D&&D.length){D.scrollTop(p)}var e=$('#'+c.getId()+"_lowerLeft_scrollDiv");if(e&&e.length){e.scrollTop(p)}}this.moveScrollbars=function(S,R,p,e){b(i);d(C)};this.positionHScrollDiv=function(l){var p=i;var n=o.getHPixelScrollPosAfterRendering();if(n>-1){p=n;b(p)}a(p)};this.positionVScrollDiv=function(l){var p=C;var n=o.getVPixelScrollPosAfterRendering();if(n>-1){p=n;d(p)}m(p)};this.setHScrollPos=function(h){i=h};this.setVScrollPos=function(v){C=v};this.adjustPixelScrollbarAfterRendering=function(){var n=o.getNewPixelScrollPosAfterRendering();if(n){var v=n.iVPos;if(v>=0){oVScrollbar=c.getVScrollbar();if(oVScrollbar){oVScrollbar.setScrollPosition(v);m(v)}}var h=n.iHPos;if(h>=0){oHScrollbar=c.getHScrollbar();if(oHScrollbar){oHScrollbar.setScrollPosition(h);a(h)}}}}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.rendering.RenderingConstants')){jQuery.sap.declare("sap.zen.crosstab.rendering.RenderingConstants");sap.zen.crosstab.rendering.RenderingConstants=sap.zen.crosstab.rendering.RenderingConstants||{};sap.zen.crosstab.rendering.RenderingConstants.TYPE_DATA_AREA="DataArea";sap.zen.crosstab.rendering.RenderingConstants.TYPE_DIMENSION_HEADER_AREA="DimensionHeaderArea";sap.zen.crosstab.rendering.RenderingConstants.TYPE_COLUMN_HEADER_AREA="ColumnHeaderArea";sap.zen.crosstab.rendering.RenderingConstants.TYPE_ROW_HEADER_AREA="RowHeaderArea";sap.zen.crosstab.rendering.RenderingConstants.TYPE_HEADER_CELL="HEADER_CELL";sap.zen.crosstab.rendering.RenderingConstants.TYPE_DATA_CELL="DATA_CELL";sap.zen.crosstab.rendering.RenderingConstants.STYLE_PREFIX_DATA_CELL="sapzencrosstab-DataCell";sap.zen.crosstab.rendering.RenderingConstants.STYLE_PREFIX_HEADER_CELL="sapzencrosstab-HeaderCell";sap.zen.crosstab.rendering.RenderingConstants.STYLE_TOTAL="Total";sap.zen.crosstab.rendering.RenderingConstants.STYLE_ALTERNATING="Alternating";sap.zen.crosstab.rendering.RenderingConstants.STYLE_FIRST_IN_ROW="FirstInRow";sap.zen.crosstab.rendering.RenderingConstants.STYLE_LAST_IN_ROW="LastInRow";sap.zen.crosstab.rendering.RenderingConstants.STYLE_FIRST_IN_COL="FirstInCol";sap.zen.crosstab.rendering.RenderingConstants.STYLE_LAST_IN_COL="LastInCol";sap.zen.crosstab.rendering.RenderingConstants.STYLE_HEADER_CELL="Default";sap.zen.crosstab.rendering.RenderingConstants.STYLE_DATA_CELL="Default";sap.zen.crosstab.rendering.RenderingConstants.STYLE_LOADING="Loading";sap.zen.crosstab.rendering.RenderingConstants.STYLE_HIGHLIGHTED="Highlighted";sap.zen.crosstab.rendering.RenderingConstants.STYLE_EMPHASIZED="Emphasized";sap.zen.crosstab.rendering.RenderingConstants.STYLE_DATA_ENTRY_ENABLED="EntryEnabled";sap.zen.crosstab.rendering.RenderingConstants.STYLE_INVALID_VALUE="InvalidValue";sap.zen.crosstab.rendering.RenderingConstants.STYLE_NEW_VALUE="NewValue";sap.zen.crosstab.rendering.RenderingConstants.STYLE_LOCKED="Locked";sap.zen.crosstab.rendering.RenderingConstants.ALERT_TYPE_BACKGROUND=2;sap.zen.crosstab.rendering.RenderingConstants.ALERT_TYPE_FONT_COLOR=4;sap.zen.crosstab.rendering.RenderingConstants.ALERT_TYPE_STATUS_SYMBOL=8;sap.zen.crosstab.rendering.RenderingConstants.ALERT_TYPE_TREND_ASCENDING_SYMBOL=16;sap.zen.crosstab.rendering.RenderingConstants.ALERT_TYPE_TREND_DESCENDING_SYMBOL=32;sap.zen.crosstab.rendering.RenderingConstants.ALERT_TYPE_TREND_GREY_SYMBOL=64;sap.zen.crosstab.rendering.RenderingConstants.RENDERMODE_FILL=0;sap.zen.crosstab.rendering.RenderingConstants.RENDERMODE_COMPACT=1;sap.zen.crosstab.rendering.RenderingConstants.PASSIVE_CELL_TYPE_NORMAL="NORMAL";sap.zen.crosstab.rendering.RenderingConstants.PASSIVE_CELL_TYPE_NEWLINE_HEADER="NHC";sap.zen.crosstab.rendering.RenderingConstants.PASSIVE_CELL_TYPE_NEWLINE_DATA="NDC";sap.zen.crosstab.rendering.RenderingConstants.TABINDEX="-1"};if(!jQuery.sap.isDeclared('sap.zen.crosstab.utils.Measuring')){jQuery.sap.declare("sap.zen.crosstab.utils.Measuring");sap.zen.crosstab.utils.Measuring=function(c,d){"use strict";var D=c.getDimensionHeaderArea();var C=c.getColumnHeaderArea();var r=c.getRowHeaderArea();var o=c.getDataArea();var i=c.getIntWidth();var a=c.getIntHeight();var R=null;var t=null;var b=null;var s=0;this.getUpperLeftScrollDivWidth=function(){var j=$('#'+c.getId()+"_upperLeft_scrollDiv");return j.outerWidth()};this.getLowerLeftScrollDivWidth=function(){var j=$('#'+c.getId()+"_lowerLeft_scrollDiv");return j.outerWidth()};this.getAreaWidth=function(A){var j=$('#'+A.getId()+"_container");var w=j.outerWidth();var S=0;if(A.isDimHeaderArea()){S=this.getUpperLeftScrollDivWidth()}else if(A.isRowHeaderArea()){S=this.getLowerLeftScrollDivWidth()}if(S>0){w=Math.min(w,S)}return w};this.getAreaHeight=function(A){var e=$('#'+A.getId()+"_container");return e.outerHeight()};this.getAreaSize=function(A){var S={};var e=$('#'+A.getId()+"_container");S.iHeight=e.outerHeight();S.iWidth=this.getAreaWidth(A);return S};this.getRenderSizeDivSize=function(){var S={};var e=$('#'+c.getId()+"_renderSizeDiv");S.iWidth=e.outerWidth();S.iHeight=e.outerHeight();return S};this.calculateRenderSize=function(f){f=f||false;if(!b||this.hasCrosstabSizeChanged()||f){b={};var e=this.getAreaSize(D);var g=this.getAreaSize(o);var h=this.getAreaSize(r);var j=this.getAreaSize(C);var l=r.hasContent()?h.iHeight:g.iHeight;var u=D.hasContent()?e.iHeight:j.iHeight;b.iHeight=l+u;var L=D.hasContent()?e.iWidth:h.iWidth;var k=C.hasContent()?j.iWidth:g.iWidth;b.iWidth=L+k}return b};this.getBrowserScrollbarWidth=function(){if(!s){var e=document.createElement('p');e.style.width="100%";e.style.height="200px";var f=document.createElement('div');f.style.position="absolute";f.style.top="0px";f.style.left="0px";f.style.visibility="hidden";f.style.width="200px";f.style.height="150px";f.style.overflow="hidden";f.appendChild(e);document.body.appendChild(f);var w=e.offsetWidth;f.style.overflow='scroll';var g=e.offsetWidth;if(w==g)g=f.clientWidth;document.body.removeChild(f);s=(w-g);if(s===0){var p,h;p=$('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo('body');h=p.children();s=h.innerWidth()-h.height(99).innerWidth();p.remove()}}return s};this.reset=function(){b=null};this.hasCrosstabSizeChanged=function(q){var n=c.getIntWidth();var e=c.getIntHeight();if(i!==n||a!==e){if(!q){i=n;a=e}return true}return false};this.getLowerScrollDivHeight=function(){var e=null;if(r.hasContent()){e=$('#'+c.getId()+"_lowerLeft_scrollDiv")}else{e=$('#'+c.getId()+"_lowerRight_scrollDiv")}return e.outerHeight()};this.getUpperScrollDivHeight=function(){var e=null;if(D.hasContent()){e=$('#'+c.getId()+"_upperLeft_scrollDiv")}else{e=$('#'+c.getId()+"_upperRight_scrollDiv")}return e.outerHeight()};this.getUpperRightScrollDivWidth=function(){var e=$('#'+c.getId()+"_upperRight_scrollDiv");return e.outerWidth()};this.getRenderSizeDivBorders=function(e){if(!R){R={};R.borders={};if(!e){e=$('#'+c.getId()+"_renderSizeDiv")}R.borders.iBottomBorderWidth=parseInt(e.css("border-bottom-width"),10)||0;R.borders.iRightBorderWidth=parseInt(e.css("border-right-width"),10)||0;R.borders.iTopBorderWidth=parseInt(e.css("border-top-width"),10)||0;R.borders.iLeftBorderWidth=parseInt(e.css("border-left-width"),10)||0}return R};this.getTableDivBordersAndPadding=function(){if(!t){t={};t.borders={};t.paddings={};var e=d.getElement(c.getId());t.borders.iBottomBorderWidth=parseInt(e.css("border-bottom-width"),10);t.borders.iRightBorderWidth=parseInt(e.css("border-right-width"),10);t.borders.iTopBorderWidth=parseInt(e.css("border-top-width"),10);t.borders.iLeftBorderWidth=parseInt(e.css("border-left-width"),10);t.paddings.iBottomPadding=parseInt(e.css("padding-bottom"),10);t.paddings.iRightPadding=parseInt(e.css("padding-right"),10);t.paddings.iTopPadding=parseInt(e.css("padding-top"),10);t.paddings.iLeftPadding=parseInt(e.css("padding-left"),10)}return t};this.reset=function(){R=null}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.utils.Utils')){jQuery.sap.declare("sap.zen.crosstab.utils.Utils");sap.zen.crosstab.utils.Utils=function(c){var t=this;this.getModelCoordinates=function(a,A,s){var m={};m.iRow=a;m.iCol=A;var C=c.getColumnHeaderArea().getRowCnt();var r=c.getRowHeaderArea().getColCnt();if(s===sap.zen.crosstab.rendering.RenderingConstants.TYPE_DATA_AREA){m.iRow+=C;m.iCol+=r}else if(s===sap.zen.crosstab.rendering.RenderingConstants.TYPE_COLUMN_HEADER_AREA){m.iCol+=r}else if(s===sap.zen.crosstab.rendering.RenderingConstants.TYPE_ROW_HEADER_AREA){m.iRow+=C}return m};this.selectTextInInputField=function(i,s,S){if(s===-1&&S===-1){i.select()}else{oDomInputField=i[0];if(c.isIE8Mode()){if(oDomInputField.createTextRange!=="undefined"){var r=oDomInputField.createTextRange();r.collapse(true);r.moveEnd("character",S+1);r.moveStart("character",s);r.select()}}else if(oDomInputField.selectionStart!=="undefined"){oDomInputField.selectionStart=s;oDomInputField.selectionEnd=S}}};this.getSelectionParams=function(d){var s=-1;var e=-1;if(c.isIE8Mode()){if(document.selection!=="undefined"&&document.selection.type==="Text"){oRange=document.selection.createRange();if(oRange&&oRange.text.length>0){var b=document.body.createTextRange();b.moveToElementText(d);b.setEndPoint("EndToStart",oRange);s=b.text.length;e=s+oRange.text.length-1}}}else if(window.getSelection){var S=window.getSelection().toString();if(S&&S.length>0){s=window.getSelection().anchorOffset;e=window.getSelection().focusOffset}}return{iSelectionStartPos:s,iSelectionEndPos:e}};this.sendClientScrollPosUpdate=function(C,h,i,v,I){var o=c.getRenderEngine().getCrossRequestManager();if(o){if(I===true){o.setHeaderScrollData({"iHPos":C})}else{o.setScrollData(C,h,i,v)}}t.sendScrollPosUpdate(C,h,i,v,I)};this.sendScrollPosUpdate=function(p,a,b,d,i){var C=c.getScrollNotifyCommand();if(C){C=C.replace("__CLIENT_VPOS__",b);C=C.replace("__CLIENT_VPOS_END__",d?"X":" ");C=C.replace("__CLIENT_HPOS__",(i?"H"+p:p));C=C.replace("__CLIENT_HPOS_END__",a?"X":" ");var A=new Function(C);A()}}};sap.zen.crosstab.utils.Utils.unEscapeDisplayString=function(h){var u=h.replace(/<br\/>/g,"\r\n");u=u.replace(/&nbsp;/g,"&#x20;");u=$("<div/>").html(u).text();return u};sap.zen.crosstab.utils.Utils.prepareStringForRendering=function(t){var h=false;var p=t.replace(/(\r\n)|(\n\r)|\r|\n/g,"<br/>");h=(p!==t);var P=p.replace(/(&#xd;&#xa;)|(&#xa;&#xd;)|&#xd;|&#xa;/g,"<br/>");h=(P!==p)||h;P=P.replace(/&#x20;/g,"&nbsp;");return{"text":P,"bHasLineBreaks":h}};sap.zen.crosstab.utils.Utils.cancelEvent=function(e){if(e){if(e.preventDefault){e.preventDefault()}sap.zen.crosstab.utils.Utils.stopEventPropagation(e)}};sap.zen.crosstab.utils.Utils.stopEventPropagation=function(e){if(e){if(e.stopPropagation){e.stopPropagation()}if(e.cancelBubble){e.cancelBubble=true}}};sap.zen.crosstab.utils.Utils.hasEntries=function(a){var h=false;if(a){for(var k in a){if(a.hasOwnProperty(k)){h=true;break}}}return h};sap.zen.crosstab.utils.Utils.padWithZeroes=function(n,l){var s=n.toString();if(s.length<l){s=('0000000000'+s).slice(-l)}return s};sap.zen.crosstab.utils.Utils.selectTextInElement=function(d){var r;var s;if(d.innerHTML){if(document.createRange&&window.getSelection){r=document.createRange();s=window.getSelection();try{s.removeAllRanges()}catch(e){}try{r.selectNodeContents(d);s.addRange(r)}catch(e){r.selectNode(d);s.addRange(r)}}else if(document.body.createTextRange){r=document.body.createTextRange();r.moveToElementText(d);r.select()}}};sap.zen.crosstab.utils.Utils.getWidthFromStyle=function(j){var i=0;var s="";var S=null;var w=null;var a=j.attr('style');if(a){var b=a.split(";");if(b){for(i=0;i<b.length;i++){s=b[i];if(s){S=s.split(":");if(S[0]==="width"){w=S[1];break}}}}}if(w){w=$.trim(w)}return w};sap.zen.crosstab.utils.Utils.sign=function(x){return x>0?1:x<0?-1:0}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.CellStyleHandler')){jQuery.sap.declare("sap.zen.crosstab.CellStyleHandler");sap.zen.crosstab.CellStyleHandler={};sap.zen.crosstab.CellStyleHandler.aStyles=[];sap.zen.crosstab.CellStyleHandler.iDataCellAlternatingIndex=-1;sap.zen.crosstab.CellStyleHandler.iHeaderCellAlternatingIndex=-1;sap.zen.crosstab.CellStyleHandler.oExceptionVisualizationMapping={};sap.zen.crosstab.CellStyleHandler.oExceptionVisualizationMapping[sap.zen.crosstab.rendering.RenderingConstants.ALERT_TYPE_BACKGROUND]="Background";sap.zen.crosstab.CellStyleHandler.oExceptionVisualizationMapping[sap.zen.crosstab.rendering.RenderingConstants.ALERT_TYPE_FONT_COLOR]="FontColor";sap.zen.crosstab.CellStyleHandler.oExceptionVisualizationMapping[sap.zen.crosstab.rendering.RenderingConstants.ALERT_TYPE_STATUS_SYMBOL]="StatusSymbol";sap.zen.crosstab.CellStyleHandler.oExceptionVisualizationMapping[sap.zen.crosstab.rendering.RenderingConstants.ALERT_TYPE_TREND_ASCENDING_SYMBOL]="TrendAscendingSymbol";sap.zen.crosstab.CellStyleHandler.oExceptionVisualizationMapping[sap.zen.crosstab.rendering.RenderingConstants.ALERT_TYPE_TREND_DESCENDING_SYMBOL]="TrendDescendingSymbol";sap.zen.crosstab.CellStyleHandler.oExceptionVisualizationMapping[sap.zen.crosstab.rendering.RenderingConstants.ALERT_TYPE_TREND_GREY_SYMBOL]="TrendGreySymbol";sap.zen.crosstab.CellStyleHandler.getCompleteStyleName=function(s,c){var C="";if(c===sap.zen.crosstab.rendering.RenderingConstants.TYPE_DATA_CELL){C=sap.zen.crosstab.rendering.RenderingConstants.STYLE_PREFIX_DATA_CELL+s}else{C=sap.zen.crosstab.rendering.RenderingConstants.STYLE_PREFIX_HEADER_CELL+s}return C};sap.zen.crosstab.CellStyleHandler.pushStyle=function(c){var i=sap.zen.crosstab.CellStyleHandler.aStyles.push(c);i--;return i};sap.zen.crosstab.CellStyleHandler.getStyleId=function(s,c){var C=sap.zen.crosstab.CellStyleHandler.getCompleteStyleName(s,c);var i=sap.zen.crosstab.CellStyleHandler.aStyles.indexOf(C);if(i===-1){i=sap.zen.crosstab.CellStyleHandler.pushStyle(C)}return i};sap.zen.crosstab.CellStyleHandler.pushPresetStyle=function(s,c){var C=sap.zen.crosstab.CellStyleHandler.getCompleteStyleName(s,c);var i=sap.zen.crosstab.CellStyleHandler.pushStyle(C);return i};sap.zen.crosstab.CellStyleHandler.iDataCellAlternatingIndex=sap.zen.crosstab.CellStyleHandler.pushPresetStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_ALTERNATING,sap.zen.crosstab.rendering.RenderingConstants.TYPE_DATA_CELL);sap.zen.crosstab.CellStyleHandler.iHeaderCellAlternatingIndex=sap.zen.crosstab.CellStyleHandler.pushPresetStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_ALTERNATING,sap.zen.crosstab.rendering.RenderingConstants.TYPE_HEADER_CELL);sap.zen.crosstab.CellStyleHandler.getCssClasses=function(c,I){var C="";var s=c.length;for(var i=0;i<s;i++){var S=c[i];if(S!==-1){if(!(I&&(S===sap.zen.crosstab.CellStyleHandler.iDataCellAlternatingIndex||S===sap.zen.crosstab.CellStyleHandler.iHeaderCellAlternatingIndex))){var a=sap.zen.crosstab.CellStyleHandler.aStyles[S];if(a){C+=a;C+=" "}}}}return C};sap.zen.crosstab.CellStyleHandler.getStyleForExceptionViz=function(f,a){var s="Alert"+a+sap.zen.crosstab.CellStyleHandler.oExceptionVisualizationMapping[f];return s};sap.zen.crosstab.CellStyleHandler.setExceptionStylesOnCell=function(c,f,a){if(f>4){c.getArea().columnHasSymbolException(c.getCol());c.addStyle("SymbolAlertBackground")}var s=sap.zen.crosstab.CellStyleHandler.getStyleForExceptionViz(f,a);if(s){c.addStyle(s)}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.CrosstabContextMenu')){jQuery.sap.declare("sap.zen.crosstab.CrosstabContextMenu");sap.zen.crosstab.CrosstabContextMenu=function(c){this.getContextMenuAction=function(C,d){var o=sap.ui.getCore();var e=d;while(!o.byId(e.attr("id"))){e=e.parent()}if(e.attr("id")===c.getId()){return null}var a=o.byId(e.attr("id"));var s=a.getCellType();var A=a.getArea().getAreaType();var b="";if(A===sap.zen.crosstab.rendering.RenderingConstants.TYPE_COLUMN_HEADER_AREA){b="COLS"}else if(A===sap.zen.crosstab.rendering.RenderingConstants.TYPE_ROW_HEADER_AREA){b="ROWS"}else if(A===sap.zen.crosstab.rendering.RenderingConstants.TYPE_DIMENSION_HEADER_AREA){var t=a.getText();if(t!==undefined&&t!==null&&t!==""){b="DIM"}else{var S=a.getSort();if(S!==undefined&&S!==null&&S!==""){b="DIM"}else{return null}}}else if(s===sap.zen.crosstab.rendering.RenderingConstants.TYPE_DATA_CELL){b="DATA"}else{return null}var r=a.getRow();var i=a.getCol();var f=c.getPropertyBag().getContextMenuCommand();f=f.replace("__AXIS__",b);f=f.replace("__ROW__",r);f=f.replace("__COL__",i);f=f.replace("__ID__",C);f=f.replace("__DOM_REF_ID__",d.attr("id"));return new Function(f)}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.CrosstabRenderer')){jQuery.sap.declare("sap.zen.crosstab.CrosstabRenderer");sap.zen.crosstab.CrosstabRenderer={};sap.zen.crosstab.CrosstabRenderer.render=function(r,c){"use strict";var a=r;var C="";var s=c.getWidth();if(s==="auto"){s="100%"}var b=c.getHeight();if(b==="auto"){b="100%"}a.write("<div");a.writeControlData(c);a.addStyle("overflow","hidden");if(s){a.addStyle("width",s)}if(b){a.addStyle("height",b)}if(c.aCustomStyleClasses&&c.aCustomStyleClasses.length>0){var i=0;for(i=0;i<c.aCustomStyleClasses.length;i++){C=C+c.aCustomStyleClasses[i]+" "}}if(c.getRenderMode()===sap.zen.crosstab.rendering.RenderingConstants.RENDERMODE_FILL){a.addStyle("visibility","hidden");C+="sapzencrosstab-TableDiv sapzencrosstab-TableDivBackground"}a.writeAttribute("class",C);a.writeStyles();a.write(">");if(c.getRenderMode()===sap.zen.crosstab.rendering.RenderingConstants.RENDERMODE_COMPACT){a.write("<div");a.writeAttribute("id",c.getId()+"_altRenderModeTableDiv");a.addStyle("visibility","hidden");a.addStyle("width","100%");a.addStyle("height","100%");a.writeAttribute("class","sapzencrosstab-TableDiv sapzencrosstab-TableDivBackground");a.writeStyles();a.write(">")}a.write("<div");a.writeAttribute("id",c.getId()+"_renderSizeDiv");a.writeAttribute("class","sapzencrosstab-RenderSizeDiv");a.write(">");a.write("<table");a.writeAttribute("id",c.getId()+"_table");a.writeAttribute("class","sapzencrosstab-Crosstab");a.write(">");a.write("<tr");a.writeAttribute("id",c.getId()+"_upperSection");a.write(">");sap.zen.crosstab.CrosstabRenderer.writeCell(a,c.getId()+"_upperLeft",c.getDimensionHeaderArea(),c);sap.zen.crosstab.CrosstabRenderer.writeCell(a,c.getId()+"_upperRight",c.getColumnHeaderArea(),c);a.write("</tr>");a.write("<tr");a.writeAttribute("id",c.getId()+"_lowerSection");a.write(">");sap.zen.crosstab.CrosstabRenderer.writeCell(a,c.getId()+"_lowerLeft",c.getRowHeaderArea(),c);sap.zen.crosstab.CrosstabRenderer.writeCell(a,c.getId()+"_lowerRight",c.getDataArea(),c);a.write("</tr>");a.write("</table>");a.write("</div>");if(c.getPropertyBag().hasToolbar()){a.write("<div");a.writeAttribute("id",c.getId()+"_toolbar");a.writeAttribute("class","sapzencrosstab-ToolbarDiv");a.addStyle("position","absolute");a.addStyle("bottom","0px");a.writeStyles();a.write(">");a.write("</div>")}a.write("<div");a.writeAttribute("id",c.getId()+"_resizeFrame");a.writeAttribute("class","sapzencrosstab-TableDiv");a.addStyle("visibility","hidden");a.addStyle("width",s);a.addStyle("height",b);a.writeStyles();a.write(">");a.write("</div>");a.write("<div");a.writeAttribute("id",c.getId()+"_resizeDiv");a.writeAttribute("class","sapzencrosstab-ResizeDiv");a.addStyle("width","100%");a.addStyle("height","100%");a.addStyle("visibility","hidden");a.writeStyles();a.write(">");a.write("</div>");a.write("<div");a.writeAttribute("id",c.getId()+"_loadingAnimationDiv");a.writeAttribute("class","sapzencrosstab-loadingAnimationDiv");a.addStyle("visibility","hidden");a.writeStyles();a.write(">");a.write("<div");a.writeAttribute("class","sapzencrosstab-loadingAnimation");a.write(">");a.write("</div>");a.write("</div>");a.write("<div");a.writeAttribute("id",c.getId()+"_measureDiv");a.writeAttribute("class","sapzencrosstab-HierarchyIndent");a.addStyle("visibility","none");a.writeStyles();a.write(">");a.write("</div>");a.write("<div");a.writeAttribute("id",c.getId()+"_exceptionMeasureDiv");a.writeAttribute("class","sapzencrosstab-SymbolAlertDimensions");a.addStyle("visibility","none");a.writeStyles();a.write(">");a.write("</div>");if(c.getRenderMode()===sap.zen.crosstab.rendering.RenderingConstants.RENDERMODE_COMPACT){a.write("</div>")}a.write("</div>")};sap.zen.crosstab.CrosstabRenderer.writeCell=function(r,i,a,c){r.write("<td");r.writeAttribute("id",i);r.addStyle("padding","0px");r.writeStyles();r.write(">");r.write("<div");r.writeAttribute("id",i+"_scrollDiv");r.addStyle("overflow","hidden");r.writeStyles();r.write(">");a.renderArea(r,c);r.write("</div>");r.write("</td>")}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.DataCell')){jQuery.sap.declare("sap.zen.crosstab.DataCell");jQuery.sap.require('sap.ui.core.Control');sap.ui.core.Control.extend("sap.zen.crosstab.DataCell",{metadata:{publicMethods:["addStyle"],library:"sap.zen.crosstab",properties:{"text":{type:"string",group:"Misc",defaultValue:null},"area":{type:"object",group:"Misc",defaultValue:null},"row":{type:"int",group:"Misc",defaultValue:null},"col":{type:"int",group:"Misc",defaultValue:null},"tableRow":{type:"int",group:"Misc",defaultValue:null},"tableCol":{type:"int",group:"Misc",defaultValue:null}}}});sap.zen.crosstab.DataCell.prototype.init=function(){"use strict";this.aStyles=[];this.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_DATA_CELL);this.bLoading=false;this.bIsEntryEnabled=false;this.sUnit="";this.sPassiveCellType=sap.zen.crosstab.rendering.RenderingConstants.PASSIVE_CELL_TYPE_NORMAL;this.bTextHasLineBreaks=false};sap.zen.crosstab.DataCell.prototype.getCellType=function(){return sap.zen.crosstab.rendering.RenderingConstants.TYPE_DATA_CELL};sap.zen.crosstab.DataCell.prototype.getCssClassNames=function(i){return sap.zen.crosstab.CellStyleHandler.getCssClasses(this.aStyles,i)};sap.zen.crosstab.DataCell.prototype.getStyleIdList=function(){return this.aStyles};sap.zen.crosstab.DataCell.prototype.setStyleIdList=function(n){this.aStyles=n};sap.zen.crosstab.DataCell.prototype.addStyle=function(s){var S=sap.zen.crosstab.CellStyleHandler.getStyleId(s,sap.zen.crosstab.rendering.RenderingConstants.TYPE_DATA_CELL);if(this.aStyles.indexOf(S)===-1){this.aStyles.push(S)}};sap.zen.crosstab.DataCell.prototype.removeStyle=function(s){var S=sap.zen.crosstab.CellStyleHandler.getStyleId(s,sap.zen.crosstab.rendering.RenderingConstants.TYPE_DATA_CELL);var i=this.aStyles.indexOf(S);if(i!==-1){this.aStyles.splice(i,1)}};sap.zen.crosstab.DataCell.prototype.hasStyle=function(s){var S=sap.zen.crosstab.CellStyleHandler.getStyleId(s,sap.zen.crosstab.rendering.RenderingConstants.TYPE_DATA_CELL);var i=this.aStyles.indexOf(S);if(i===-1){return false}else{return true}};sap.zen.crosstab.DataCell.prototype.getColSpan=function(){return 1};sap.zen.crosstab.DataCell.prototype.getRowSpan=function(){return 1};sap.zen.crosstab.DataCell.prototype.getEffectiveColSpan=function(){return 1};sap.zen.crosstab.DataCell.prototype.getEffectiveRowSpan=function(){return 1};sap.zen.crosstab.DataCell.prototype.isLoading=function(){return this.bLoading};sap.zen.crosstab.DataCell.prototype.setLoading=function(l){this.bLoading=l};sap.zen.crosstab.DataCell.prototype.isSelectable=function(){return false};sap.zen.crosstab.DataCell.prototype.getUnescapedText=function(){return sap.zen.crosstab.utils.Utils.unEscapeDisplayString(this.getText())};sap.zen.crosstab.DataCell.prototype.setEntryEnabled=function(i){this.bIsEntryEnabled=i};sap.zen.crosstab.DataCell.prototype.isEntryEnabled=function(){return this.bIsEntryEnabled};sap.zen.crosstab.DataCell.prototype.setUnit=function(u){this.sUnit=u};sap.zen.crosstab.DataCell.prototype.getUnit=function(){return this.sUnit};sap.zen.crosstab.DataCell.prototype.getPassiveCellType=function(){return this.sPassiveCellType};sap.zen.crosstab.DataCell.prototype.setPassiveCellType=function(p){this.sPassiveCellType=p};sap.zen.crosstab.DataCell.prototype.setTextHasLineBreaks=function(t){this.bTextHasLineBreaks=t};sap.zen.crosstab.DataCell.prototype.textHasLineBreaks=function(){return this.bTextHasLineBreaks}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.DataCellRenderer')){jQuery.sap.declare("sap.zen.crosstab.DataCellRenderer");sap.zen.crosstab.DataCellRenderer={};sap.zen.crosstab.DataCellRenderer.render=function(r,c){"use strict";var a=c.getArea();var R=a.getRenderCellCallback();var s=c.getText();var A=null;if(R){var C=R(new sap.zen.crosstab.IDataCell(c));A=C.additionalStyles;s=C.renderText}var b=r;b.write("<td");b.writeControlData(c);var d=c.getCssClassNames(a.getCrosstab().isIE8Mode());b.writeAttribute("class",d);b.writeAttribute("tabindex",sap.zen.crosstab.rendering.RenderingConstants.TABINDEX);b.write(">");b.write("<div");b.writeAttribute("id",c.getId()+"_contentDiv");b.writeAttribute("tabindex",sap.zen.crosstab.rendering.RenderingConstants.TABINDEX);var e="sapzencrosstab-DataCellContentDiv";if(c.isLoading()){e+=" sapzencrosstab-LoadingCellContentDiv"}b.writeAttribute("class",e);if(A){for(var S in A){b.addStyle(S,A[S])}}b.writeStyles();b.write(">");b.write(s);b.write("</div>");b.write("</td>")}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.HeaderCell')){jQuery.sap.declare("sap.zen.crosstab.HeaderCell");jQuery.sap.require('sap.ui.core.Control');sap.ui.core.Control.extend("sap.zen.crosstab.HeaderCell",{metadata:{publicMethods:["addStyle"],library:"sap.zen.crosstab",properties:{"rowSpan":{type:"int",group:"Misc",defaultValue:null},"colSpan":{type:"int",group:"Misc",defaultValue:null},"text":{type:"string",group:"Misc",defaultValue:null},"mergeKey":{type:"string",group:"Misc",defaultValue:null},"sort":{type:"string",group:"Misc",defaultValue:null},"sortAction":{type:"string",group:"Misc",defaultValue:null},"area":{type:"object",group:"Misc",defaultValue:null},"effectiveColSpan":{type:"int",group:"Misc",defaultValue:null},"effectiveRowSpan":{type:"int",group:"Misc",defaultValue:null},"row":{type:"int",group:"Misc",defaultValue:null},"col":{type:"int",group:"Misc",defaultValue:null},"level":{type:"int",group:"Misc",defaultValue:null},"drillState":{type:"string",group:"Misc",defaultValue:null},"hierarchyAction":{type:"string",group:"Misc",defaultValue:null},"hierarchyTooltip":{type:"string",group:"Misc",defaultValue:null},"htmlIE8RowSpan":{type:"int",group:"Misc",defaultValue:1},"sortTextIndex":{type:"int",group:"Misc",defaultValue:null},"tableRow":{type:"int",group:"Misc",defaultValue:null},"tableCol":{type:"int",group:"Misc",defaultValue:null}}}});sap.zen.crosstab.HeaderCell.prototype.init=function(){"use strict";this.aStyles=[];this.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_HEADER_CELL);this.bLoading=false;this.bSelectable=false;this.bIsInnerMember=false;this.bIsResult=false;this.bIsMobileResize=false;this.sUnit="";this.bIsEntryEnabled=false;this.sPassiveCellType=sap.zen.crosstab.rendering.RenderingConstants.PASSIVE_CELL_TYPE_NORMAL;this.bTextHasLineBreaks=false};sap.zen.crosstab.HeaderCell.prototype.getCellType=function(){return sap.zen.crosstab.rendering.RenderingConstants.TYPE_HEADER_CELL};sap.zen.crosstab.HeaderCell.prototype.getCssClassNames=function(i){return sap.zen.crosstab.CellStyleHandler.getCssClasses(this.aStyles,i)};sap.zen.crosstab.HeaderCell.prototype.getStyleIdList=function(){return this.aStyles};sap.zen.crosstab.HeaderCell.prototype.setStyleIdList=function(n){this.aStyles=n};sap.zen.crosstab.HeaderCell.prototype.addStyle=function(s){var S=sap.zen.crosstab.CellStyleHandler.getStyleId(s,sap.zen.crosstab.rendering.RenderingConstants.TYPE_HEADER_CELL);if(this.aStyles.indexOf(S)===-1){this.aStyles.push(S)}};sap.zen.crosstab.HeaderCell.prototype.removeStyle=function(s){var S=sap.zen.crosstab.CellStyleHandler.getStyleId(s,sap.zen.crosstab.rendering.RenderingConstants.TYPE_HEADER_CELL);var i=this.aStyles.indexOf(S);if(i!==-1){this.aStyles.splice(i,1)}};sap.zen.crosstab.HeaderCell.prototype.hasStyle=function(s){var S=sap.zen.crosstab.CellStyleHandler.getStyleId(s,sap.zen.crosstab.rendering.RenderingConstants.TYPE_HEADER_CELL);var i=this.aStyles.indexOf(S);if(i===-1){return false}else{return true}};sap.zen.crosstab.HeaderCell.prototype.isLoading=function(){return this.bLoading};sap.zen.crosstab.HeaderCell.prototype.setLoading=function(l){this.bLoading=l};sap.zen.crosstab.HeaderCell.prototype.isSelectable=function(){return this.bSelectable};sap.zen.crosstab.HeaderCell.prototype.setSelectable=function(s){this.bSelectable=s};sap.zen.crosstab.HeaderCell.prototype.setInnerMember=function(i){this.bIsInnerMember=i};sap.zen.crosstab.HeaderCell.prototype.isInnerMember=function(){return this.bIsInnerMember};sap.zen.crosstab.HeaderCell.prototype.setResult=function(i){this.bIsResult=i};sap.zen.crosstab.HeaderCell.prototype.isResult=function(){return this.bIsResult};sap.zen.crosstab.HeaderCell.prototype.getUnescapedText=function(){return sap.zen.crosstab.utils.Utils.unEscapeDisplayString(this.getText())};sap.zen.crosstab.HeaderCell.prototype.isMobileResize=function(){return this.bIsMobileResize};sap.zen.crosstab.HeaderCell.prototype.setMobileResize=function(p){this.bIsMobileResize=p};sap.zen.crosstab.HeaderCell.prototype.setEntryEnabled=function(i){this.bIsEntryEnabled=i};sap.zen.crosstab.HeaderCell.prototype.isEntryEnabled=function(){return this.bIsEntryEnabled};sap.zen.crosstab.HeaderCell.prototype.setUnit=function(u){this.sUnit=u};sap.zen.crosstab.HeaderCell.prototype.getUnit=function(){return this.sUnit};sap.zen.crosstab.HeaderCell.prototype.getPassiveCellType=function(){return this.sPassiveCellType};sap.zen.crosstab.HeaderCell.prototype.setPassiveCellType=function(p){this.sPassiveCellType=p};sap.zen.crosstab.HeaderCell.prototype.setTextHasLineBreaks=function(t){this.bTextHasLineBreaks=t};sap.zen.crosstab.HeaderCell.prototype.textHasLineBreaks=function(){return this.bTextHasLineBreaks}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.HeaderCellRenderer')){jQuery.sap.declare("sap.zen.crosstab.HeaderCellRenderer");sap.zen.crosstab.HeaderCellRenderer={};sap.zen.crosstab.HeaderCellRenderer.render=function(r,c){"use strict";var a=c.getArea();var C=a.getCrosstab();var b=r;var i=null;var R=null;var f=a.getRenderCellCallback();var s=c.getText();var A=null;if(f){var o=f(new sap.zen.crosstab.IHeaderCell(c));A=o.additionalStyles;s=o.renderText}var d=c.getCssClassNames(C.isIE8Mode());if(c.getSort()){d+=" sapzencrosstab-HeaderCellSortable"}var D=c.getDrillState();if(D){d+=" sapzencrosstab-HeaderCellHierarchy"}b.write("<td");b.writeControlData(c);b.writeAttribute("class",d);b.writeAttribute("tabindex",sap.zen.crosstab.rendering.RenderingConstants.TABINDEX);i=c.getEffectiveColSpan();if(i>1){b.writeAttribute("colspan",i)}R=c.getEffectiveRowSpan();if(R>1){b.writeAttribute("rowspan",R)}b.write(">");b.write("<div");b.writeAttribute("class","sapzencrosstab-cellLayoutDiv");b.writeAttribute("id",c.getId()+"_cellLayoutDiv");b.writeAttribute("tabindex",sap.zen.crosstab.rendering.RenderingConstants.TABINDEX);if(c.isEntryEnabled()){b.addStyle("width","0px");b.writeStyles()}b.write(">");if(c.isEntryEnabled()){b.write("<table style='width: 100%; border-spacing: 0px;'><tbody>");b.write("<tr>");b.write("<td style='width: 100%; padding: 0px 5px 0px 0px;'>")}b.write("<div");b.writeAttribute("id",c.getId()+"_contentDiv");b.writeAttribute("tabindex",sap.zen.crosstab.rendering.RenderingConstants.TABINDEX);if(c.isEntryEnabled()){b.addStyle("width","100%");b.writeStyles()}var e="sapzencrosstab-HeaderCellContentDiv";if(c.isLoading()){e+=" sapzencrosstab-LoadingCellContentDiv"}b.writeAttribute("class",e);if(A){for(var S in A){b.addStyle(S,A[S])}}b.writeStyles();b.write(">");var g=c.getSort();if(g||D){n(g,D)}else{b.write(s)}b.write("</div>");if(C.getPropertyBag().isEnableColResize()===true){if(a.isColHeaderArea()||a.isDimHeaderArea()){if(C.getPropertyBag().isTestMobileMode()||C.getPropertyBag().isMobileMode()){c.setMobileResize(true)}else{b.write("<div");b.writeAttribute("id","resi_"+c.getId());b.writeAttribute("class","sapzencrosstab-columnResizeHandle");b.writeAttribute("title",C.getPropertyBag().getText(sap.zen.crosstab.TextConstants.COLWIDTH_ADJUST_TEXT_KEY));b.write(">");b.write("</div>");c.setMobileResize(false)}}}b.write("</div>");if(c.isEntryEnabled()){b.write("</td>");b.write("<td style='padding: 0px'>");b.write("<div");b.writeAttribute("id","vhlp_"+c.getId());b.writeAttribute("class","sapzencrosstab-HeaderCellDivValueHelp sapzencrosstab-HeaderCellValueHelp");b.write(">");b.write("</div>");b.write("</td>");b.write("</tr>");b.write("</tbody></table>")}b.write("</td>");function h(){if(g){var t=0;b.write("<td>");var p="sapzencrosstab-HeaderCellDivSortable ";b.write("<div");if(g==="NONE"){p+="sapzencrosstab-HeaderCellSortNone";t=0}else if(g==="ASC"){p+="sapzencrosstab-HeaderCellSortAsc";t=1}else if(g==="DESC"){p+="sapzencrosstab-HeaderCellSortDesc";t=2}b.writeAttribute("class",p);b.writeAttribute("id","sort_"+c.getId());var q=C.getPropertyBag().getSortingToolTip(t);if(q){b.writeAttribute("title",q)}b.write("></div></td>")}}function j(){if(D){var L=c.getLevel();var p=c.getArea().isRowHeaderArea();var q="sapzencrosstab-HeaderCellDivHierarchy ";if(c.getHierarchyAction()){if(D==="O"){q+="sapzencrosstab-CollapseNode"}else if(D==="C"){q+="sapzencrosstab-ExpandNode"}if(D==="O"||D==="C"){q+=" sapzencrosstab-PointerCursor"}}if(L>0){if(p){var W=L*C.getHierarchyIndentWidth();b.write("<td><div");b.writeAttribute("tabindex",sap.zen.crosstab.rendering.RenderingConstants.TABINDEX);b.addStyle("width",W+"px");b.writeAttribute("class","sapzencrosstab-HierarchySpacerDivBefore");b.writeStyles();b.write("></div></td>")}}if((D==="L"&&L>0)||D!=="L"){b.write("<td><div");if(c.getHierarchyAction()){b.writeAttribute("id","hier_"+c.getId())}b.writeAttribute("class",q);var H=c.getHierarchyTooltip();if(H){b.writeAttribute("title",H)}b.write("></div></td>")}}}function w(){b.write("<td><div");b.writeAttribute("id",c.getId()+"_textContentDiv");b.writeAttribute("tabindex",sap.zen.crosstab.rendering.RenderingConstants.TABINDEX);b.write(">");b.write(s);b.write("</div></td>")}function k(){if(D){var L=c.getLevel();if(L>0&&c.getArea().isColHeaderArea()){var H=L*C.getHierarchyIndentHeight();b.write("<tr><td><div");b.writeAttribute("tabindex",sap.zen.crosstab.rendering.RenderingConstants.TABINDEX);b.writeAttribute("class","sapzencrosstab-HierarchySpacerLinesBefore");b.addStyle("height",H+"px");b.writeStyles();b.write("></div></td></tr>")}}}function l(){if(D&&c.getArea().isColHeaderArea()){var L=c.getLevel();var M=C.getColHeaderHierarchyLevels()[c.getRow()];var p=M-L;if(p>0){var H=p*C.getHierarchyIndentHeight();b.write("<tr><td><div");b.writeAttribute("tabindex",sap.zen.crosstab.rendering.RenderingConstants.TABINDEX);b.writeAttribute("class","sapzencrosstab-HierarchySpacerLinesAfter");b.addStyle("height",H+"px");b.writeStyles();b.write("></div></td></tr>")}}}function m(){if(D&&c.getArea().isRowHeaderArea()){var L=c.getLevel();var M=C.getRowHeaderHierarchyLevels()[c.getCol()];var p=M-L;if(p>0){var W=p*C.getHierarchyIndentWidth();b.write("<td><div");b.writeAttribute("tabindex",sap.zen.crosstab.rendering.RenderingConstants.TABINDEX);b.addStyle("width",W+"px");b.writeAttribute("class","sapzencrosstab-HierarchySpacerDivAfter");b.writeStyles();b.write("></div></td>")}}}function n(){b.write("<table><tbody>");k();b.write("<tr>");j();w();h();m();b.write("</tr>");l();b.write("</tbody></table>")}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.TouchHandler')){jQuery.sap.declare("sap.zen.crosstab.TouchHandler");sap.zen.crosstab.TouchHandler=function(E,c){var d=c.getDataArea();var r=c.getRowHeaderArea();var C=c.getColumnHeaderArea();var D=c.getDimensionHeaderArea();var l=0;var L=0;var t=false;var m=false;var o=$("#"+d.getId());var a=$("#"+r.getId());var b=$("#"+C.getId());var f=$("#"+D.getId());var T="";var g=null;var h="800";var v=0;var H=0;var R=0;var j=0;var n=0;var N=0;var O=0;var k=0;var p=null;var P=null;var I=2;var q=null;var V=null;var s=null;var u=false;function w(e){var M=null;var i=0;var Q=sap.ui.getCore().getControl(e.target.id);var S=null;var U=null;if(Q&&(Q.isMobileResize&&Q.isMobileResize())){M=Q}else{var W=$(e.target).parents("td");if(W){for(i=0;i<W.length;i++){S=$(W[i]);U=S.attr("id");if(U&&U.length>0){Q=sap.ui.getCore().getControl(U);if(Q&&(Q.isMobileResize&&Q.isMobileResize())){M=Q;break}}}}}return M}function x(e){var i=e.getParameter("item").oSelectedCell;if(i){E.doColResize(i)}}function y(){if(!q){q=new sap.ui.commons.Menu("resizemenu",{ariaDescription:"Crosstab Menu",tooltip:"Menu containing crosstab related actions"});q.addStyleClass("sapzencrosstab-MenuStyle");var M=new sap.ui.commons.MenuItem("item1",{text:c.getPropertyBag().getText(sap.zen.crosstab.TextConstants.MOBILE_MENUITEM_COLWIDTH_ADJUST_TEXT_KEY)});M.attachSelect(x);q.addItem(M)}}function z(){R=(d.getRowCnt()+"").length;j=(d.getColCnt()+"").length;p=new sap.ui.core.Popup();p.setContent(new sap.ui.commons.TextView());p.setDurations(125,500);p.setAutoClose(true);P=p.getContent();P.addStyleClass("sapzencrosstab-ScrollPopup");P.setWrapping(false);var e=sap.ui.core.Popup.Dock;p.setPosition(e.CenterCenter,e.CenterCenter,$('#'+c.getId()+"_renderSizeDiv")[0],"0")}function A(){var e=c.getPropertyBag().getText(sap.zen.crosstab.TextConstants.ROW_TEXT_KEY)+": "+sap.zen.crosstab.utils.Utils.padWithZeroes(n+1,R)+"/"+r.getRowCnt();var i=c.getPropertyBag().getText(sap.zen.crosstab.TextConstants.COL_TEXT_KEY)+": "+sap.zen.crosstab.utils.Utils.padWithZeroes(N+1,j)+"/"+C.getColCnt();var M=e+" "+i;p.getContent().setProperty("text",M,true);p.getContent().rerender()}function B(e){sap.zen.crosstab.utils.Utils.cancelEvent(e);v=0;H=0;n=0;N=0;if(q){q.close()}T=e.currentTarget.getAttribute("id");oCurrentlyHoveredCell=null;if(e.originalEvent.touches&&e.originalEvent.touches.length){e=e.originalEvent.touches[0]}else if(e.originalEvent.changedTouches&&e.originalEvent.changedTouches.length){e=e.originalEvent.changedTouches[0]}l=e.pageX;L=e.pageY;t=true;m=false;if(g){window.clearTimeout(g);g=null}g=setTimeout(function(){t=false;m=false;var i=w(e);if(i){y();var M=$('#'+i.getId());var Q=sap.ui.core.Popup.Dock;q.getItems()[0].oSelectedCell=i;q.open(false,M,Q.BeginBottom,Q.BeginTop,M,0+" "+0,sap.ui.core.Collision.flip)}},h)}function F(i,e){var M=c.getHorizontalHeaderScrollbar();if(M){k=M.getScrollPosition();N=Math.max(k-i,0);if(e>0){c.scrollHeaderHorizontal(N)}}}function G(i,e,M,Q){if(c.getPropertyBag().isPixelScrolling()){if(V){O=V.getScrollPosition();n=Math.max(O-e,0)}if(s){k=s.getScrollPosition();N=Math.max(k-i,0)}if(V&&Q>0){c.scrollVertical(n)}if(s&&M>0){c.scrollHorizontal(N)}}else{if(p.getOpenState()===sap.ui.core.OpenState.CLOSED){p.open(-1)}if(V){if(c.getRenderEngine().isVScrolledToEnd()){if(sap.zen.crosstab.utils.Utils.sign(e)>0){v-=sap.zen.crosstab.utils.Utils.sign(e)}else{v=0}}else{v-=sap.zen.crosstab.utils.Utils.sign(e)}O=r.getRenderStartRow();n=Math.max(Math.floor(v/I)+O,0);n=Math.min(d.getRowCnt()-1,n)}if(s){if(c.getRenderEngine().isHScrolledToEnd()){if(sap.zen.crosstab.utils.Utils.sign(i)>0){H-=sap.zen.crosstab.utils.Utils.sign(i)}else{H=0}}else{H-=sap.zen.crosstab.utils.Utils.sign(i)}k=C.getRenderStartCol();N=Math.max(Math.floor(H/I)+k,0);N=Math.min(d.getColCnt()-1,N)}A()}}function J(e){sap.zen.crosstab.utils.Utils.cancelEvent(e);if(t==false){return true}m=true;if(g){window.clearTimeout(g);g=null}if(e.originalEvent.touches&&e.originalEvent.touches.length){e=e.originalEvent.touches[0]}else if(e.originalEvent.changedTouches&&e.originalEvent.changedTouches.length){e=e.originalEvent.changedTouches[0]}var i=e.pageX;var M=e.pageY;var Q=i-l;var S=M-L;V=c.getVScrollbar();s=c.getHScrollbar();var U=Math.abs(S);var W=Math.abs(Q);if(U>W&&W<5){Q=0;W=0}else if(W>U&&U<5){S=0;U=0}u=false;if(T===r.getId()){u=c.isHeaderHScrolling()&&(Q!==0);if(!u){Q=0;W=0}}else if(T===C.getId()){S=0;U=0}else if(T===D.getId()){u=c.isHeaderHScrolling()&&(Q!==0);if(!u){Q=0;W=0}S=0;U=0}if(u===true){F(Q,W)}else{G(Q,S,W,U)}l=e.pageX;L=e.pageY}function K(e){sap.zen.crosstab.utils.Utils.cancelEvent(e);if(g){window.clearTimeout(g);g=null}if(t==false){return true}if(!m){E.executeOnClickAction(e)}t=false;m=false;if(!u){if(!c.getPropertyBag().isPixelScrolling()){if(p.getOpenState()===sap.ui.core.OpenState.OPEN){p.close()}var i=false;if(n!==O){c.scrollVertical(n);i=true}if(N!==k){c.scrollHorizontal(N);i=true}if(i===true){E.attachEvents()}}v=0;H=0}}this.registerTouchEvents=function(e){z();var i="touchstart";if(c.getPropertyBag().isTestMobileMode()&&!c.getPropertyBag().isMobileMode()){i="mousedown"}o.unbind(i);o.bind(i,B);a.unbind(i);a.bind(i,B);b.unbind(i);b.bind(i,B);f.unbind(i);f.bind(i,B);i="touchmove";if(c.getPropertyBag().isTestMobileMode()&&!c.getPropertyBag().isMobileMode()){i="mousemove"}e.unbind(i);e.bind(i,J);i="touchend";if(c.getPropertyBag().isTestMobileMode()&&!c.getPropertyBag().isMobileMode()){i="mouseup"}e.unbind(i);e.bind(i,K)}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.datahandler.JsonDataHandler')){jQuery.sap.declare("sap.zen.crosstab.datahandler.JsonDataHandler");sap.zen.crosstab.datahandler.JsonDataHandler=function(c){var d=c.getDimensionHeaderArea();var C=c.getColumnHeaderArea();var r=c.getRowHeaderArea();var D=c.getDataArea();var f=0;var F=0;var t=0;var T=0;var b=false;var a=false;var e=false;var J=null;var o=null;var g=0;var R=0;var h={};var k={};function l(){if(!sap.zen.CrosstabTextCache){sap.zen.CrosstabTextCache={};sap.zen.CrosstabTextCache.filled=false;sap.zen.CrosstabTextCache.oTexts={};sap.zen.CrosstabTextCache.oSortingTextLookupTable={};sap.zen.CrosstabTextCache.defaultProvided=false}var P=c.getPropertyBag();P.addText(sap.zen.crosstab.TextConstants.ROW_TEXT_KEY,"Row");P.addText(sap.zen.crosstab.TextConstants.COL_TEXT_KEY,"Column");P.addText(sap.zen.crosstab.TextConstants.COLWIDTH_ADJUST_TEXT_KEY,"Double Click to adjust Column Width");P.addText(sap.zen.crosstab.TextConstants.MOBILE_MENUITEM_COLWIDTH_ADJUST_TEXT_KEY,"Adjust Column Width");p(P);sap.zen.CrosstabTextCache.defaultProvided=true}function m(i){if(sap.zen.CrosstabTextCache.filled===false){var P=c.getPropertyBag();if(i){P.addText(sap.zen.crosstab.TextConstants.ROW_TEXT_KEY,i.rowtext||"Row");P.addText(sap.zen.crosstab.TextConstants.COL_TEXT_KEY,i.coltext||"Column");P.addText(sap.zen.crosstab.TextConstants.COLWIDTH_ADJUST_TEXT_KEY,i.colwidthtext||"Double Click to adjust Column Width");P.addText(sap.zen.crosstab.TextConstants.MOBILE_MENUITEM_COLWIDTH_ADJUST_TEXT_KEY,i.mobilemenuitemcolwidthtext||"Adjust Column Width");n(i,P)}sap.zen.CrosstabTextCache.filled=true}}function p(P){var S={};S.alttext="Unsorted. Select to sort ascending";S.tooltipidx=0;P.addSortingTextLookup("0",S);S={};S.alttext="Sorted ascending. Select to sort descending";S.tooltipidx=1;P.addSortingTextLookup("1",S);S={};S.alttext="Sorted descending. Select to sort ascending";S.tooltipidx=2;P.addSortingTextLookup("2",S)}function n(j,P){var S=j.sorting;if(!S){p(P)}else{var i=0;var L=parseInt(S.length,10);for(i=0;i<L;i++){var M={};M.alttext=S[i].alttext;M.tooltipidx=S[i].tooltipidx;P.addSortingTextLookup(i+"",M)}}}this.determineBasicAreaData=function(i,j){if(!sap.zen.CrosstabTextCache||(sap.zen.CrosstabTextCache&&!sap.zen.CrosstabTextCache.defaultProvided)){l()}J=i;if(!J.rows){v(J)}else{if(J.selectedaxis){c.setSelectionInfo(J.selectedaxis,J.selectedpos)}else{if(J.singledatacellselection===true){c.setSingleDataCellSelectionInfo(J.datacellrowpos,J.datacellcolpos)}else{c.setSelectionInfo(null,-1)}}if(J.dataselectionmode===undefined){J.dataselectionmode=false}c.setDataSelectionMode(J.dataselectionmode);c.setHighlightingInfo(J.highlighting);c.setSingleDataCellSelection(J.singledatacellselection);if(j||J.changed){m(J.texts);h={};k={};f=J.fixedcolheaders;F=J.fixedrowheaders;if(!J.pixelscrolling){c.setHCutOff(false);c.setVCutOff(false);t=J.totaldatacols;T=J.totaldatarows}else{c.setHCutOff(J.totaldatacols>J.sentdatacols);c.setVCutOff(J.totaldatarows>J.sentdatarows);t=J.sentdatacols;T=J.sentdatarows}if(!f||!F){d.setRowCnt(0);d.setColCnt(0);if(!F){r.setRowCnt(0);r.setColCnt(0);if(f){C.setRowCnt(f);C.setColCnt(t)}}else if(!f){C.setRowCnt(0);C.setColCnt(0);if(F){r.setRowCnt(T);r.setColCnt(F)}}}else{d.setRowCnt(f);d.setColCnt(F);r.setRowCnt(T);r.setColCnt(F);C.setRowCnt(f);C.setColCnt(t)}D.setRowCnt(T);D.setColCnt(t);c.setTotalRows(f+T);c.setTotalCols(F+t);c.setOnSelectCommand(J.onselectcommand);c.getPropertyBag().setSelectionEnabled(J.selectionenabled);c.getPropertyBag().setDisplayExceptions(J.displayexceptions);c.getPropertyBag().setEnableColResize(J.enablecolresize);c.setScrollNotifyCommand(J.scrollnotifier);s(i);var L=new sap.zen.crosstab.CrosstabCellApi(c,F,f,t,T);c.setCellApi(L)}q();if(!(c.getPropertyBag().isMobileMode()||c.getPropertyBag().isTestMobileMode())){if(J.transferdatacommand){c.setTransferDataCommand(J.transferdatacommand)}if(J.callvaluehelpcommand){c.setCallValueHelpCommand(J.callvaluehelpcommand)}if(J.newlinescnt){c.setNewLinesCnt(J.newlinescnt)}if(J.newlinespos){c.setNewLinesPos(J.newlinespos)}}if(J.contextmenucmd){c.getPropertyBag().setContextMenuCommand(J.contextmenucmd);c.createContextMenu()}if(J.headerwidth){c.getPropertyBag().setMaxHeaderWidth(J.headerwidth)}else{c.getPropertyBag().setMaxHeaderWidth(0)}}};function s(j){var L=j.usercolwidths;if(L){for(var i=0;i<L.length;i++){var M=L[i];var N=M.colid;if(isNaN(M.colwidth)){continue}var O=Math.max(0,parseInt(M.colwidth,10));var P=false;if(M.ignore!==undefined){P=M.ignore}if(N==='*'){if(f&&F){C.setColUserWidth(N,O,P);D.setColUserWidth(N,O,P);d.setColUserWidth(N,O,P);r.setColUserWidth(N,O,P)}else{if(!F){C.setColUserWidth(N,O,P)}else if(!f){r.setColUserWidth(N,O,P)}D.setColUserWidth(N,O,P)}}else{if(f&&F){if(N>=F){C.setColUserWidth(N-F,O,P);D.setColUserWidth(N-F,O,P)}else{d.setColUserWidth(N,O,P);r.setColUserWidth(N,O,P)}}else{if(!F){C.setColUserWidth(N,O,P);D.setColUserWidth(N,O,P)}else if(!f){if(N>=F){D.setColUserWidth(N-F,O,P)}else{r.setColUserWidth(N,O,P)}}}}}}}function q(){var i=c.getRenderEngine().getCrossRequestManager();if(J.scrolltoselection&&J.selectedaxis&&J.selectedpos!==undefined){J.rootcause="SDK";if(J.selectedaxis==="ROWS"){i.saveSDKVScrollInfo(J.selectedpos,"SDK")}else if(J.selectedaxis==="COLUMNS"){i.saveSDKHScrollInfo(J.selectedpos,"SDK")}else if(oJsonTabkleControl.selectedaxis==="DATA"){i.saveSDKVScrollInfo(J.datacellrowpos,"SDK");i.saveSDKHScrollInfo(J.datacellcolpos,"SDK")}}if(J.rootcause){i.setRootCause(J.rootcause);if(J.rootcause==="hierarchy"){i.setHierarchyAction(J.rootcause_hierarchy);i.setIsHierarchyDirectionDown(J.rootcause_hierarchy_directiondown)}i.handleRootCause()}if(!(J.scrolltoselection&&J.selectedaxis&&J.selectedpos!==undefined)&&!(J.rootcause)){if(i){if(J.clienthpos!==undefined&&J.clientvpos!==undefined&&J.clienthscrolledtoend!==undefined&&J.clientvscrolledtoend!==undefined){if(J.clienthscrolledtoend===true){J.clienthpos=J.totaldatacols-1}if(J.clientvscrolledtoend===true){J.clientvpos=J.totaldatarows-1}i.setScrollData(parseInt(J.clienthpos,10),J.clienthscrolledtoend,parseInt(J.clientvpos,10),J.clientvscrolledtoend)}}}if(J.clientheaderhpos){i.setHeaderScrollData({"iHPos":parseInt(J.clientheaderhpos,10)})}}this.jsonToDataModel=function(P){if(J.rows){o=P.oCrosstabAreasToBeFilled;g=P.iColOffset;R=P.iRowOffset;u();var L=J.rows;for(var i=0,M=L.length;i<M;i++){var N=L[i].row.rowidx;var O=L[i].row.cells;for(var j=0,Q=O.length;j<Q;j++){var S=O[j].control;var U=S.colidx;w(S,N,U)}}}c.setColHeaderHierarchyLevels(h);c.setRowHeaderHierarchyLevels(k)};function u(){b=o[d.getAreaType()];a=o[r.getAreaType()];e=o[C.getAreaType()]}function v(J){d.setRowCnt(2);d.setColCnt(1);var i=E(d,0,0);i.setText(J.messagetitle);d.insertCell(i,0,0);i=E(d,1,0);i.setText(J.messagetext);d.insertCell(i,1,0)}var w=function(j,i,L){var M=i-1;var N=L-1;if(L>F&&i>f){y(j,M+R,N+g)}else if(b&&L<=F&&i<=f){z(j,M,N)}else if(e&&i<=f&&L>F){B(j,M,N+g)}else if(a&&L<=F&&i>f){A(j,M+R,N)}};function x(i,j){var L=new sap.zen.crosstab.DataCell();L.setArea(D);L.setRow(i);L.setCol(j);return L}var y=function(j,M,i){var L=M-f;var N=i-F;var O=x(L,N);O.setTableRow(M);O.setTableCol(i);H(j,O);if(L%2===1){O.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_ALTERNATING)}D.insertCell(O,L,N)};var z=function(j,M,i){G(j,d,M,i,M,i)};var A=function(j,M,i){var L=M;if(j.axisidx!==undefined){L=j.axisidx+f}G(j,r,M-f,i,L,i)};var B=function(j,M,i){var L=i;if(j.axisidx!==undefined){L=j.axisidx+F}G(j,C,M,i-F,M,L)};function E(i,j,L){var M=new sap.zen.crosstab.HeaderCell();M.setArea(i);M.setRow(j);M.setCol(L);return M}var G=function(j,i,L,M,N,O){var P=E(i,L,M);P.setTableRow(N);P.setTableCol(O);H(j,P);I(j,P,i);if(!J.dataselectionmode||(J.dataselectionmode&&!J.highlighting)){if(i.isColHeaderArea()&&P.getColSpan()===1){P.setSelectable(P.isInnerMember()&&!P.isResult())}else if(i.isRowHeaderArea()&&P.getRowSpan()===1){P.setSelectable(P.isInnerMember()&&!P.isResult())}else{P.setSelectable(false)}}else{if(i.isColHeaderArea()&&P.getColSpan()===1){if(!J.highlighting.rows){P.setSelectable(P.isInnerMember()&&!P.isResult())}else{P.setSelectable(false)}}else if(i.isRowHeaderArea()&&P.getRowSpan()===1){if(!J.highlighting.cols){P.setSelectable(P.isInnerMember()&&!P.isResult())}else{P.setSelectable(false)}}else{P.setSelectable(false)}}i.insertCell(P,L,M)};var H=function(j,i){var L=j._v;if(L){var P=sap.zen.crosstab.utils.Utils.prepareStringForRendering(L);i.setText(P.text);i.setTextHasLineBreaks(P.bHasLineBreaks)}var M=j.exceptionvisualizations;if(M){for(var N in M){if(M.hasOwnProperty(N)){var O=M[N];if(O){sap.zen.crosstab.CellStyleHandler.setExceptionStylesOnCell(i,O.formattype,O.alertlevel)}}}}if(j.isemphasized){i.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_EMPHASIZED)}if(!(c.getPropertyBag().isMobileMode()||c.getPropertyBag().isTestMobileMode())){if(j.isdataentryenabled){i.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_DATA_ENTRY_ENABLED);i.setEntryEnabled(true);if(j.unit){i.setUnit(j.unit)}}if(j.hasinvalidvalue){i.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_INVALID_VALUE)}if(j.hasnewvalue){i.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_NEW_VALUE)}if(j.islocked){i.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_LOCKED)}}if(j.isresult){if(i.setResult){i.setResult(j.isresult)}i.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_TOTAL)}if(j.passivetype){i.setPassiveCellType(j.passivetype)}};var I=function(j,i,L){if(j.rowspan){i.setRowSpan(j.rowspan)}else{i.setRowSpan(1)}if(j.colspan){i.setColSpan(j.colspan)}else{i.setColSpan(1)}if(j.key){i.setMergeKey(j.key)}if(j.sort){i.setSort(j.sort)}if(j.sorttxtidx){i.setSortTextIndex(parseInt(j.sorttxtidx,10))}if(j.sortaction){i.setSortAction(j.sortaction)}if(typeof(j.level)!="undefined"){i.setLevel(j.level);K(L,i,j.level)}else{i.setLevel(-1)}if(j.drillstate){if(j.drillstate!=="A"){i.setDrillState(j.drillstate)}}if(j.hierarchyaction){i.setHierarchyAction(j.hierarchyaction)}if(j.hierarchytooltip){i.setHierarchyTooltip(j.hierarchytooltip)}if(j.isinnermember){i.setInnerMember(j.isinnermember)}if(i.getRow()%2===1&&i.getRowSpan()===1&&(j.isinnermember||i.getColSpan()+i.getCol()===F)){i.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_ALTERNATING)}};var K=function(i,j,L){if(i.getAreaType()===sap.zen.crosstab.rendering.RenderingConstants.TYPE_COLUMN_HEADER_AREA){var M=j.getRow();if(h[M]!=undefined){if(h[M]<L){h[M]=L}}else{h[M]=L}}else if(i.getAreaType()===sap.zen.crosstab.rendering.RenderingConstants.TYPE_ROW_HEADER_AREA){var N=j.getCol();if(k[N]!=undefined){if(k[N]<L){k[N]=L}}else{k[N]=L}}}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.keyboard.CrosstabKeyboardNavHandler')){jQuery.sap.declare("sap.zen.crosstab.keyboard.CrosstabKeyboardNavHandler");sap.zen.crosstab.keyboard.CrosstabKeyboardNavHandler=function(c,E){"use strict";var f=-1;var F=-1;var o=-1;var O=-1;var n=0;var N=0;var t=this;var b=false;var d=c.getDataArea();this.reset=function(){this.disableCell(f,F);this.disableCell(o,O);f=-1;F=-1;o=-1;O=-1;n=0;N=0};this.setEnabled=function(p){b=p};this.attachEvents=function(j){if(!b){return}j.off("keydown",this.keyboardNavKeyHandler);j.on("keydown",this.keyboardNavKeyHandler);j.attr("tabindex",sap.zen.crosstab.rendering.RenderingConstants.TABINDEX)};this.getFocusScrollDiv=function(C){var D=null;if(C.getArea().isDataArea()||C.getArea().isColHeaderArea()){D=$('#'+c.getId()+'_lowerRight_scrollDiv')[0]}else if(C.getArea().isRowHeaderArea()){D=$('#'+c.getId()+'_lowerLeft_scrollDiv')[0]}return D};this.movePixelCellIntoFocus=function(C,D,s,u,l){var h=false;var e=D.getBoundingClientRect();var S=s.right-s.left;var i=e.right-e.left;var g=s.bottom-s.top;var j=e.bottom-e.top;if(i<S){if(e.right>s.right){var k=c.getHScrollbar().getScrollPosition();c.scrollHorizontal(k+e.right-s.right);h=true}else if(e.left<s.left){var k=c.getHScrollbar().getScrollPosition();c.scrollHorizontal(k-(s.left-e.left));h=true}}if(u||l){if(j<g){if(e.bottom>s.bottom){var k=c.getVScrollbar().getScrollPosition();c.scrollVertical(k+e.bottom-s.bottom);h=true}else if(e.top<s.top){var k=c.getVScrollbar().getScrollPosition();c.scrollVertical(k-(s.top-e.top));h=true}}else{var k=c.getVScrollbar().getScrollPosition();c.scrollVertical(k-(s.top-e.top));h=true}}return h};this.moveRowHeaderAreaCellHorizontally=function(C,D){var s=$('#'+c.getId()+"_lowerLeft_scrollDiv")[0].getBoundingClientRect();var e=D.getBoundingClientRect();var S=s.right-s.left;var i=e.right-e.left;var h=c.getHorizontalHeaderScrollbar();if(i<S){if(e.right>s.right){var g=h.getScrollPosition();c.scrollHeaderHorizontal(g+e.right-s.right)}else if(e.left<s.left){var g=h.getScrollPosition();c.scrollHeaderHorizontal(g-(s.left-e.left))}}};this.moveRowColCellIntoFocus=function(C,D,s,u,l){var h=false;var e=D.getBoundingClientRect();var S=s.right-s.left;var i=e.right-e.left;var r=c.getDataArea().getRenderStartCol();var R=c.getDataArea().getRenderStartRow();var m=c.getDataArea().getRowCnt()-1;if(C.getArea().isDataArea()||C.getArea().isColHeaderArea()){var H=c.getHScrollbar();if(H){if(i<S){if(e.right>s.right){c.scrollHorizontal(r+1);h=true}else if(e.left<s.left){c.scrollHorizontal(r-1);h=true}}}}if(c.isHeaderHScrolling()===true&&C.getArea().isRowHeaderArea()){this.moveRowHeaderAreaCellHorizontally(C,D)}if(R===C.getTableRow()-c.getTableFixedColHeaderRowCnt()){return h}if(C.getArea().isDataArea()||(C.getArea().isRowHeaderArea()&&u)||l){var v=c.getVScrollbar();if(v){var g=c.getDataArea().getRenderRowCnt();var j=v.getScrollPosition();var k=C.getTableRow()-c.getTableFixedColHeaderRowCnt();if(k<R){c.scrollVertical(k);h=true}else if(k+C.getRowSpan()>(R+g)){var p=R+g-C.getRow();var q=C.getRowSpan()-p;var w=Math.max(0,Math.min(j+q+1,m));if(q!==0){c.scrollVertical(w);h=true}R=c.getDataArea().getRenderStartRow();if(R>k){c.scrollVertical(k);h=true}}R=c.getDataArea().getRenderStartRow();if(R===C.getTableRow()-c.getTableFixedColHeaderRowCnt()){return h}if(h){D=$('#'+C.getId())[0];e=D.getBoundingClientRect();j=v.getScrollPosition()}if(e.bottom>s.bottom){while(e.bottom>s.bottom&&j<m){c.scrollVertical(Math.min(j+1,m));j=v.getScrollPosition();D=$('#'+C.getId())[0];e=D.getBoundingClientRect();h=true}}else if(e.top<s.top){c.scrollVertical(Math.max(0,j-1));h=true}}}return h};this.getCellIntoDom=function(C,e,g){var i=0;if(N===0){var h=c.getHScrollbar();if(h&&!g){if(n>0){i=h.getScrollPosition()+e.getColSpan()}else if(n<0){i=C.getTableCol()-c.getTableFixedRowHeaderColCnt()}c.scrollHorizontal(i)}}else if(n==0){var v=c.getVScrollbar();if(v){if(N>0){i=v.getScrollPosition()+e.getRowSpan()}else{if(N<0){i=C.getTableRow()-c.getTableFixedColHeaderRowCnt()}}c.scrollVertical(i)}}};this.getRowLookAheadCell=function(C){var l=null;var T=null;var m=0;var M=0;if(C.getRowSpan()>1){if(n>0){M=C.getTableCol();m=c.getRenderStartCol()+c.getRenderColCnt()+c.getTableFixedRowHeaderColCnt();for(var i=M;i<=m;i++){T=c.getTableCellWithSpans(f,i);if(T.getRowSpan()===1){l=T;break}else{if(l){if(T.getRowSpan()<l.getRowSpan()){l=T}}else{l=T}}}}}else{l=C}return l};this.scrollCellIntoFocus=function(C,u,e,g){var l=C;var L=false;if(!u&&C.getArea().isRowHeaderArea()&&e===true&&c.getVScrollbar()&&!c.isHeaderHScrolling()){if(n>0&&N===0){l=this.getRowLookAheadCell(C)}}if(l!==C){C=l;L=true}var D=this.getFocusScrollDiv(C);if(!D){return false}var h=false;var i=c.getPropertyBag().isPixelScrolling();var j=$('#'+C.getId())[0];if(!j&&!i){this.getCellIntoDom(C,g,e)}if(!j){return false}var s=D.getBoundingClientRect();if(i){h=this.movePixelCellIntoFocus(C,j,s,u,L)}else{h=this.moveRowColCellIntoFocus(C,j,s,u,L)}return h};this.keyboardNavKeyHandler=function(e){if(f>-1&&F>-1){n=0;N=0;if(e.which===9){n=1}else if(e.which===38){N=-1}else if(e.which===40){N=1}else if(e.which===37){n=-1}else if(e.which===39){n=1}if(n===0&&N===0){return true}else{if(!c.hasLoadingPages()){t.moveCellFocus()}sap.zen.crosstab.utils.Utils.cancelEvent(e);return false}}return true};this.restoreFocusOnCell=function(){if(!b){return}if(f>-1&&F>-1&&!c.hasLoadingPages()){var r=c.getTableCellWithSpans(f,F);if(r&&!r.isLoading()){this.disableCell(o,O);this.navigateToCellAction(r,-1,-1)}}};function a(j,D){var x=D.scrollLeft;var y=D.scrollTop;j.focus();if(D.scrollLeft!==x){D.scrollLeft=x}if(D.scrollTop!==y){D.scrollTop=y}}this.navigateToCellAction=function(C,s,S){var j=null;var J=null;var D=null;var e=null;j=$('#'+C.getId());j.addClass("sapzencrosstab-CellFocus");J=$('#'+C.getId()+"_contentDiv");e=j.find("#"+C.getId()+"_textContentDiv");if(!C.isEntryEnabled()){D=this.getFocusScrollDiv(C);if(e.length>0){J=e}if($.browser.mozilla){a(J,D)}var g=J[0];if(g&&s===-1&&S===-1){sap.zen.crosstab.utils.Utils.selectTextInElement(g)}a(J,D)}else{E.provideInputEnabledCell(C,C.getId(),J,s,S)}};this.navigateFromCellAction=function(C){var j=$('#'+C.getId());if(j.length>0){j.removeClass("sapzencrosstab-CellFocus")}var i=j.find("input");i.focusout()};this.focusNewCell=function(C,s,S){if(!b){return false}if(!C){return false}var h=false;if(f>-1&&F>-1){this.disableCell(f,F)}f=C.getTableRow();F=C.getTableCol();o=f;O=F;var v=c.getVScrollbar();var H=c.getHScrollbar();if(v||H){if(v){h=this.scrollCellIntoFocus(C,true,false,null)}}this.navigateToCellAction(C,s,S);return h};this.scrollToCell=function(C){var D=C.getTableRow()-c.getTableFixedColHeaderRowCnt();var i=C.getTableCol()-c.getTableFixedRowHeaderColCnt();var v=D<c.getRenderStartRow()||D>(c.getRenderStartRow()+c.getRenderRowCnt());var h=false;if(C.getArea().isDataArea()||C.getArea().isColHeaderArea()){h=i<c.getRenderStartCol()||i>(c.getRenderStartCol()+c.getRenderColCnt())}if(c.getVScrollbar()&&v){c.scrollVertical(C.getTableRow()-c.getTableFixedColHeaderRowCnt())}if(c.getHScrollbar()&&C.getArea().isDataArea()&&h){c.scrollHorizontal(C.getTableCol()-c.getTableFixedRowHeaderColCnt())}};this.disableCell=function(T,i){var C=null;if(T>-1&&T>-1){C=c.getTableCellWithSpans(T,i);if(C&&!C.isLoading()){this.navigateFromCellAction(C)}}};this.moveCellFocus=function(){if(!b){return}var e=null;var s=-1;var S=-1;var m=c.getTableRowCnt()-1;var M=c.getTableColCnt()-1;var i=c.getTableFixedColHeaderRowCnt();o=f;O=F;var g=false;var u=false;var C=c.getTableCellWithSpans(o,O);if(C&&!c.hasLoadingPages()){if(n!==0||N!==0){this.scrollToCell(C)}}if(N<0){if(C.getTableRow()===i){return}}else if(N>0){if((C.getTableRow()+C.getRowSpan()-1)===m){return}}this.disableCell(C.getTableRow(),C.getTableCol());if(f>-1&&F>-1){if(n===0&&N===0){return}var h=f;var j=F;if(n!==0){if(n>0){j=C.getTableCol()+C.getColSpan()+n-1;if(j>M){if(h<m){h++;j=0;s=0;g=true}else{j=M;h=m}}}else{j=C.getTableCol();j--;if(j>=0){var p=c.getTableCellWithSpans(h,j);if(!p){return}if(p.isLoading()){return}j=p.getTableCol()}else{if(h>i){h--;j=M;s=M;if(h<d.getRenderStartRow()+i){S=h-i}g=true}else{j=0;h=i}}}e=c.getTableCellWithSpans(h,j);if(e.isLoading()){return}if(C){if(C.getArea()!==e.getArea()&&s===-1){s=0}}}else if(N!==0){if(N>0){h=Math.min(C.getTableRow()+C.getRowSpan()+N-1,m)}else if(N<0){h=Math.max(C.getTableRow()+N,i)}e=c.getTableCellWithSpans(h,j);if(e.isLoading()){return}h=e.getTableRow();u=true}f=h;F=j}if(e){if(S>=0){c.scrollVertical(S)}if(s>=0){c.scrollHorizontal(s)}this.scrollCellIntoFocus(e,u,g,C);this.navigateToCellAction(e,-1,-1)}}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.paging.CellMerger')){jQuery.sap.declare("sap.zen.crosstab.paging.CellMerger");sap.zen.crosstab.paging.CellMerger=function(p){"use strict";var r=null;var c=null;this.mergeRowHeaderCells=function(P){r=p.getCrosstab().getRowHeaderArea();var C=0;var M=null;for(C=0;C<r.getColCnt();C++){M=d(P,C);if(M){b(M,P,C)}M=a(P,C);if(M){m(M,P,C)}}};function m(M,P,C){var l=P-1;var o=null;var u=null;var R=null;var n=0;var q=M.getRowSpan();var s=p.getHeaderTileInfo(r,l).iStatus;while(s===sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADED&&l>=0&&!u){R=g(l);for(n=R.iMaxRowIndex;n>=R.iMinRowIndex&&!u;n--){o=r.getCellDirect(n,C);if(o){if(o.getMergeKey()){if(M.getMergeKey()===o.getMergeKey()){if(n===R.iMaxRowIndex||o.getRowSpan()>1){u=o}else{return}}else{return}}}}l--;s=p.getHeaderTileInfo(r,l).iStatus}if(u){k(M,u);u.setRowSpan(q+u.getRowSpan());r.insertCell(null,M.getRow(),M.getCol())}}function g(P){var R={};R.iMinRowIndex=P*p.getTileRowCnt();R.iMaxRowIndex=(P+1)*p.getTileRowCnt()-1;R.iMaxRowIndex=Math.min(R.iMaxRowIndex,r.getRowCnt()-1);return R}function a(P,C){var t=null;var I=g(P);var R=0;var o=null;var M="";for(R=I.iMinRowIndex;R<=I.iMaxRowIndex&&!t;R++){o=r.getCellDirect(R,C);if(o){M=o.getMergeKey();if(M){t=o}}}return t}function b(M,P,C){var o=null;var F=0;var s="";var I=null;var S=p.getHeaderTileInfo(r,P+1).iStatus;if(S===sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADED){I=g(P+1);o=r.getCellDirect(I.iMinRowIndex,C);if(o){s=o.getMergeKey();if(s&&s===M.getMergeKey()){F=o.getRowSpan();r.insertCell(null,I.iMinRowIndex,C);k(o,M)}}}if(F){M.setRowSpan(M.getRowSpan()+F)}}function d(P,C){var B=null;var I=g(P);var R=0;var M="";var o=null;for(R=I.iMaxRowIndex;R>=I.iMinRowIndex&&!B;R--){o=r.getCellDirect(R,C);if(o){M=o.getMergeKey();if(M){B=o}}}return B}this.mergeColHeaderCells=function(P){c=p.getCrosstab().getColumnHeaderArea();var R=0;var M=null;for(R=0;R<c.getRowCnt();R++){M=h(P,R);if(M){f(M,P,R)}M=i(P,R);if(M){j(M,P,R)}}};function e(P){var C={};C.iMinColIndex=P*p.getTileColCnt();C.iMaxColIndex=(P+1)*p.getTileColCnt()-1;C.iMaxColIndex=Math.min(C.iMaxColIndex,c.getColCnt()-1);return C}function f(M,P,R){var C=null;var F=0;var s="";var I=null;var S=p.getHeaderTileInfo(c,P+1).iStatus;if(S===sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADED){I=e(P+1);C=c.getCellDirect(R,I.iMinColIndex);if(C){s=C.getMergeKey();if(s&&s===M.getMergeKey()){F=C.getColSpan();c.insertCell(null,R,I.iMinColIndex);k(C,M)}}}if(F){M.setColSpan(M.getColSpan()+F)}}function h(P,R){var o=null;var I=e(P);var C=0;var M="";var l=null;for(C=I.iMaxColIndex;C>=I.iMinColIndex&&!o;C--){l=c.getCellDirect(R,C);if(l){M=l.getMergeKey();if(M){o=l}}}return o}function i(P,R){var l=null;var I=e(P);var C=0;var o=null;var M="";for(C=I.iMinColIndex;C<=I.iMaxColIndex&&!l;C++){o=c.getCellDirect(R,C);if(o){M=o.getMergeKey();if(M){l=o}}}return l}function j(M,P,R){var C=P-1;var o=null;var l=null;var n=null;var q=0;var s=M.getColSpan();var S=p.getHeaderTileInfo(c,C).iStatus;while(S===sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADED&&C>=0&&!l){n=e(C);for(q=n.iMaxColIndex;q>=n.iMinColIndex&&!l;q--){o=c.getCellDirect(R,q);if(o){if(o.getMergeKey()){if(M.getMergeKey()===o.getMergeKey()){if(q===n.iMaxColIndex||o.getColSpan()>1){l=o}else{return}}else{return}}}}C--;S=p.getHeaderTileInfo(c,C).iStatus}if(l){k(M,l);l.setColSpan(s+l.getColSpan());c.insertCell(null,M.getRow(),M.getCol())}}function k(s,t){var S=s.getStyleIdList();t.setStyleIdList(S)}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.paging.Page')){jQuery.sap.declare("sap.zen.crosstab.paging.Page");sap.zen.crosstab.paging.Page=function(p,P,o){"use strict";var s=sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_UNKNOWN;var a=0;var b=0;var c=o.getTileRowCnt();var d=o.getTileColCnt();var C=o.getCellMerger();var D=o.getDataHandler();var e=o.getCrosstab();var f=e.getDimensionHeaderArea();var g=e.getColumnHeaderArea();var r=e.getRowHeaderArea();var h=e.getDataArea();var j={};var A=[];k();function k(){A.push(f.getAreaType());A.push(g.getAreaType());A.push(r.getAreaType());A.push(h.getAreaType())}this.getPageKey=function(){return P};this.getRow=function(){return oPageCoordinates.iRow};this.getCol=function(){return oPageCoordinates.iCol};this.getPosition=function(){return p};this.getStatus=function(){return s};this.setStatus=function(N){s=N};this.getPageDataRowCnt=function(){return a};this.getPageDataColCnt=function(){return b};this.receiveData=function(i,K){a=i.sentdatarows;b=i.sentdatacols;c=i.tilerows;d=i.tilecols;D.determineBasicAreaData(i,K);w();var L={};L.iRowOffset=p.iRow*c;L.iColOffset=p.iCol*d;L.bIsFirstPage=K;L.oCrosstabAreasToBeFilled=j;L.oCrosstabData=i;D.jsonToDataModel(L);z();x()};this.removeData=function(){s=sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_UNKNOWN;j={};y(h);n();l()};function l(){var i=0;var K=null;for(i=0;i<A.length;i++){K=j[A[i]];if(K){F(K,false);K.oArea.decreaseLoadingPageCnt()}}}function m(i,T){var K=v(i,T);if(K.iRefCnt===0){K.iStatus=sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_UNKNOWN;o.setHeaderTileInfo(i,T,K);y(i)}}function n(){m(f,0);m(r,p.iRow);m(g,p.iCol)}function q(){u(f,0);u(r,p.iRow);u(g,p.iCol)}function t(i,T,s){var K=o.getHeaderTileInfo(i,T);K.iStatus=s;o.setHeaderTileInfo(i,T,K)}function u(i,T){var K=o.getHeaderTileInfo(i,T);K.iRefCnt++;o.setHeaderTileInfo(i,T,K)}function v(i,T){var K=o.getHeaderTileInfo(i,T);K.iRefCnt--;o.setHeaderTileInfo(i,T,K);return K}function w(){j={};y(h,0);if(o.getHeaderTileInfo(r,p.iRow).iStatus!==sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADED){y(r,p.iRow)}if(o.getHeaderTileInfo(g,p.iCol).iStatus!==sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADED){y(g,p.iCol)}if(o.getHeaderTileInfo(f,0).iStatus!==sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADED){y(f,0)}}function x(){var i=0;var K=null;for(i=0;i<A.length;i++){K=j[A[i]];if(K){G(K,false);H(K,false);K.oArea.decreaseLoadingPageCnt()}}}function y(i,T){var K=i.getAreaType();var L={};L.oArea=i;L.oAreaRegion=I(i);L.iTileIndex=T;j[K]=L}this.provideLoadingCells=function(i){s=sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADING;B(i);q();E()};function z(){s=sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADED;var i=null;i=j[g.getAreaType()];if(i){C.mergeColHeaderCells(p.iCol);t(i.oArea,p.iCol,sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADED)}i=j[r.getAreaType()];if(i){C.mergeRowHeaderCells(p.iRow);t(i.oArea,p.iRow,sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADED)}i=j[f.getAreaType()];if(i){t(i.oArea,0,sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADED)}}function B(i){j={};y(h,0);if(i.isDataArea()){if(o.getHeaderTileInfo(r,p.iRow).iStatus===sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_UNKNOWN){y(r,p.iRow);t(r,p.iRow,sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADING)}if(o.getHeaderTileInfo(g,p.iCol).iStatus===sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_UNKNOWN){y(g,p.iCol);t(g,p.iCol,sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADING)}if(o.getHeaderTileInfo(f,0).iStatus===sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_UNKNOWN){y(f,0);t(f,0,sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADING)}}else{if(i.isColHeaderArea()){y(i,p.iCol);t(i,p.iCol,sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADING)}else if(i.isRowHeaderArea()){y(i,p.iRow);t(i,p.iRow,sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADING)}else if(i.isDimensionHeaderArea()){y(i,0);t(i,0,sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADING)}}}function E(){var i=0;var K=null;for(i=0;i<A.length;i++){K=j[A[i]];if(K){F(K,true);G(K,true);H(K,true);K.oArea.increaseLoadingPageCnt()}}}function F(i,K){var R=0;var L=0;var M=null;var N=i.oAreaRegion;var O=i.oArea;for(R=N.iStartRow;R<=N.iEndRow;R++){for(L=N.iStartCol;L<=N.iEndCol;L++){if(K){M=J(O,R,L)}O.insertCell(M,R,L)}}}function G(i,K){var L=i.oAreaRegion;var M=i.oArea;var N=0;for(N=L.iStartCol;N<=L.iEndCol;N++){M.changeColWidthTemporaryFlag(N,P,K)}}function H(i,K){var L=i.oAreaRegion;var M=i.oArea;var R=0;for(R=L.iStartRow;R<=L.iEndRow;R++){M.changeRowHeightTemporaryFlag(R,P,K)}}function I(i){var K={};if(i.isDimHeaderArea()){K.iStartRow=0;K.iEndRow=i.getRowCnt()-1;K.iStartCol=0;K.iEndCol=i.getColCnt()-1}else if(i.isRowHeaderArea()){K.iStartRow=p.iRow*c;K.iEndRow=Math.min(K.iStartRow+c-1,i.getRowCnt()-1);K.iStartCol=0;K.iEndCol=i.getColCnt()-1}else if(i.isColHeaderArea()){K.iStartRow=0;K.iEndRow=i.getRowCnt()-1;K.iStartCol=p.iCol*d;K.iEndCol=Math.min(K.iStartCol+d-1,i.getColCnt()-1)}else if(i.isDataArea()){K.iStartRow=p.iRow*c;K.iEndRow=Math.min(K.iStartRow+c-1,i.getRowCnt()-1);K.iStartCol=p.iCol*d;K.iEndCol=Math.min(K.iStartCol+d-1,i.getColCnt()-1)}return K}function J(i,R,K){var L=null;if(i.isDataArea()){L=new sap.zen.crosstab.DataCell()}else{L=new sap.zen.crosstab.HeaderCell();L.setRowSpan(1);L.setColSpan(1)}L.setArea(i);L.setRow(R);L.setCol(K);L.setLoading(true);L.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_LOADING);return L}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.paging.RequestHandler')){jQuery.sap.declare("sap.zen.crosstab.paging.RequestHandler");sap.zen.crosstab.paging.RequestHandler=function(p){"use strict";var c=p.getCrosstab();var r=p.getRequestCommandTemplate();var P=p.getTileRowCnt();var i=p.getTileColCnt();var R=new sap.zen.crosstab.paging.RequestStack(0);var m=0;var t=0;R.addElementRemovedHandler(b);var o=null;this.sendPageRequest=function(e){R.push(e);a()};this.enableTimeout=function(e){t=e?1000:0};this.reset=function(){R.clear();m=0;this.enableTimeout(false)};this.setMaxQueueRequests=function(M){m=M};this.getMaxQueueRequests=function(){return R.getMaxSize()};this.unlimitStack=function(){R.unlimitStack()};function a(){if(o){clearTimeout(o)}o=setTimeout(h,t)}function s(e){var f=c.getPageRequestHandler();var g=e.getPosition();if(f){var j=Math.floor(g.iRow);var C=Math.floor(g.iCol);f(j,C)}else{var k=d(g);var S=new Function(k);S()}}function h(){var e=null;while(R.getActualSize()>0){e=R.pop();s(e)}if(m>0){R.resetStack(m);m=0}}function b(e){p.removeRequest(e)}function d(e){var f=e.iRow*P+1;var g=e.iCol*i+1;var C=r.replace("__X__",g);C=C.replace("__Y__",f);return C}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.rendering.ScrollManager')){jQuery.sap.declare("sap.zen.crosstab.rendering.ScrollManager");jQuery.sap.require('sap.ui.core.Popup');jQuery.sap.require('sap.ui.core.OpenState');jQuery.sap.require('sap.ui.commons.TextView');sap.zen.crosstab.rendering.ScrollManager=function(c,r){"use strict";var C=c.getColumnHeaderArea();var R=c.getRowHeaderArea();var d=c.getDimensionHeaderArea();var D=c.getDataArea();var m=r.getMeasuringHelper();var i=0;var a=0;var h=false;var v=false;var H=0;var V=0;var l=null;var o=null;var L=null;var b=null;var p=new sap.ui.core.Popup();p.setContent(new sap.ui.commons.TextView());p.setDurations(125,500);p.setAutoClose(true);p.getContent().addStyleClass("sapzencrosstab-ScrollPopup");p.getContent().setWrapping(false);var e=(D.getRowCnt()+"").length;var f=(D.getColCnt()+"").length;var g=0;var j=0;var B=false;var k=false;var t=this;this.destroy=function(){p.destroy()};this.setHScrollPos=function(G){a=G};this.setVScrollPos=function(G){i=G};function n(G){c.getPageManager().enableTimeout(true);o=null;var P=null;if(!G){P=l}else{P=G.getParameters()}if(P){var I=c.getHScrollbar();var M=I.getSteps();h=P.newScrollPos===M;a=P.newScrollPos;t.sendClientScrollPosUpdate();var S=P.newScrollPos;if(S!==C.getRenderStartCol()){if(S!==C.getColCnt()){r.beginRendering();r.renderColHeaderArea(S);r.renderDataArea();r.adjustColWidths(C,D);r.adjustRowHeights(R,D);r.adjustRowHeights(d,C);r.finishRendering()}var J=m.getAreaWidth(C);var K=m.getUpperRightScrollDivWidth();var N=J<K;var O=C.getRenderColCnt()+C.getRenderStartCol()===C.getColCnt();if(h||N&&O){if(N&&S>0){r.beginRendering();r.appendLeftCols(C,4);r.appendLeftCols(D,4);r.adjustColWidths(C,D);r.adjustRowHeights(R,D);r.adjustRowHeights(d,C);r.finishRendering()}if(!h&&P.forward){q(0,true)}s(true)}else{s(false)}}else{if(h){s(true)}}if(v){F(true)}if(P.newScrollPos===0){s(false)}}p.close()}this.hScrollHandler=function(G,N){if(!B){if(N){n(G)}else{l=G.getParameters();if(o){clearTimeout(o);o=null;u(l.newScrollPos)}o=setTimeout(n,200,null);a=l.newScrollPos}}else{B=false}};function q(S,G){var I=c.getHScrollbar();var J=I.getScrollPosition();if(G){S=I.getSteps()}if(J!==S){I.setScrollPosition(S);B=true}a=S}function s(S){var G=$('#'+c.getId()+"_lowerRight_scrollDiv");H=S?G[0].scrollWidth:0;t.positionHScrollDiv(G)}this.positionHScrollDiv=function(G){if(!G){G=$('#'+c.getId()+"_lowerRight_scrollDiv")}var U=$('#'+c.getId()+"_upperRight_scrollDiv");G.scrollLeft(H);U.scrollLeft(H)};this.vScrollHandler=function(G,N){if(!k){if(N){z(G)}else{L=G.getParameters();if(b){clearTimeout(b);b=null;x(L.newScrollPos)}b=setTimeout(z,200,null);i=L.newScrollPos}}else{k=false}};this.sendClientScrollPosUpdate=function(){c.getUtils().sendClientScrollPosUpdate(a,h,i,v)};function u(S){var C=c.getColumnHeaderArea();var G=null;var I=[];for(var J=0;J<1;J++){G=C.getCellWithColSpan(J,S,true);if(G){I.push(G.getUnescapedText())}else{I.push("?")}}var K=c.getPropertyBag().getText(sap.zen.crosstab.TextConstants.COL_TEXT_KEY)+" "+sap.zen.crosstab.utils.Utils.padWithZeroes(S+1,f)+"/"+C.getColCnt();if(!j){w(K);j=$('#'+p.getContent().getId()).innerWidth()}K=K+"\n"+I.join("\n");w(K)}function w(G){p.getContent().setProperty("text",G,true);var I=sap.ui.core.Popup.Dock;if(j){p.getContent().setWidth(j+"px")}var J=c.getHScrollbar();var W=m.getRenderSizeDivSize().iWidth-m.getAreaWidth(c.getRowHeaderArea());var P=$("#"+p.getContent().getId()).outerWidth();W=W-P;var K=J.getScrollPosition()/J.getSteps();var X=(W*K)+" ";p.setPosition(I.BeginBottom,I.BeginTop,$('#'+c.getHScrollbar().getId())[0],X+"-20");if(p.getOpenState()===sap.ui.core.OpenState.CLOSED){p.open(-1)}p.getContent().rerender()}function x(S){var R=c.getRowHeaderArea();var G=null;var I=[];for(var J=0;J<1;J++){G=R.getCellWithRowSpan(S,J,true);if(G){I.push(G.getUnescapedText())}else{I.push("?")}}var K=c.getPropertyBag().getText(sap.zen.crosstab.TextConstants.ROW_TEXT_KEY)+" "+sap.zen.crosstab.utils.Utils.padWithZeroes(S+1,e)+"/"+R.getRowCnt();if(!g){y(K);g=$('#'+p.getContent().getId()).innerWidth()}K=K+"\n"+I.join("\n");y(K)}function y(G){p.getContent().setProperty("text",G,true);var I=sap.ui.core.Popup.Dock;var J=c.getVScrollbar();var K=m.getRenderSizeDivSize().iHeight-m.getAreaHeight(c.getColumnHeaderArea());var P=$("#"+p.getContent().getId()).outerHeight();K=K-P;var M=J.getScrollPosition()/J.getSteps();var Y=" "+(K*M);p.setPosition(I.EndTop,I.BeginTop,$('#'+c.getVScrollbar().getId())[0],"-20"+Y);if(g){p.getContent().setWidth(g+"px")}if(p.getOpenState()===sap.ui.core.OpenState.CLOSED){p.open(-1)}p.getContent().rerender()}function z(G){c.getPageManager().enableTimeout(true);b=null;var P=null;if(!G){P=L}else{P=G.getParameters()}if(P){var I=c.getVScrollbar();var M=I.getSteps();v=P.newScrollPos===M;i=P.newScrollPos;t.sendClientScrollPosUpdate();var S=P.newScrollPos;if(S!==R.getRenderStartRow()){if(S!==R.getRowCnt()){r.beginRendering();r.renderRowHeaderArea(S);r.renderDataArea();r.adjustColWidths(d,R);r.adjustColWidths(C,D);r.adjustRowHeights(R,D);r.finishRendering()}var J=m.getAreaHeight(R);var K=m.getLowerScrollDivHeight();var N=J<K;var O=R.getRenderRowCnt()+R.getRenderStartRow()===R.getRowCnt();if(v||N&&O){if(N&&S>0){r.beginRendering();r.appendTopRows(R,2);r.appendTopRows(D,2);r.adjustColWidths(d,R);r.adjustColWidths(C,D);r.adjustRowHeights(R,D);r.finishRendering()}if(!v&&P.forward){E(0,true)}F(true)}else{F(false)}}else{if(v){F(true)}}if(P.newScrollPos===0){F(false)}if(h){s(true)}}p.close();A()}function A(){var G=c.getRenderEngine().getHeaderScrollManager();if(G){G.moveScrollbars()}}function E(S,G){var I=c.getVScrollbar();var J=I.getScrollPosition();if(G){S=I.getSteps()}if(J!==S){I.setScrollPosition(S);k=true}i=S}function F(S){var G=$('#'+c.getId()+"_lowerRight_scrollDiv");V=S?G[0].scrollHeight:0;t.positionVScrollDiv(G)}this.positionVScrollDiv=function(G){if(!G){G=$('#'+c.getId()+"_lowerRight_scrollDiv")}var I=$('#'+c.getId()+"_lowerLeft_scrollDiv");G.scrollTop(V);I.scrollTop(V)};this.moveScrollbars=function(S,G,I,J){var K=c.getHScrollbar();if(K){if(I!==undefined){h=I}else{h=(K.getSteps()<=a)&&(C.getRenderStartCol()+C.getRenderColCnt()>=C.getColCnt())}if(h){q(0,true);s(true)}else{q(a,false)}}var M=c.getVScrollbar();if(M){if(J!==undefined){v=J}else{v=(M.getSteps()<=i)&&(R.getRenderStartRow()+R.getRenderRowCnt()>=R.getRowCnt())}if(v){E(0,true);F(true)}else{E(i,false)}}};this.commandHScrolledToEnd=function(){h=true};this.commandVScrolledToEnd=function(){v=true};this.isVScrolledToEnd=function(){return v};this.isHScrolledToEnd=function(){return h};this.setVScrolledToEnd=function(G){v=G};this.setHScrolledToEnd=function(G){h=G}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.rendering.ScrollbarRenderer')){jQuery.sap.declare("sap.zen.crosstab.rendering.ScrollbarRenderer");sap.zen.crosstab.rendering.ScrollbarRenderer=function(c,r,m,d){"use strict";var s=0;var h=false;var v=false;var H=false;var o=null;var V=null;var a=null;var i=c.getPropertyBag().isPixelScrolling();function w(U){r.write("<div");r.writeAttribute("id",c.getId()+"_upperRightPad");r.writeAttribute("class","sapzencrosstab-UpperRightScrollPad");r.addStyle("width",s+"px");r.addStyle("height",U+"px");r.writeStyles();r.write(">");r.write("</div>")}function b(S,U){var e=null;var I=0;var z=0;if(!c.getVScrollbar()){e=new sap.ui.core.ScrollBar();c.setVScrollbar(e)}e=c.getVScrollbar();e.setVertical(true);if(H===true&&!h){I=$('#'+c.getId()+"_renderSizeDiv").outerHeight()-s}else{I=S}z=I-U;e.setSize(z+"px");r.renderControl(e)}function f(){r.write("<td");r.writeAttribute("class","sapzencrosstab-VScrollCell");r.write(">")}function g(S){var U=m.getUpperScrollDivHeight();r.write("<table");r.writeAttribute("id",c.getId()+"_vScrollTab");r.writeAttribute("class","sapzencrosstab-VScrollTable");r.write(">");r.write("<tr>");f();w(U);r.write("</td>");r.write("</tr>");r.write("<tr>");f();b(S,U);r.write("</td>");r.write("</tr>");r.write("</table>")}function j(){r.write("<div");r.writeAttribute("id",c.getId()+"_vScrollDiv");r.addStyle("position","absolute");r.addStyle("top","0px");r.addStyle("right","0px");r.addStyle("width",s+"px");var e=m.getRenderSizeDivSize().iHeight;if(h){e=Math.min(c.getContentHeight()-s,e)}r.addStyle("height",e+"px");r.writeStyles();r.write(">");g(e);r.write("</div>")}function k(){var W=0;var D=$('#'+c.getId()+"_upperLeft_scrollDiv");if(D.length>0){W=$.browser.msie?D.width():D.outerWidth()}if(W===0){D=$('#'+c.getId()+"_lowerLeft_scrollDiv");W=$.browser.msie?D.width():D.outerWidth()}return W}function l(L){if(!H){r.write("<div");r.writeAttribute("id",c.getId()+"_lowerLeftPad");r.writeAttribute("class","sapzencrosstab-LowerLeftScrollPad");r.addStyle("width",L+"px");r.addStyle("height",s+"px");r.writeStyles();r.write(">");r.write("</div>")}else{var e=null;if(!c.getHorizontalHeaderScrollbar()){e=new sap.ui.core.ScrollBar();c.setHorizontalHeaderScrollbar(e)}e=c.getHorizontalHeaderScrollbar();e.setVertical(false);var z=k();e.setSize(z+"px");r.renderControl(e)}}function n(H){if(H===true){r.write("<td");r.writeAttribute("id",c.getId()+"_hScrollTableCell");r.writeAttribute("class","sapzencrosstab-HScrollCell sapzencrosstab-HScrollCellWithHeaderScrollRightBorder")}else{r.write("<td");r.writeAttribute("class","sapzencrosstab-HScrollCell")}r.write(">")}function p(){r.write("<div");r.writeAttribute("id",c.getId()+"_lowerRightPad");r.writeAttribute("class","sapzencrosstab-LowerRightScrollPad");r.addStyle("width",s+"px");r.addStyle("height",s+"px");r.writeStyles();r.write(">");r.write("</div>")}function q(S,L){if(h===true){var e=null;if(!c.getHScrollbar()){e=new sap.ui.core.ScrollBar();c.setHScrollbar(e)}e=c.getHScrollbar();e.setVertical(false);e.setSize((S-L-(v?s:0))+"px");r.renderControl(e)}else{r.write("<div");r.writeAttribute("id",c.getId()+"_lowerMiddlePad");r.writeAttribute("class","sapzencrosstab-LowerMiddleScrollPad");r.addStyle("width",(S-L-(v?s:0))+"px");r.addStyle("height",s+"px");r.writeStyles();r.write(">");r.write("</div>")}}function t(W){var D=$('#'+c.getId()+"_lowerLeft");var L=D.outerWidth();r.write("<table");r.writeAttribute("id",c.getId()+"_hScrollTab");r.writeAttribute("class","sapzencrosstab-HScrollTable");r.write(">");r.write("<tr>");n(H);l(L);r.write("</td>");var S=c.getContentWidth();n();q(S,L);r.write("</td>");if(v){n();p();r.write("</td>")}r.write("</tr>");r.write("</table>")}function u(){r.write("<div");r.writeAttribute("id",c.getId()+"_hScrollDiv");r.addStyle("position","absolute");var T=c.getPropertyBag().getToolbarHeight();r.addStyle("bottom",T+"px");r.addStyle("height",s+"px");var W=c.getContentWidth();r.addStyle("width",W+"px");r.addStyle("height",s+"px");r.writeStyles();r.write(">");t(W);r.write("</div>")}this.renderScrollbars=function(S){h=S.bHasHScrollbar;v=S.bHasVScrollbar;H=S.bHasHHeaderScrollbar;if(h||v||H){s=m.getBrowserScrollbarWidth();if(s===0){if(v){var e=new sap.ui.core.ScrollBar();c.setVScrollbar(e)}if(h){var z=new sap.ui.core.ScrollBar();c.setHScrollbar(z)}if(H){var A=new sap.ui.core.ScrollBar();c.setHorizontalHeaderScrollbar(A)}}else{var T=d.getElement(c.getId());var I=T.html();if(v){j()}if(h||H){u()}r.write(I);r.flush(T[0])}}};this.attachHandlers=function(e,z,A){this.detachHandlers();o=e;V=z;a=A;if(o&&c.getHScrollbar()){c.getHScrollbar().attachScroll(o);c.getHScrollbar().attachBrowserEvent("mousedown touchstart",sap.zen.crosstab.utils.Utils.cancelEvent)}if(V&&c.getVScrollbar()){c.getVScrollbar().attachScroll(V);c.getVScrollbar().attachBrowserEvent("mousedown touchstart",sap.zen.crosstab.utils.Utils.cancelEvent);this.attachMouseWheelHandler()}if(a&&c.getHorizontalHeaderScrollbar()){c.getHorizontalHeaderScrollbar().attachScroll(a);c.getHorizontalHeaderScrollbar().attachBrowserEvent("mousedown touchstart",sap.zen.crosstab.utils.Utils.cancelEvent)}};this.attachMouseWheelHandler=function(){if(!c.getPropertyBag().isMobileMode()){var T=c.getTableDiv();if(/Firefox/i.test(navigator.userAgent)){T[0].addEventListener("DOMMouseScroll",this.vScrollMouseWheelFireFox)}else{T.on("mousewheel",this.vScrollMouseWheel)}}};this.detachMouseWheelHandler=function(){if(!c.getPropertyBag().isMobileMode()){var T=c.getTableDiv();if(/Firefox/i.test(navigator.userAgent)){T[0].removeEventListener("DOMMouseScroll",this.vScrollMouseWheelFireFox)}else{T.off("mousewheel",this.vScrollMouseWheel)}}};function x(e){return e&&e/Math.abs(e)}this.vScrollMouseWheelFireFox=function(e){var F=x(e.detail);y(e,F)};this.vScrollMouseWheel=function(e){var F=-x(e.originalEvent.wheelDelta);y(e,F)};function y(e,F){if(c.hasLoadingPages()===false){var S=0;var U=0;if(i===true){S=120;U=parseInt(c.getVScrollbar().getContentSize(),10)}else{S=3;U=c.getVScrollbar().getSteps()}var N=c.getVScrollPos()+F*S;N=Math.max(0,N);N=Math.min(N,U);c.getRenderEngine().scrollVertical(N,true)}sap.zen.crosstab.utils.Utils.cancelEvent(e)}this.detachHandlers=function(){if(o&&c.getHScrollbar()){c.getHScrollbar().detachScroll(o);c.getHScrollbar().detachBrowserEvent("mousedown touchstart",sap.zen.crosstab.utils.Utils.cancelEvent)}if(V&&c.getVScrollbar()){c.getVScrollbar().detachScroll(V);c.getVScrollbar().detachBrowserEvent("mousedown touchstart",sap.zen.crosstab.utils.Utils.cancelEvent);this.detachMouseWheelHandler()}if(a&&c.getHorizontalHeaderScrollbar()){c.getHorizontalHeaderScrollbar().detachScroll(a);c.getHorizontalHeaderScrollbar().detachBrowserEvent("mousedown touchstart",sap.zen.crosstab.utils.Utils.cancelEvent)}o=null;V=null;a=null};this.destroy=function(){this.detachHandlers();s=0;h=false;v=false;o=null;V=null};this.setScrollbarSteps=function(){if(c.getPropertyBag().isPixelScrolling()){this.setScrollbarStepsInPixelMode()}else{this.setScrollbarStepsInStepMode()}if(H){this.setHorizontalHeaderScrollbarSteps()}};this.setHorizontalHeaderScrollbarSteps=function(){var e=c.getHorizontalHeaderScrollbar();if(e){var D=null;if(c.hasDimensionHeaderArea()){D=c.getId()+"_dimHeaderArea_container"}else if(c.hasRowHeaderArea()){D=c.getId()+"_rowHeaderArea_container"}if(D){var J=$('#'+D);e.setContentSize(J.outerWidth()+"px");e.rerender()}}};this.adjustHorizontalHeaderScrollbarContainerSize=function(){var e=c.getHorizontalHeaderScrollbar();if(e){var T=$('#'+c.getId()+"_hScrollTableCell");if(T.length>0){var W=parseInt(T.css("border-right-width"),10)+parseInt(T.css("border-left-width"),10);e.setSize((parseInt(e.getSize(),10)-W)+"px");e.rerender()}}};this.setScrollbarStepsInPixelMode=function(){var e=c.getVScrollbar();var z=c.getHScrollbar();var D=$('#'+c.getId()+"_dataArea_container");if(e){var A=0;if(!c.hasDataArea()){var B=$('#'+c.getId()+"_rowHeaderArea_container");A=B.outerHeight()}else{A=D.outerHeight()}e.setContentSize(A+"px");e.rerender()}if(z){var W=0;if(!c.hasDataArea()){var C=$('#'+c.getId()+"_colHeaderArea_container");W=C.outerWidth()}else{W=D.outerWidth()}z.setContentSize(W+"px");z.rerender()}};this.setScrollbarStepsInStepMode=function(){var R=m.getRenderSizeDivSize();var D=c.getDataArea();var e=c.getVScrollbar();var z=c.getHScrollbar();if(e){var C=m.getAreaHeight(c.getColumnHeaderArea());var A=R.iHeight-C;var B=D.getRenderStartRow();var M=B+D.getRenderRowCnt();var E=1;for(var F=B;F<M;F++){A-=D.getRowHeight(F);if(A<0){break}E++}e.setSteps(Math.max(1,D.getRowCnt()-E));e.rerender()}if(z){var G=m.getAreaWidth(c.getRowHeaderArea());var I=R.iWidth-G;var J=D.getRenderStartCol();var K=J+D.getRenderColCnt();var L=1;for(var N=J;N<K;N++){I-=D.getColWidth(N);if(I<0){break}L++}z.setSteps(Math.max(1,D.getColCnt()-L));z.rerender()}};this.adjustHScrollbarWidth=function(S){var D=$('#'+c.getId()+'_lowerLeftPad');var e=$('#'+c.getId()+'_lowerRight_scrollDiv');D.width(S);var z=c.getHScrollbar();z.setSize(e.outerWidth()+"px");z.rerender()};this.adjustVScrollbarHeight=function(S){var D=$('#'+c.getId()+'_upperRightPad');var e=$('#'+c.getId()+'_lowerRight_scrollDiv');D.height(S);var z=c.getVScrollbar();z.setSize(e.outerHeight()+"px");z.rerender()}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.paging.PageManager')){jQuery.sap.declare("sap.zen.crosstab.paging.PageManager");sap.zen.crosstab.paging.PageManager=function(c){"use strict";var j=new sap.zen.crosstab.datahandler.JsonDataHandler(c);var C=new sap.zen.crosstab.paging.CellMerger(this);var r=null;var p={};var h={};var P=0;var a=0;var R="";var b=0;var d=0;var H=false;var e=[];var f=false;var n=true;var o={};var A={};function g(){l();if(f||n){f=false;n=false;k()}}function k(){var D=c.getDataArea();var i=D.getRenderRowCnt();var v=D.getRenderColCnt();var w=Math.round(v/a)+1;var V=Math.round(i/P)+1;var M=Math.max(1,w*V*2);if(r){r.setMaxQueueRequests(M)}}this.enableTimeout=function(E){if(r){r.enableTimeout(E)}};this.getRequestStackSize=function(){var i=-1;if(r){i=r.getMaxQueueRequests()}return i};this.resizeEvent=function(){f=true;if(r){r.unlimitStack()}};this.checkResponseConsistency=function(i){if(i.pvcheck){return true}if(P>0&&a>0){return(i.tilerows===P&&i.tilecols===a)}return true};this.receiveData=function(i){var I=this.checkResponseConsistency(i);if(I){t(i);var v={};v.iRow=b;v.iCol=d;var w=null;var x=s();if(x){w=this.createPage(v);H=true}else{w=this.getPage(v)}if(w){w.receiveData(i,x)}if(c.getPropertyBag().isDebugMode()){var y=w.getPosition();var K=y.iRow+"_"+y.iCol;o[K]={};o[K].component=i}}};function l(){var i=0;var v=null;var w="";for(i=0;i<e.length;i++){v=e[i];if(v){v.removeData();w=v.getPageKey();delete p[w]}}e=[]}c.getRenderEngine().addAfterFinishRenderingHandler(g);this.removeRequest=function(i){e.push(i)};this.getRequestCommandTemplate=function(){return R};this.removeHeaderTileRequest=function(i,T,v){var w=h[i.getAreaType()];if(w){var x=w[T];if(x){var y=$.inArray(v,x.aRequestingPages);if(y!==-1){x.aRequestingPages.splice(y,1);if(x.aRequestingPages.length===0){x.iStatus=sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_UNKNOWN}}}}};this.getHeaderTileInfo=function(i,T){return q(i,T)};this.setHeaderTileInfo=function(i,T,v){var w=m(i);w[T]=v};function m(i){var T=h[i.getAreaType()];if(!T){T={};h[i.getAreaType()]=T}return T}function q(i,T){var v=m(i);var w=v[T];if(!w){w={};w.iStatus=sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_UNKNOWN;w.iRefCnt=0;v[T]=w}return w}this.ensureCellAvailable=function(i,v,w){var x=null;var T=sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_UNKNOWN;var I=false;var y=false;var z=i.getAreaType()+"/"+v+"/"+w;if(!A[z]){var B=u(v,w,i);if(B){if(i.isRowHeaderArea()){T=this.getHeaderTileInfo(i,B.iRow).iStatus;I=true}else if(i.isColHeaderArea()){T=this.getHeaderTileInfo(i,B.iCol).iStatus;I=true}x=this.getPage(B);if(I){if(T===sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_UNKNOWN){y=true}}else{y=!x}if(y){x=this.createPage(B);x.provideLoadingCells(i);if(!r){r=new sap.zen.crosstab.paging.RequestHandler(this)}r.sendPageRequest(x)}else{if((x&&x.getStatus()===sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADED)||T&&T===sap.zen.crosstab.paging.PagingConstants.PAGE_STATUS_LOADED){A[z]=true}}}}};this.reset=function(){p={};h={};H=false;if(r){r.reset()}n=true;o={};A={};P=0;a=0};this.getDataHandler=function(){return j};this.getTileRowCnt=function(){return P};this.getTileColCnt=function(){return a};this.getPageKeyFromPos=function(i){return this.getPageKeyFromRowCol(i.iRow,i.iCol)};this.getPageKeyFromRowCol=function(i,v){return i+"/"+v};this.getPagePosFromKey=function(K){var i={};var v=K.split("/");i.iRow=parseInt(v[0],10);i.iCol=parseInt(v[1],10);return i};this.getCrosstab=function(){return c};this.createPage=function(i){var v=null;var w=this.getPageKeyFromPos(i);if(w){v=new sap.zen.crosstab.paging.Page(i,w,this);p[w]=v}return v};this.getPage=function(i){return this.getPageFromRowCol(i.iRow,i.iCol)};this.getPageFromRowCol=function(i,v){var w=null;var x=this.getPageKeyFromRowCol(i,v);if(x){w=p[x]}return w};this.getCellMerger=function(){return C};function s(){return(b===0&&d===0)||!H}function t(J){P=J.tilerows;a=J.tilecols;R=J.scrollaction;b=J.v_pos;if(b){b=Math.floor(b/P)}else{b=0}d=J.h_pos;if(d){d=Math.floor(d/a)}else{d=0}}function u(i,v,w){var x={iRow:0,iCol:0};if(w.isRowHeaderArea()){x.iRow=Math.floor(i/P);x.iCol=Math.floor(c.getColumnHeaderArea().getRenderStartCol()/a)}else if(w.isColHeaderArea()){x.iRow=Math.floor(c.getRowHeaderArea().getRenderStartRow()/P);x.iCol=Math.floor(v/a)}else if(w.isDataArea()){x.iRow=Math.floor(i/P);x.iCol=Math.floor(v/a)}return x}this.getReceivedPages=function(){return JSON.stringify(o)}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.rendering.CrossRequestManager')){jQuery.sap.declare("sap.zen.crosstab.rendering.CrossRequestManager");sap.zen.crosstab.rendering.CrossRequestManager=function(c,r){"use strict";var s=null;var h=null;var H=0;var a="";var v=0;var V="";var b=false;var C=null;var d=null;var D=null;var R=null;var e=false;var f="";var g="";var t=0;var T=0;var i=0;var j=0;var A=false;var k=false;var l=false;var m=undefined;var n=undefined;var o=null;var p=c.getDataArea();var q=c.getRowHeaderArea();var u=c.getColumnHeaderArea();var w=c.getDimensionHeaderArea();this.reset=function(){if(s){s.destroy()}s=null;if(h){h.destroy()}h=null};this.clearSavedData=function(){s=null;h=null;H=0;a="";v=0;V="";b=false;C=null;d=null;D=null;R=null;e=false;f="";g="";t=0;T=0;o=null};this.saveTableDimensions=function(){if(c.getPropertyBag().isPixelScrolling()){var B=$('#'+c.getId()+"_dataArea");i=B.outerHeight();j=B.outerWidth()}t=c.getTotalRows();T=c.getTotalCols()};function x(B){if(g==="expanded"){return(B<0)}else if(g==="collapsed"){return(B>0)}else{return false}}this.handleRootCause=function(){var O=v;var B=H;var E=m;var F=n;if(f==="plan"){if(a!=="plan"&&V!=="plan"){this.clearSavedData()}}else if(f==="sorting"){if(a!=="sort"){this.clearSavedData()}else{var S=c.getSelectedCellData();if(S&&S.sAreaType===sap.zen.crosstab.rendering.RenderingConstants.TYPE_ROW_HEADER_AREA){v=Math.max(0,(S.iRow-1));r.setDeferredVScrollPosDetermination(c.getPropertyBag().isPixelScrolling())}else{v=0;n=false}}}else if(f==="hierarchy"){if(a==="hier"&&V==="hier"){var G=t-c.getTotalRows();var I=T-c.getTotalCols();if(G!==0){if(x(G)){if(!e){if(c.getPropertyBag().isPixelScrolling()){k=true}else{v=Math.max(0,v-G)}}}else{this.clearSavedData()}}else if(I!==0){if(x(I)){if(!e){if(c.getPropertyBag().isPixelScrolling()){A=true}else{H=Math.max(0,H-I)}}}else{this.clearSavedData()}}}else{this.clearSavedData()}}e=false;f="";g="";t=0;T=0;if(B!==H||O!==v||E!==m||F!==n){c.getUtils().sendScrollPosUpdate(H,m,v,n)}l=true};this.getHPixelScrollPosAfterRendering=function(){var P=-1;if(c.getPropertyBag().isPixelScrolling()){var B=$('#'+c.getId()+"_dataArea");if(A){var E=B.outerWidth()-j;P=H+E;A=false}}return P};this.getVPixelScrollPosAfterRendering=function(){var P=-1;if(c.getPropertyBag().isPixelScrolling()){var B=$('#'+c.getId()+"_dataArea");if(k){var E=B.outerHeight()-i;P=v+E;k=false}}return P};this.setRootCause=function(B){f=B};this.setHierarchyAction=function(B){g=B};this.setIsHierarchyDirectionDown=function(I){e=I};this.getScrollManager=function(){if(!s){if(c.getPropertyBag().isPixelScrolling()){s=new sap.zen.crosstab.rendering.PixelScrollManager(c,r)}else{s=new sap.zen.crosstab.rendering.ScrollManager(c,r)}if(b){if(a){s.setHScrollPos(H)}if(V){s.setVScrollPos(v)}}}return s};this.getHeaderScrollManager=function(){if(!h){h=new sap.zen.crosstab.rendering.HeaderScrollManager(c,r);if(b){h.setHScrollData(o)}}return h};this.saveHScrollInfo=function(B,E){if(c.getPropertyBag().isPixelScrolling()){var F=$('#'+c.getId()+"_lowerRight_scrollDiv");H=0;if(F&&F.length>0){H=F.scrollLeft()}}else{H=c.getColumnHeaderArea().getRenderStartCol();if(s&&s.isHScrolledToEnd()){H++;m=true}}if(E){v=0}a=B;b=true};this.saveVScrollInfo=function(B,E){if(c.getPropertyBag().isPixelScrolling()){var F=$('#'+c.getId()+"_lowerRight_scrollDiv");v=0;if(F&&F.length>0){v=F.scrollTop()}}else{v=c.getRowHeaderArea().getRenderStartRow();if(s&&s.isVScrolledToEnd()){v++;n=true}}if(E){H=0}V=B;b=true};this.saveSDKVScrollInfo=function(B,E){v=B;b=true;V=E};this.saveSDKHScrollInfo=function(B,E){H=B;b=true;a=E};this.savedInfoHandled=function(){if(l===true){H=0;a="";v=0;V="";b=false;C=null;d=null;D=null;R=null;l=false;m=undefined;n=undefined;o=null}};this.hasSavedInfo=function(){return b};this.getSavedHScrollInfo=function(){var B=null;if(a){B={};B.iPos=H;B.sAction=a;B.bScrolledToEnd=m}return B};this.getSavedVScrollInfo=function(){var B=null;if(V){B={};B.iPos=v;B.sAction=V;B.bScrolledToEnd=n}return B};this.saveColWidths=function(){var u=c.getColumnHeaderArea();var w=c.getDimensionHeaderArea();var q=c.getRowHeaderArea();var p=c.getDataArea();if(!u.hasLoadingPages()){C=u.getColWidths();b=true}if(!p.hasLoadingPages()){D=p.getColWidths();b=true}if(!w.hasLoadingPages()){d=w.getColWidths();b=true}if(!q.hasLoadingPages()){R=q.getColWidths();b=true}};this.restoreColWidths=function(){var u=c.getColumnHeaderArea();var w=c.getDimensionHeaderArea();var q=c.getRowHeaderArea();var p=c.getDataArea();if(C){u.setColWidths(C);C=null}if(D){p.setColWidths(D);D=null}if(d){w.setColWidths(d);d=null}if(R){q.setColWidths(R);R=null}};function y(B,E,F,G){var I={iHScrollPos:B,bHScrolledToEnd:E,iVScrollPos:F,bVScrolledToEnd:G};if(I.iHScrollPos<0){I.iHScrollPos=0;I.bHScrolledToEnd=false}if(I.iVScrollPos<0){I.iVScrollPos=0;I.bVScrolledToEnd=false}var J=p?p:u;var L=J.getColCnt()-1;if(I.iHScrollPos>L){I.iHScrollPos=0;I.bHScrolledToEnd=false}J=p?p:q;var K=J.getRowCnt()-1;if(I.iVScrollPos>K){I.iVScrollPos=0;I.bVScrolledToEnd=false}if((I.iHScrollPos!==B)||(I.iVScrollPos!==F)){c.getUtils().sendScrollPosUpdate(0,false,0,false)}return I}this.setScrollData=function(B,E,F,G){var I=y(B,E,F,G);H=I.iHScrollPos;v=I.iVScrollPos;m=I.bHScrolledToEnd;n=I.bVScrolledToEnd;b=true;a="GEN";V="GEN"};function z(B){var E=B;if(E.iHPos<0){E.iHPos=0}if(E.iHPos!==B.iHPos){c.getUtils().sendScrollPosUpdate(E.iHPos,undefined,undefined,undefined,true)}return E}this.setHeaderScrollData=function(B){var E=z(B);b=true;o=E};this.getHeaderScrollData=function(){return o}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.rendering.RenderEngine')){jQuery.sap.declare("sap.zen.crosstab.rendering.RenderEngine");sap.zen.crosstab.rendering.RenderEngine=function(c){"use strict";var C=c.getColumnHeaderArea();var d=c.getDimensionHeaderArea();var r=c.getRowHeaderArea();var D=c.getDataArea();var R=null;var s=null;var o=null;var t=null;var a=null;var l="";var I=false;var n=[];var b=new sap.zen.crosstab.rendering.DomElementProvider();var m=new sap.zen.crosstab.utils.Measuring(c,b);var e=new sap.zen.crosstab.rendering.CrossRequestManager(c,this);var S=null;var h=null;var f=false;var g=false;var k={bHasHScrollbar:false,bHasVScrollbar:false,bHasHHeaderScrollbar:false};var A=[];var p=true;var q=false;var u=-1;this.isIE8Mode=function(){return f};this.renderResizeOutline=function(){if((c.getWidth()==="auto"&&c.hResize())||(c.getHeight()==="auto"&&c.vResize())){var i=c.getId();var j=i+"_resizeDiv";var j1=i+"_resizeFrame";var k1=0;var l1=0;t=b.getElement(i);if(t&&t[0]){t.css("overflow","hidden");var m1=m.getTableDivBordersAndPadding();k1=m1.borders.iTopBorderWidth;l1=m1.borders.iLeftBorderWidth;o=jQuery.sap.byId(j);o.css("visibility","visible");o.css("top",-k1+"px");o.css("left",-l1+"px");a=jQuery.sap.byId(j1);a.css("width",c.getIntWidth()+"px");a.css("height",c.getIntHeight()+"px");a.css("top",-k1+"px");a.css("left",-l1+"px");a.css("visibility","visible");var n1=t.find("#"+c.getId()+"_hScrollTab");if(n1&&n1.length>0){n1.appendTo(a);n1.css("position","absolute");var o1=c.getPropertyBag().getToolbarHeight();n1.css("bottom",o1+"px");n1.css("left","0px")}var p1=t.find("#"+c.getId()+"_vScrollTab");if(p1&&p1.length>0){p1.appendTo(a);p1.css("position","absolute");p1.css("top","0px");p1.css("right","0px")}if(c.getPropertyBag().hasToolbar()){var q1=t.find("#"+c.getId()+"_toolbar");if(q1&&q1.length>0){q1.appendTo(a);q1.css("position","absolute");q1.css("left","0px");q1.css("bottom","0px")}}}}};this.removeResizeOutline=function(){if(o){o.css("visibility","hidden");o=null}if(t){t.css("overflow","hidden");t=null}if(a){a.css("visibility","hidden");a=null}};this.addAfterFinishRenderingHandler=function(i){if($.inArray(i,A)===-1){A.push(i)}};this.removeAfterFinishRenderingHandler=function(i){var j=$.inArray(i,A);if(j!==-1){A.splice(j,1)}};this.removeAllAfterFinishRenderingHandlers=function(){A=[]};this.renderCell=function(i,j,j1){var k1=i.getCell(j,j1);if(k1){R.renderControl(k1)}return k1};this.renderArea=function(i,j,j1,k1,l1,m1){if(!j){j=0}if(!j1){j1=0}if(!k1){k1=0}if(!l1){l1=0}var n1=j+j1;var o1=k1+l1;var p1=0;var q1=0;for(p1=j;p1<n1;p1++){if(m1){R.write("<tr");R.writeAttribute("class",m1);R.write(">")}else{R.write("<tr>")}for(q1=k1;q1<o1;q1++){this.renderCell(i,p1,q1)}R.write("</tr>")}};this.setDeferredVScrollPosDetermination=function(i){g=i};function v(){f=false;if($.browser.msie){if($.browser.version.substring(0,2)==="8."){f=true}if($.browser.fVersion&&$.browser.fVersion===8){f=true}}}this.beginRendering=function(){v();R=sap.ui.getCore().createRenderManager();d1();t=b.getElement(c.getId());if(!c.getPropertyBag().isDebugMode()){t.css("visibility","hidden")}if(e.hasSavedInfo()){var i=e.getSavedHScrollInfo();if(i){C.setRenderStartCol(i.iPos);e.restoreColWidths()}var j=e.getSavedVScrollInfo();if(j){r.setRenderStartRow(j.iPos)}}};this.finishRendering=function(){this.showLoadingVisualization();var i=0;var j=null;if(R){R.destroy()}R=null;m.reset();c.highlightCells();c.restoreSelection();t=b.getElement(c.getId());t.css("visibility","visible");e.savedInfoHandled();c.restoreFocusOnCell();this.setDivSizeValidity();for(i=0;i<A.length;i++){j=A[i];if(j){j()}}};this.renderDimensionHeaderArea=function(){var i=0;var j=d.getRowCnt();var j1=0;var k1=d.getColCnt();this.renderArea(d,i,j,j1,k1,"sapzencrosstab-HeaderRow");d.setRenderSize(i,j,j1,k1);R.flush(b.getElement(d.getId())[0])};this.renderDataArea=function(){var i=0;var j=0;var j1=0;var k1=0;if(r.hasContent()){i=r.getRenderStartRow();j=r.getRenderRowCnt()}else{i=0;j=D.getRowCnt()}if(C.hasContent()){j1=C.getRenderStartCol();k1=C.getRenderColCnt()}else{j1=0;k1=D.getColCnt()}var l1=w(i,j,j1,k1);var m1=x(i,j,j1,k1);if(l1){y(l1);B(l1,i,j,j1,k1,this)}else if(m1){z(m1);E(m1,i,j,j1,k1,this);R.flush(b.getElement(D.getId())[0])}else{this.renderArea(D,i,j,j1,k1);R.flush(b.getElement(D.getId())[0])}D.setRenderSize(i,j,j1,k1)};function w(i,j,j1,k1){if(j1!==D.getRenderStartCol()||k1!==D.getRenderColCnt()||j!==D.getRenderRowCnt()){return 0}var l1=D.getRenderStartRow()+D.getRenderRowCnt();var m1=i+j;var n1=m1-l1;if(Math.abs(n1)<j){return n1}else{return 0}return 0}function x(i,j,j1,k1){if(i!==D.getRenderStartRow()||j!==D.getRenderRowCnt()||k1!==D.getRenderColCnt()){return 0}var l1=D.getRenderStartCol()+D.getRenderColCnt();var m1=j1+k1;var n1=m1-l1;if(Math.abs(n1)<k1){return n1}else{return 0}return 0}function y(j){var j1=$('#'+D.getId());var k1=j1.clone();var l1=$(k1[0].firstChild);var m1=l1.find('> tr');if(j>0){for(var i=0;i<j;i++){$(m1[i]).remove()}}else{var n1=m1.length;for(var i=n1+j;i<n1;i++){$(m1[i]).remove()}}j1.replaceWith(k1);b.addElement(D.getId(),$("#"+D.getId()))}function z(j1){var k1=$('#'+D.getId());var l1=k1.clone();var m1=$(l1[0].firstChild);var n1=m1.find('> tr');var o1=n1.length;if(j1>0){for(var i=0;i<o1;i++){var p1=$(n1[i]).find("> td");for(var j=0;j<j1;j++){$(p1[j]).remove()}}}else{for(var i=0;i<o1;i++){var p1=$(n1[i]).find("> td");var q1=p1.length-Math.abs(j1)-1;for(var j=p1.length-1;j>q1;j--){$(p1[j]).remove()}}}k1.replaceWith(l1);b.addElement(D.getId(),$("#"+D.getId()))}function B(i,j,j1,k1,l1,m1){var n1=$($('#'+D.getId())[0].firstChild);var o1=n1.html();var p1=Math.abs(i);var q1;if(i>0){R.write(o1);q1=j1+j-i;m1.renderArea(D,q1,p1,k1,l1)}else{q1=j;m1.renderArea(D,q1,p1,k1,l1);R.write(o1)}R.flush(n1[0])}function E(j,j1,k1,l1,m1,n1){var o1=$($('#'+D.getId())[0].firstChild);var p1;var q1=o1.find("> tr");if(j>0){p1=l1+m1-j;for(var i=0;i<q1.length;i++){var r1=$(q1[i]);var s1=r1.html();R.write("<tr>");R.write(s1);for(var t1=p1;t1<l1+m1;t1++){R.renderControl(D.getCell(j1+i,t1))}R.write("</tr>")}}else{p1=l1;for(var i=0;i<q1.length;i++){var r1=$(q1[i]);var s1=r1.html();R.write("<tr>");for(var t1=p1;t1<p1-j;t1++){R.renderControl(D.getCell(j1+i,t1))}R.write(s1);R.write("</tr>")}}}this.renderColHeaderArea=function(i){var j="";var j1=0;var k1=0;var l1=b.getElement(C.getId());var m1=m.getAreaWidth(d);var n1=0;var o1=c.getContentWidth()-m1;var p1=C.getColCnt();var q1=0;var r1=0;var s1,t1;var u1,v1;var w1;var x1=C.getRowCnt();var y1=0;var z1=j1;var A1;var B1=c.getId()+"_ColHeaderRow_";var C1=null;if(!c.getPropertyBag().isDebugMode()){l1.hide()}l1.html("");var D1=false;if(c.getPropertyBag().isPixelScrolling()){C1=K;j1=0;q1=p1}else{C1=J;j1=i;q1=p1-j1;D1=this.isHScrolledToEnd()}while(C1(k1,q1,r1,o1,D1)){j=l1[0].innerHTML;if(!j){G(l1)}z1=j1+k1;y1=0;t1=C.getFinalColWidth(z1);if(!t1){y1++}while(C1(k1,q1,r1,o1,D1)&&t1){k1++;r1+=t1;t1=C.getFinalColWidth(j1+k1);y1++}A1=z1+y1;for(s1=0;s1<x1;s1++){u1=B1+s1;w1=l1.find("#"+u1)[0];v1=w1.innerHTML;R.write("<tr id=\""+u1+"\" class=\"sapzencrosstab-HeaderRow\">");R.write(v1);for(var E1=z1;E1<A1;E1++){var F1=null;if(E1===j1){F1=C.getCellWithColSpan(s1,E1)}else{F1=C.getCell(s1,E1)}if(F1){R.renderControl(F1)}}R.write("</tr>")}R.flush(l1[0]);if(!C.getFinalColWidth(z1)){var G1=l1.outerWidth()-n1;r1+=G1;k1++}n1=l1.outerWidth()}C.setRenderSize(0,C.getRowCnt(),j1,k1);l1.show()};function F(){return(C.getRenderStartCol()>0)}this.appendColumnsAfterResize=function(){var i=b.getElement(C.getId());var j=0;var j1=0;var k1=0;if(C.getRenderStartCol()>0&&C.getRenderStartCol()+C.getRenderColCnt()===C.getColCnt()){var l1=c.getContentWidth()-m.getAreaWidth(d);var m1=i.outerWidth();j=m1;var n1=false;if(!c.getPropertyBag().isDebugMode()){i.hide()}while(m1<=l1&&C.getRenderStartCol()>0){this.appendLeftCols(C,1);this.appendLeftCols(D,1);n1=true;k1=C.getFinalColWidth(C.getRenderStartCol());if(k1){m1+=k1}else{j1=i.outerWidth()-j;m1+=j1}j=i.outerWidth()}i.show();if(n1){this.adjustRowHeights(d,C);this.adjustRowHeights(r,D);this.adjustColWidths(C,D);m.calculateRenderSize(true);this.calculateRenderSizeDivSize();if(!S){S=e.getScrollManager()}S.commandHScrolledToEnd()}}i=b.getElement(C.getId())};function G(i){var j=C.getRowCnt();var j1=0;for(j1=0;j1<j;j1++){R.write("<tr");R.writeAttribute("class","sapzencrosstab-HeaderRow");R.writeAttribute("id",c.getId()+"_ColHeaderRow_"+j1);R.write(">");R.write("</tr>")}R.flush(i[0])}function H(i){var j=i+1;var j1=0;var k1=j1+r.getColCnt();var l1=0;var m1=0;for(l1=i;l1<j;l1++){R.write("<tr");R.writeAttribute("class","sapzencrosstab-HeaderRow");R.write(">");for(m1=j1;m1<k1;m1++){var n1=r.getCellWithRowSpan(l1,m1);if(n1){R.renderControl(n1)}}R.write("</tr>")}}this.isVScrolledToEnd=function(){var i=false;if(S){i=S.isVScrolledToEnd()}return i};this.isHScrolledToEnd=function(){var i=false;if(S){i=S.isHScrolledToEnd()}return i};function J(i,j,j1,k1,l1){return((j1<k1)||l1)&&i<j}function K(i,j){return i<j}this.renderRowHeaderArea=function(i){var j="";var j1=b.getElement(r.getId());var k1=0;var l1=m.getAreaHeight(d);var m1=l1;var n1=c.getContentHeight();var o1=r.getRowCnt();var p1=0;var q1=1;var r1='#'+r.getId();var s1=null;if(!c.getPropertyBag().isDebugMode()){j1.hide()}$($(r1)[0].firstChild).html("");var t1=false;if(c.getPropertyBag().isPixelScrolling()){s1=K;i=0;p1=o1}else{s1=J;p1=o1-i;t1=this.isVScrolledToEnd()}while(s1(k1,p1,m1,n1,t1)){j=$($(r1)[0].firstChild).html()||"";R.write(j);q1=1;if(k1>0){if(c.getPropertyBag().isPixelScrolling()){q1=p1-k1}else{if(k1<p1-2){q1=3}else if(k1<p1-1){q1=2}}this.renderArea(r,i+k1,q1,0,r.getColCnt(),"sapzencrosstab-HeaderRow")}else{H(i)}R.flush(j1[0]);k1+=q1;m1=l1+j1.outerHeight()}j1.show();r.setRenderSize(i,k1,0,r.getColCnt());if(f){M(r)}};function L(r,i,j){var j1=1;var k1=r.getCell(i,j,true);if(!k1){while(!k1&&i>0){i--;j1++;k1=r.getCell(i,j,true)}}return j1}function M(r){var i=r.getRenderStartRow()+r.getRenderRowCnt()-1;var j=r.getRenderStartCol();var j1=j+r.getRenderColCnt()-1;var k1=0;var l1=null;var m1=1;for(k1=j;k1<=j1;k1++){l1=r.getCellWithRowSpan(i,k1);if(l1){m1=L(r,i,k1);l1.setHtmlIE8RowSpan(m1)}}}this.appendRowsAfterResize=function(){var i=b.getElement(r.getId());var j=0;var j1=0;var k1=0;if(r.getRenderStartRow()>0){var l1=c.getContentHeight()-m.getAreaHeight(d);var m1=i.outerHeight();j=m1;var n1=false;if(!c.getPropertyBag().isDebugMode()){i.hide()}while(m1<=l1&&r.getRenderStartRow()>0&&r.getRenderStartRow()+r.getRenderRowCnt()===r.getRowCnt()){this.appendTopRows(r,1);this.appendTopRows(D,1);n1=true;k1=r.getFinalRowHeight(r.getRenderStartRow());if(k1){m1+=k1}else{j1=i.outerHeight()-j;m1+=j1}j=i.outerHeight()}i.show();if(n1){this.adjustRowHeights(r,D);this.adjustColWidths(d,r);this.adjustColWidths(C,D);m.calculateRenderSize(true);this.calculateRenderSizeDivSize();if(!S){S=e.getScrollManager()}S.commandVScrolledToEnd()}}i=b.getElement(r.getId())};this.setUserColWidths=function(i){if(!i.hasContent()||!i.hasUserColWidths()){return}i.calculateColGranularity();var j=i.measureColGranularityCells();i.applyColWidthsToGranularityCells(j);var j1=b.getElement(i.getId());var k1=j1.clone();Q(i,j1,k1,true);j1.replaceWith(k1);j1=$("#"+i.getId());T(i,j1,true);b.addElement(i.getId(),$("#"+i.getId()));i.setColGranularityCalculatedAndMeasured(true)};this.adjustColWidths=function(j,j1){if(!j1.hasContent()||!j.hasContent()){if(!j.hasUserColWidths()&&!j1.hasUserColWidths()){return}}var k1=b.getElement(j.getId());var l1=b.getElement(j1.getId());j.calculateColGranularity();j1.calculateColGranularity();var m1=j.measureColGranularityCells();var n1=j1.measureColGranularityCells();j.setColGranularityCalculatedAndMeasured(false);j1.setColGranularityCalculatedAndMeasured(false);var i=0;var o1;for(i=j.getRenderStartCol();i<m1.length;i++){o1=Math.max(m1[i]||0,n1[i]||0);m1[i]=o1;n1[i]=o1}j.applyColWidthsToGranularityCells(m1,j.hasUserColWidths());j1.applyColWidthsToGranularityCells(n1,j1.hasUserColWidths());var p1=k1.clone();var q1=l1.clone();Q(j,k1,p1);Q(j1,l1,q1);k1.replaceWith(p1);l1.replaceWith(q1);k1=$("#"+j.getId());l1=$("#"+j1.getId());T(j,k1);T(j1,l1);if(j1.isRowHeaderArea()&&c.getNewLinesCnt()>0&&c.getCallValueHelpCommand()){O()}b.addElement(j.getId(),$("#"+j.getId()));b.addElement(j1.getId(),$("#"+j1.getId()))};function N(i,j){var j1=null;var k1=null;var l1=null;var m1=null;var n1=0;var o1=null;var p1=r.getColGranularity();var q1=0;var r1=p1[n1].iWidth;var s1=0;var t1=0;var u1=0;var v1=0;var w1=0;var x1=null;var y1=0;for(n1=0;n1<j;n1++){o1=r.getCell(i,n1);if(o1&&o1.isEntryEnabled()){k1=$('#'+o1.getId());j1=$('#'+o1.getId()+"_cellLayoutDiv");m1=sap.zen.crosstab.utils.Utils.getWidthFromStyle(j1);if(p1&&p1.length>0){r1=p1[n1].iWidth;s1=parseInt(k1.css("padding-left"))||0;t1=parseInt(k1.css("padding-right"))||0;u1=parseInt(k1.css("border-left-width"))||0;v1=parseInt(k1.css("border-right-width"))||0;q1=r1-s1-t1-u1-v1;j1.css("width",q1+"px");w1=$(j1.find("td")[1]).outerWidth();x1=$(j1.find("td")[0]);s1=parseInt(x1.css("padding-left"))||0;t1=parseInt(x1.css("padding-right"))||0;l1=x1.find("#"+o1.getId()+"_contentDiv");y1=q1-s1-t1-w1;l1.css("width",y1+"px")}}}}function O(){var j=r.getRenderColCnt();var j1=r.getRenderRowCnt();var k1=r.getRenderStartRow();var l1=r.getRowCnt();var m1=c.getNewLinesCnt();var n1=0;var i=0;if(c.isNewLinesTop()){if(k1<m1){for(n1=k1;n1<m1;n1++){N(n1,j)}}}else if(c.isNewLinesBottom()){var o1=(k1+j1)-(l1-m1);if(o1>0){var p1=k1+j1-1;for(i=0;i<o1;i++){N(p1,j);p1--}}}}this.adjustRowHeights=function(j,j1){if(!j1.hasContent()||!j.hasContent()){return}var k1=b.getElement(j.getId());var l1=b.getElement(j1.getId());j.calculateRowGranularity();j1.calculateRowGranularity();var m1=j.measureRowGranularityCells();var n1=j1.measureRowGranularityCells();var i=0;var o1;for(i=j.getRenderStartRow();i<m1.length;i++){o1=Math.max(m1[i]||0,n1[i]||0);m1[i]=o1;n1[i]=o1}var p1=j1.isColHeaderArea()?j1.getLevelCells():null;j.applyRowHeightsToGranularityCells(m1,p1);j1.applyRowHeightsToGranularityCells(n1,p1);var q1=k1.clone();var r1=l1.clone();U(j,k1,q1);U(j1,l1,r1);k1.replaceWith(q1);l1.replaceWith(r1);k1=$("#"+j.getId());l1=$("#"+j1.getId());V(j,k1);V(j1,l1);if($.browser.msie){P(j);P(j1)}b.addElement(j.getId(),$("#"+j.getId()));b.addElement(j1.getId(),$("#"+j1.getId()))};function P(i){var j=i.getCellsWithLineBreakTexts();var j1=0;var k1=0;var l1=0;var m1=0;var n1=0;var o1=0;var p1=null;var q1=null;if(j){l1=i.getRenderStartRow();m1=l1+i.getRenderRowCnt()-1;n1=i.getRenderStartCol();o1=n1+i.getRenderColCnt()-1;for(j1=l1;j1<=m1;j1++){for(k1=n1;k1<=o1;k1++){p1=i.getCell(j1,k1);if(p1){p1=j[p1.getId()];if(p1){q1=$('#'+p1.getId()+"_contentDiv");if(q1&&q1.length>0){q1.css("height",q1.outerHeight()+"px")}}}}}}}function Q(j,j1,k1,l1){var i=0;var m1=j.getColGranularity();var n1=null;var o1=null;var p1=null;var q1=null;var r1=0;for(i=0;i<m1.length;i++){n1=m1[i];if(n1){if(l1===true){if(!j.isFixedColWidthSet(n1.iCol)){continue}}o1=j1.find("#"+n1.sId);p1=k1.find("#"+n1.sId);r1=Z(o1,n1.iWidth,j.getCell(n1.iRow,n1.iCol));var s1=sap.ui.getCore().getControl(n1.sId);if(s1.isEntryEnabled()&&j.isRowHeaderArea()){q1=$(p1.find("#"+n1.sId+"_cellLayoutDiv"))}else{q1=$(p1.find("#"+n1.sId+"_contentDiv"))}q1.width(r1)}}}function T(j,j1,k1){var i=0;var l1=j.getColGranularity();var m1=null;var n1=null;var o1=null;var p1=0;var q1={};for(i=0;i<l1.length;i++){m1=l1[i];if(m1){if(k1===true){if(!j.isFixedColWidthSet(m1.iCol)){continue}}n1=j1.find("#"+m1.sId);p1=n1.outerWidth();if(p1>m1.iWidth){if(!o1){o1=j1.clone()}Y(j,j1,o1,m1,q1)}}}if(o1){j1.replaceWith(o1)}}function U(j,j1,k1){var i=0;var l1=j.getRowGranularity();var m1=null;var n1=null;var o1=null;var p1=null;var q1=0;for(i=0;i<l1.length;i++){m1=l1[i];if(m1){n1=j1.find("#"+m1.sId);o1=k1.find("#"+m1.sId);p1=o1.parent();q1=_(n1,m1.iHeight);p1.height(q1)}}}function V(j,j1){var i=0;var k1=j.getRowGranularity();var l1=null;var m1=null;var n1=0;var o1=null;var p1={};for(i=0;i<k1.length;i++){l1=k1[i];if(l1){m1=j1.find("#"+l1.sId);var q1=m1.parent();n1=q1.outerHeight();if(n1>l1.iHeight){if(!o1){o1=j1.clone()}X(j,j1,o1,l1,p1)}}}if(o1){j1.replaceWith(o1)}}function W(i,j){var j1=0;if(f){var k1=i.find("table");if(k1===null||k1.length===0){j1=a1(i,j)}}else{j1=a1(i,j)}return j1}function X(j,j1,k1,l1,m1){var n1=j.getRenderStartCol()+j.getRenderColCnt();var o1=0;var p1=null;var q1=0;var i=0;var r1=j.getCalculatedRowHeights();var s1=null;var t1=null;var u1=null;var v1=0;var w1=0;for(o1=j.getRenderStartCol();o1<n1;o1++){p1=j.getCellWithColSpan(l1.iRow,o1);if(!p1&&o1<l1.iCol){p1=j.getCellWithRowSpan(l1.iRow,o1);if(p1){if(!m1[p1.getId()]){m1[p1.getId()]=p1}else{p1=null}}}if(p1){t1=j1.find("#"+p1.getId());u1=k1.find("#"+p1.getId());if(t1.length>0){q1=0;w1=f?p1.getHtmlIE8RowSpan():p1.getEffectiveRowSpan();for(i=0;i<w1;i++){q1+=r1[l1.iRow+i]||0}v1=W(t1,q1);s1=$(u1.find("#"+p1.getId()+"_contentDiv"));s1.css("line-height",v1+"px")}}}}function Y(j,j1,k1,l1,m1){var n1=0;var o1=null;var p1=null;var q1=null;var r1=null;var s1=0;var t1=0;var i=0;var u1=j.getCalculatedColWidths();var v1;var w1=j.getRenderStartRow()+j.getRenderRowCnt();for(n1=j.getRenderStartRow();n1<w1;n1++){o1=j.getCellWithRowSpan(n1,l1.iCol);if(!o1&&n1<l1.iRow){o1=j.getCellWithColSpan(n1,l1.iCol);if(o1){if(!m1[o1.getId()]){m1[o1.getId()]=o1}else{o1=null}}}if(o1){p1=j1.find("#"+o1.getId());q1=k1.find("#"+o1.getId());if(p1.length>0){t1=0;v1=o1.getEffectiveColSpan();for(i=0;i<v1;i++){t1+=u1[l1.iCol+i]||0}s1=Z(p1,t1,o1);if(o1.isEntryEnabled()&&j.isRowHeaderArea()){r1=$(q1.find("#"+o1.sId+"_cellLayoutDiv"))}else{r1=$(q1.find("#"+o1.getId()+"_contentDiv"))}r1.width(s1)}}}}function Z(i,j,j1){var k1=parseInt(i.css("padding-left"))||0;var l1=parseInt(i.css("padding-right"))||0;var m1=parseInt(i.css("border-left-width"))||0;var n1=parseInt(i.css("border-right-width"))||0;var o1=0;var p1=0;if(j1!==null&&j1.isEntryEnabled()){if(j1.isEntryEnabled()&&j1.getArea().isRowHeaderArea()){var q1=$(i.find("#"+j1.getId()+"_cellLayoutDiv"))}else{var q1=i.find('#'+j1.getId()+"_contentDiv")}o1=parseInt(q1.css("border-left-width"))||0;p1=parseInt(q1.css("border-right-width"))||0}var r1=Math.max(1,j-k1-l1-m1-n1-o1-p1);return r1}function _(i,j){var j1=$(i).parent();var k1=parseInt(j1.css("border-top-width"),10)||0;var l1=parseInt(j1.css("border-bottom-width"),10)||0;var m1=j+k1+l1;return m1}function a1(i,j){var j1=parseInt(i.css("padding-top"))||0;var k1=parseInt(i.css("padding-bottom"))||0;var l1=parseInt(i.css("border-top-width"))||0;var m1=parseInt(i.css("border-bottom-width"))||0;var n1=j-j1-k1-l1-m1;return n1}this.determineHeaderScrollbarVisible=function(){if(k){var i=0;var j=null;var j1=null;var k1=false;if(d.getColCnt()>0){i=m.getAreaSize(d).iWidth;j1=$('#'+c.getId()+"_dimHeaderArea_container");j=$('#'+c.getId()+"_upperLeft_scrollDiv")}if(i===0){if(r.getColCnt()>0){i=m.getAreaSize(r).iWidth;j1=$('#'+c.getId()+"_rowHeaderArea_container");j=$('#'+c.getId()+"_lowerLeft_scrollDiv")}}if(i>0){k1=(j1.outerWidth()>j.outerWidth())}k.bHasHHeaderScrollbar=k1}};this.determineScrollbarsVisible=function(){k={};var i=m.getAreaSize(d);var j=m.calculateRenderSize();var j1=m.getRenderSizeDivSize(c);var k1=c.getContentWidth();var l1=c.getContentHeight();var m1=m.getBrowserScrollbarWidth();var n1=null;var o1=D.getRenderColCnt()===D.getColCnt();var p1=D.getRenderRowCnt()===D.getRowCnt();k.bHasHScrollbar=((j.iWidth>k1||!o1)&&j1.iWidth>i.iWidth);k.bHasVScrollbar=((j.iHeight>l1||!p1)&&j1.iHeight>i.iHeight);if(k.bHasHScrollbar&&!k.bHasVScrollbar){n1=m.getRenderSizeDivBorders();if(l1<=j.iHeight+m1+n1.borders.iBottomBorderWidth+n1.borders.iTopBorderWidth){k.bHasVScrollbar=true}}else if(!k.bHasHScrollbar&&k.bHasVScrollbar){n1=m.getRenderSizeDivBorders();if(k1<=j.iWidth+m1+n1.borders.iRightBorderWidth+n1.borders.iLeftBorderWidth){k.bHasHScrollbar=true}}this.determineHeaderScrollbarVisible()};this.setAdjustFrameDivs=function(i){p=i};this.removeOuterDivBorders=function(){var i=$(jQuery.sap.byId(c.getId()+"_renderSizeDiv"));i.css("border-bottom-width","");i.css("border-top-width","");i.css("border-left-width","");i.css("border-right-width","")};this.setDivSizeValidity=function(){q=!c.getRowHeaderArea().hasLoadingPages()&&!c.getColumnHeaderArea().hasLoadingPages()};this.calculateRenderSizeDivSize=function(){if(p||!q){var i=m.calculateRenderSize(true);var j=$(jQuery.sap.byId(c.getId()+"_renderSizeDiv"));var j1=m.getRenderSizeDivBorders(j);if(u!==-1){j1.borders.iBottomBorderWidth=u}var k1=c.getContentWidth()-j1.borders.iLeftBorderWidth-j1.borders.iRightBorderWidth;var l1=i.iWidth;j.width(Math.min(k1,l1)+"px");var m1=c.getContentHeight()-j1.borders.iBottomBorderWidth-j1.borders.iTopBorderWidth;var n1=i.iHeight;j.height(Math.min(m1,n1)+"px")}};this.adjustRenderSizeDivSize=function(){if(p||!q){var i=$(jQuery.sap.byId(c.getId()+"_renderSizeDiv"));var j=m.getRenderSizeDivBorders(i);if(u!==-1){j.borders.iBottomBorderWidth=u}var j1=m.getRenderSizeDivSize().iHeight;if(u!==-1){j1+=u}var k1=m.getRenderSizeDivSize().iWidth;var l1=c.getContentHeight();if(k.bHasHScrollbar||k.bHasHHeaderScrollbar){l1-=m.getBrowserScrollbarWidth()}if(c.getRenderMode()===sap.zen.crosstab.rendering.RenderingConstants.RENDERMODE_COMPACT){var m1=(k.bHasHScrollbar||k.bHasHHeaderScrollbar)?m.getBrowserScrollbarWidth():0;var n1=c.getPropertyBag().getToolbarHeight();var o1=j1+m1+j.borders.iBottomBorderWidth+j.borders.iTopBorderWidth+n1;var p1=l1+m1+n1;if(p1>=o1){l1=o1;var t=b.getElement(c.getId());t.css("height",l1+"px");if(u===-1){u=parseInt(i.css("border-bottom-width"),10)}i.css("border-bottom-width","0px")}}if(j1>=l1){if(u===-1){u=parseInt(i.css("border-bottom-width"),10)}i.css("border-bottom-width","0px")}var q1=Math.min(j1,l1);i.css("height",q1);var r1=c.getContentWidth();if(k.bHasVScrollbar){r1-=m.getBrowserScrollbarWidth()}if(c.getRenderMode()===sap.zen.crosstab.rendering.RenderingConstants.RENDERMODE_COMPACT){var s1=k.bHasVScrollbar?m.getBrowserScrollbarWidth():0;var t1=k1+s1+j.borders.iLeftBorderWidth+j.borders.iRightBorderWidth;var u1=r1+s1;if(u1>=t1){r1=t1;var t=b.getElement(c.getId());t.css("width",r1+"px");i.css("border-right-width","0px")}}if(k1>=r1){i.css("border-right-width","0px")}var v1=Math.min(k1,r1);i.css("width",v1)}};this.renderScrollbars=function(){this.determineScrollbarsVisible();if(k.bHasHScrollbar||k.bHasVScrollbar||k.bHasHHeaderScrollbar){if(!S){S=e.getScrollManager()}if(k.bHasHHeaderScrollbar){h=e.getHeaderScrollManager()}if(s){s.destroy();s=null}s=new sap.zen.crosstab.rendering.ScrollbarRenderer(c,R,m,b);s.renderScrollbars(k);s.attachHandlers(S.hScrollHandler,S.vScrollHandler,k.bHasHHeaderScrollbar?h.hScrollHandler:null);b1()}else{S=null}};function b1(){var i=0;for(i=0;i<n.length;i++){n[i]()}}this.setScrollbarSteps=function(){if(s){s.setScrollbarSteps()}};this.adjustScrollDivSizes=function(){var i=jQuery.sap.byId(c.getId()+"_lowerLeft");var j=i.outerWidth();var j1=m.getRenderSizeDivSize();var k1=(j1.iWidth-j)+"px";var l1=jQuery.sap.byId(c.getId()+"_lowerRight_scrollDiv");l1.width(k1);var m1=jQuery.sap.byId(c.getId()+"_upperRight_scrollDiv");m1.width(k1);var n1=jQuery.sap.byId(c.getId()+"_upperLeft");var o1=n1.outerHeight();if(!o1){var p1=jQuery.sap.byId(c.getId()+"_upperRight");o1=p1.outerHeight()}var q1=(j1.iHeight-o1)+"px";l1.height(q1);var r1=jQuery.sap.byId(c.getId()+"_lowerLeft_scrollDiv");r1.height(q1)};this.appendLeftCols=function(i,j){var j1=Math.max(0,i.getRenderStartCol()-j);var k1=Math.max(0,i.getRenderStartCol()-1);var l1=j;if(j1===k1){l1=1}var m1=i.getRenderStartRow();var n1=m1+i.getRenderRowCnt()-1;var o1=null;var p1=0;var q1=0;var r1=0;var s1=$('#'+i.getId());var t1=s1.children("tbody");if(t1.length===0){s1.append("<tbody></tbody>");t1=s1.children("tbody");for(r1=m1;r1<=n1;r1++){t1.append("<tr/>")}}var u1=t1.children("tr");for(r1=m1;r1<=n1;r1++){var v1=u1[p1];q1=0;for(var w1=j1;w1<=k1;w1++){if(q1===0){o1=i.getCellWithColSpan(r1,w1)}else{o1=i.getCell(r1,w1)}if(o1){var x1=o1.getColSpan();if(x1>1){var y1=o1.getEffectiveColSpan();var z1=Math.min(l1,(i.getRenderStartCol()-j1));var A1=y1-(z1-q1);if(A1>0){var B1=$(v1).find("> :first-child");B1.remove()}}R.renderControl(o1)}q1++}var C1=$($(u1[p1])).html();R.write(C1);R.flush(v1);p1++}var D1=i.getRenderColCnt();var E1=k1-j1+1;i.setRenderColCnt(D1+E1);i.setRenderStartCol(j1)};this.appendTopRows=function(j1,k1){var l1=Math.max(0,j1.getRenderStartRow()-k1);var m1=Math.max(0,j1.getRenderStartRow()-1);var n1=k1;if(l1===m1){n1=1}var o1=j1.getRenderStartCol();var p1=o1+j1.getRenderColCnt()-1;var q1=$('#'+j1.getId());var r1=q1.children("tbody");if(r1.length===0){q1.append("<tbody/>");r1=q1.children("tbody")}var s1=r1.html();var t1=[];var u1=0;var v1=0;var w1=null;if(!c.getPropertyBag().isDebugMode()){r1.hide()}for(var x1=l1;x1<=m1;x1++){v1=0;R.write("<tr");R.writeAttribute("class","sapzencrosstab-HeaderRow");R.write(">");for(var y1=o1;y1<=p1;y1++){w1=null;if(u1===0){w1=j1.getCellWithRowSpan(x1,y1)}else{w1=j1.getCell(x1,y1)}if(w1){var z1=w1.getRowSpan();if(z1>1){var A1=w1.getEffectiveRowSpan();var B1=A1-(n1-u1);if(B1>0){t1.push(y1)}}R.renderControl(w1)}v1++}R.write("</tr>");u1++}var C1=[];if(t1.length>0){var D1=$('#'+j1.getId()).children("tbody").children("tr");var E1=$(D1[0]);var i=0;for(i=0;i<t1.length;i++){var w1=E1.find("> :nth-child("+(t1[i]+1)+")");if(w1.length>0){var F1=w1.attr('id');C1.push(F1)}}for(var j=0;j<C1.length;j++){var G1=E1.find("#"+C1[j]);G1.remove()}R.write("<tr");R.writeAttribute("class","sapzencrosstab-HeaderRow");R.write(">");R.write(E1.html()+"</tr>");for(i=1;i<D1.length;i++){R.write("<tr");R.writeAttribute("class","sapzencrosstab-HeaderRow");R.write(">");R.write($(D1[i]).html()+"</tr>")}}else{R.write(s1)}j1.setRenderStartRow(l1);j1.setRenderRowCnt(j1.getRenderRowCnt()+m1-l1+1);R.flush(r1[0]);r1.show()};function c1(i,j,j1){var k1=0;var l1=j.getScrollPosition();var m1={};m1.parameters={};m1.oSource=j;m1.parameters.oldScrollPos=l1;if(c.getPropertyBag().isPixelScrolling()||j1){k1=Math.max(0,Math.min(i,parseInt(j.getContentSize(),10)));m1.parameters.action="Drag"}else{k1=Math.max(0,Math.min(i,j.getSteps()));m1.parameters.action="STEP"}m1.getParameters=function(){return this.parameters};m1.parameters.newScrollPos=k1;m1.parameters.forward=(k1-l1)>0;return m1}this.scrollHorizontal=function(i){if(c.getHScrollbar()){var j=c1(i,c.getHScrollbar());c.getHScrollbar().setScrollPosition(j.getParameters().newScrollPos);S.hScrollHandler(j,true)}};this.scrollVertical=function(i,j){if(c.getVScrollbar()){var j1=c1(i,c.getVScrollbar());c.getVScrollbar().setScrollPosition(j1.getParameters().newScrollPos);var k1=false;if(!j){k1=true}S.vScrollHandler(j1,k1)}};this.scrollHeaderHorizontal=function(i){var j=c.getHorizontalHeaderScrollbar();if(j){var j1=c1(i,j,true);j.setScrollPosition(j1.getParameters().newScrollPos);h.hScrollHandler(j1)}};this.getMeasuringHelper=function(){return m};this.reset=function(){e.reset();S=null;m.reset();if(s){s.destroy();s=null}n=[];q=false;u=-1};this.adjustScrollPositions=function(i){if(k.bHasHScrollbar||k.bHasVScrollbar){if(g&&c.getPropertyBag().isPixelScrolling()){var j=0;var j1=e.getSavedVScrollInfo();if(j1){var D=c.getDataArea();var k1=m.getAreaHeight(D);var l1=D.getRowCnt();var m1=Math.round(k1/l1);j=j1.iPos*m1}S.setVScrollPos(j)}var n1=undefined;var o1=undefined;if(e){if(e.hasSavedInfo()){var p1=e.getSavedHScrollInfo();if(p1){n1=p1.bScrolledToEnd}p1=e.getSavedVScrollInfo();if(p1){o1=p1.bScrolledToEnd}}}S.moveScrollbars(k,i,n1,o1);g=false}if(c.isHeaderHScrolling()===true){if(e&&e.hasSavedInfo()===true){h.setHScrollData(e.getHeaderScrollData());h.moveScrollbars()}}};this.hasCrosstabSizeChanged=function(){return m.hasCrosstabSizeChanged(true)};this.getTableDivValues=function(){return m.getTableDivBordersAndPadding()};function d1(){var t=c.getTableDiv();var i=C.getId();var j=r.getId();var j1=d.getId();var k1=D.getId();b.addElement(c.getId(),t);b.addElement(i,t.find("#"+i));b.addElement(j,t.find("#"+j));b.addElement(j1,t.find("#"+j1));b.addElement(k1,t.find("#"+k1))}this.showLoadingIndicator=function(){if(!l&&!I){l=setTimeout(e1,300)}else if(I){e1()}};function e1(){I=true;var t=b.getElement(c.getId());t.addClass("sapzencrosstab-TableDivLoading");var i=t.find("#"+c.getId()+"_loadingAnimationDiv");var j=parseInt(i.css("width"),10);var j1=parseInt(i.css("height"),10);var k1=m.getRenderSizeDivSize(c);var l1=k1.iWidth/2-j/2;var m1=k1.iHeight/2-j1/2;i.css("top",m1+"px");i.css("left",l1+"px");i.css("visibility","visible")}function f1(){if(l){clearTimeout(l);l=""}}this.hideLoadingIndicator=function(){f1();var t=b.getElement(c.getId());t.removeClass("sapzencrosstab-TableDivLoading");var i=t.find("#"+c.getId()+"_loadingAnimationDiv");if(i&&i[0]){i.css("visibility","hidden")}I=false};this.showLoadingVisualization=function(){if(D.hasLoadingPages()){this.showLoadingIndicator()}else{this.hideLoadingIndicator()}};this.moveScrollDivs=function(){if(S){if(k){if(k.bHasHScrollbar){S.positionHScrollDiv()}if(k.bHasVScrollbar){S.positionVScrollDiv()}}}};this.getCrossRequestManager=function(){return e};this.registerNewScrollbarsNotification=function(i){if($.inArray(i,n)===-1){n.push(i)}};this.checkScrollbarSize=function(){if(k.bHasVScrollbar){var i=$('#'+c.getId()+'_upperRightPad');var j=null;if(c.hasDimensionHeaderArea()){j=$('#'+c.getId()+'_upperLeft_scrollDiv')}else if(c.hasColHeaderArea()){j=$('#'+c.getId()+'_upperRight_scrollDiv')}if(i!==null&&i.length>0&&j!==null&&j.length>0){var j1=j.outerHeight();if(j1!==i.outerHeight()){if(s){s.adjustVScrollbarHeight(j1)}}}}if(k.bHasHScrollbar){var k1=$('#'+c.getId()+'_lowerLeftPad');var l1;if(c.hasRowHeaderArea()){l1=$('#'+c.getId()+'_lowerLeft_scrollDiv')}else{l1=$('#'+c.getId()+'_upperLeft_scrollDiv')}var m1=l1.outerWidth();if(m1!==k1.outerWidth()){if(s){s.adjustHScrollbarWidth(m1)}}}};this.updateRenderingOfInputCellAfterCheck=function(i){var j=$('#'+i.getId());if(j.length>0){var j1=sap.zen.crosstab.CellStyleHandler.getCompleteStyleName(sap.zen.crosstab.rendering.RenderingConstants.STYLE_INVALID_VALUE,i.getCellType());if(i.hasStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_INVALID_VALUE)===true){j.addClass(j1)}else{j.removeClass(j1)}var k1=j.find("#"+i.getId()+"_contentDiv");k1.html(i.getText())}};this.updateHeaderScrollbarSizes=function(){if(s){s.setHorizontalHeaderScrollbarSteps();s.adjustHorizontalHeaderScrollbarContainerSize()}};function g1(i,j){var j1=$('#'+c.getId()+i);if(j1.length>0){if(j===true){j1.find("tbody>tr[class=sapzencrosstab-HeaderRow]>td:last-child").addClass("sapzencrosstab-removeRightBorder")}else{j1.find("tbody>tr[class=sapzencrosstab-HeaderRow]>td:last-child").removeClass("sapzencrosstab-removeRightBorder")}}}function h1(j,i){if(j&&j.length>0){j.addClass("sapzencrosstab-lowerScrollHeaderSeparator")}if(i&&i.length>0){i.addClass("sapzencrosstab-upperScrollHeaderSeparator")}g1("_rowHeaderArea",true);g1("_dimHeaderArea",true)}function i1(j,i){if(j&&j.length>0){j.removeClass("sapzencrosstab-lowerScrollHeaderSeparator")}if(i&&i.length>0){i.removeClass("sapzencrosstab-upperScrollHeaderSeparator")}g1("_rowHeaderArea",false);g1("_dimHeaderArea",false)}this.forceHeaderWidth=function(){var j=null;var i=null;var j1=0;var k1=0;var l1=0;if(c.hasRowHeaderArea()===false&&c.hasDimensionHeaderArea()===false){return}var m1=c.getPropertyBag().getMaxHeaderWidth();if(!isNaN(m1)&&m1>0){if(c.hasRowHeaderArea()){j=$('#'+c.getId()+'_lowerLeft_scrollDiv');j1=j.outerWidth()}if(c.hasDimensionHeaderArea()){i=$('#'+c.getId()+'_upperLeft_scrollDiv');k1=i.outerWidth()}l1=Math.max(j1,k1);if(l1>m1){j.css("width",m1);i.css("width",m1);c.setHeaderHScrolling(true)}else{if(c.isHeaderHScrolling()===true){c.setHeaderHScrolling(false);c.getUtils().sendClientScrollPosUpdate(0,undefined,undefined,undefined,true)}}if(c.isHeaderHScrolling()){h1(j,i)}else{i1(j,i)}}else{c.setHeaderHScrolling(false);c.setHorizontalHeaderScrollbar(null)}};this.getHeaderScrollManager=function(){return h}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.BaseArea')){jQuery.sap.declare("sap.zen.crosstab.BaseArea");sap.zen.crosstab.BaseArea=function(c){"use strict";this.sAreaType="";this.sId="";this.oCrosstab=c;this.iRenderStartRow=0;this.iRenderRowCnt=0;this.iRenderStartCol=0;this.iRenderColCnt=0;this.bHasContent=false;this.fRenderCellCallback=null;this.oDataModel=new sap.zen.crosstab.rendering.DataModel(this);this.aColGranularity=[];this.aColWidths=[];this.aCalculatedColWidths=[];this.aTemporaryColWidths=[];this.aRowGranularity=[];this.aRowHeights=[];this.aCalculatedRowHeights=[];this.aTemporaryRowHeights=[];this.oColsWithSymbolException={};this.oColUserWidth={};this.aLevelCells=[];this.iLoadingPageCnt=0;this.bColGranularityCalculatedAndMeasured=false;this.oUserResizedCols={};this.oCellsWithLineBreakTexts=null};sap.zen.crosstab.BaseArea.prototype.insertCell=function(c,r,C){if(c){if(c.textHasLineBreaks()===true){if(!this.oCellsWithLineBreakTexts){this.oCellsWithLineBreakTexts={}}this.oCellsWithLineBreakTexts[c.getId()]=c}this.bHasContent=true;var m=this.oCrosstab.getUtils().getModelCoordinates(r,C,this.sAreaType);if(m.iCol===0){c.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_FIRST_IN_ROW)}if(m.iRow===0){c.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_FIRST_IN_COL)}if((m.iCol+c.getColSpan())===this.oCrosstab.getTotalCols()){c.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_LAST_IN_ROW)}if((m.iRow+c.getRowSpan())===this.oCrosstab.getTotalRows()){c.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_LAST_IN_COL)}}this.oDataModel.insertCell(c,r,C)};sap.zen.crosstab.BaseArea.prototype.addHighlightingForCell=function(r,c){var C=this.oDataModel.getCellWithSpan(r,c);if(C){C.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_HIGHLIGHTED);var d=$("#"+C.getId());if(this.isDataArea()){d.addClass("sapzencrosstab-DataCellHighlighted")}else{d.addClass("sapzencrosstab-HeaderCellHighlighted")}}};sap.zen.crosstab.BaseArea.prototype.removeHighlightingForCell=function(r,c){var C=this.oDataModel.getCellWithSpan(r,c);if(C){C.removeStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_HIGHLIGHTED);var d=$("#"+C.getId());if(this.isDataArea()){d.removeClass("sapzencrosstab-DataCellHighlighted")}else{d.removeClass("sapzencrosstab-HeaderCellHighlighted")}}};sap.zen.crosstab.BaseArea.prototype.resetColGranularity=function(){this.aColGranularity=[]};sap.zen.crosstab.BaseArea.prototype.resetRowGranularity=function(){this.aRowGranularity=[]};sap.zen.crosstab.BaseArea.prototype.calculateColGranularity=function(){if(this.bColGranularityCalculatedAndMeasured===false){var r=0;var e=this.iRenderStartRow+this.iRenderRowCnt;var c=0;var E=this.iRenderStartCol+this.iRenderColCnt;this.aColGranularity=[];for(c=this.iRenderStartCol;c<E;c++){for(r=this.iRenderStartRow;r<e;r++){if(this.collectColGranularity(r,c,this)){break}}}}};sap.zen.crosstab.BaseArea.prototype.calculateRowGranularity=function(){var r=0;var e=this.iRenderStartRow+this.iRenderRowCnt;var c=0;var E=this.iRenderStartCol+this.iRenderColCnt;this.aRowGranularity=[];for(r=this.iRenderStartRow;r<e;r++){for(c=this.iRenderStartCol;c<E;c++){if(this.collectRowGranularity(r,c,this)){break}}}};sap.zen.crosstab.BaseArea.prototype.getCellForGranularity=function(r,c,t){var C=null;if(c===t.iRenderStartCol&&r===t.iRenderStartRow){C=t.oDataModel.getCellWithSpan(r,c)}else if(c===t.iRenderStartCol){C=t.oDataModel.getCellWithColSpan(r,c)}else if(r===t.iRenderStartRow){C=t.oDataModel.getCellWithRowSpan(r,c)}else{C=t.oDataModel.getCellDirect(r,c)}return C};sap.zen.crosstab.BaseArea.prototype.collectColGranularity=function(r,c,t){var C=t.getCellForGranularity(r,c,t);var i=-1;if(C){i=C.getEffectiveColSpan();var o=t.aColGranularity[c];if(o){if(i<o.iColSpan){o.sId=C.getId();o.iRow=r;o.iCol=c;o.iColSpan=i;o.iWidth=0}}else{o={};o.sId=C.getId();o.iRow=r;o.iCol=c;o.iColSpan=i;o.iWidth=0;t.aColGranularity[c]=o}}return i===1};sap.zen.crosstab.BaseArea.prototype.collectRowGranularity=function(r,c,t){var C=t.getCellForGranularity(r,c,t);var R=-1;if(C){R=C.getEffectiveRowSpan();var o=t.aRowGranularity[r];if(o){if(R<o.iRowSpan){o.sId=C.getId();o.iRow=r;o.iCol=c;o.iRowSpan=R;o.iHeight=0;o.isLevelCell=this.isColHeaderArea()&&C.getLevel&&C.getLevel()>-1;o.isEntryEnabled=false}}else{o={};o.sId=C.getId();o.iRow=r;o.iCol=c;o.iRowSpan=R;o.iHeight=0;o.isLevelCell=this.isColHeaderArea()&&C.getLevel&&C.getLevel()>-1;o.isEntryEnabled=false;t.aRowGranularity[r]=o}}return R===1};sap.zen.crosstab.BaseArea.prototype.measureColGranularityCells=function(){var c=0;var C=null;var d=null;var a=0;var w=0;var m=0;var i=0;if(this.bColGranularityCalculatedAndMeasured===false){this.aColWidths=[];for(c=this.iRenderStartCol;c<this.aColGranularity.length;c++){C=this.aColGranularity[c];if(C){d=jQuery.sap.byId(C.sId);if(d){a=d.outerWidth()+1;w=Math.floor(a/C.iColSpan);m=a%C.iColSpan;for(i=0;i<C.iColSpan;i++){if(this.aCalculatedColWidths[c+i]&&!this.aTemporaryColWidths[c+i]){this.aColWidths[c+i]=this.aCalculatedColWidths[c+i]}else{if(i===C.iColSpan-1){w+=m}if(this.aColWidths[c+i]){if(this.aColWidths[c+i]<w){this.aColWidths[c+i]=w}}else{this.aColWidths[c+i]=w}}}}}}if(sap.zen.crosstab.utils.Utils.hasEntries(this.oColsWithSymbolException)){var b=null;var e;for(var f in this.oColsWithSymbolException){if(this.oColsWithSymbolException.hasOwnProperty(f)){b=this.oColsWithSymbolException[f];if(b===undefined||b===null||isNaN(b)===true){e=this.aColWidths[f];b=e+this.oCrosstab.getExceptionSymbolWidth();this.oColsWithSymbolException[f]=b}this.aColWidths[f]=this.oColsWithSymbolException[f]}}}if(this.oColUserWidth&&sap.zen.crosstab.utils.Utils.hasEntries(this.oColUserWidth)){var u;for(var i=0;i<this.aColWidths.length;i++){u=this.determineUserColWidth(i);if(u>-1){this.aColWidths[i]=u}}}}return this.aColWidths};sap.zen.crosstab.BaseArea.prototype.measureRowGranularityCells=function(){var r=0;var c=null;var d=null;var C=0;var h=0;var m=0;var i=0;this.aLevelCells=[];this.aRowHeights=[];for(r=this.iRenderStartRow;r<this.aRowGranularity.length;r++){c=this.aRowGranularity[r];if(c){d=jQuery.sap.byId(c.sId);if(d){C=d.outerHeight();h=Math.floor(C/c.iRowSpan);m=C%c.iRowSpan;if(c.isLevelCell){for(i=0;i<c.iRowSpan;i++){if(i===c.iRowSpan-1){h+=m}if(this.aRowHeights[r+i]){if(this.aRowHeights[r+i]<h){this.aRowHeights[r+i]=h}}else{this.aRowHeights[r+i]=h}if(this.aCalculatedRowHeights[r+i]&&!this.aTemporaryRowHeights[r+i]){if(this.aRowHeights[r+i]<this.aCalculatedRowHeights[r+i]){this.aRowHeights[r+i]=this.aCalculatedRowHeights[r+i]}}this.aLevelCells[r+i]=true}}else{for(i=0;i<c.iRowSpan;i++){if(this.aCalculatedRowHeights[r+i]&&!this.aTemporaryRowHeights[r+i]){this.aRowHeights[r+i]=this.aCalculatedRowHeights[r+i]}else{if(i===c.iRowSpan-1){h+=m}if(this.aRowHeights[r+i]){if(this.aRowHeights[r+i]<h){this.aRowHeights[r+i]=h}}else{this.aRowHeights[r+i]=h}}this.aLevelCells[r+i]=false}}}}}return this.aRowHeights};sap.zen.crosstab.BaseArea.prototype.getLevelCells=function(){return this.aLevelCells};sap.zen.crosstab.BaseArea.prototype.hasLoadingPages=function(){return this.iLoadingPageCnt>0};sap.zen.crosstab.BaseArea.prototype.getCalculatedColWidths=function(){return this.aCalculatedColWidths};sap.zen.crosstab.BaseArea.prototype.getCalculatedRowHeights=function(){return this.aCalculatedRowHeights};sap.zen.crosstab.BaseArea.prototype.addPageToTempArray=function(a,i,p){if(!a[i]){a[i]=[]}a[i].push(p)};sap.zen.crosstab.BaseArea.prototype.removePageFromTempArray=function(a,I,p){var P=a[I];if(P){for(var i=0;i<P.length;i++){if(P[i]===p){P.splice(i,1);break}}if(P.length===0){a[I]=null}}};sap.zen.crosstab.BaseArea.prototype.changeColWidthTemporaryFlag=function(c,p,i){if(!this.aCalculatedColWidths[c]&&i){this.addPageToTempArray(this.aTemporaryColWidths,c,p)}else if(!i&&this.aTemporaryColWidths[c]){this.removePageFromTempArray(this.aTemporaryColWidths,c,p);if(!this.aTemporaryColWidths[c]){this.aCalculatedColWidths[c]=null}}};sap.zen.crosstab.BaseArea.prototype.changeRowHeightTemporaryFlag=function(r,p,i){if(!this.aCalculatedRowHeights[r]&&i){this.addPageToTempArray(this.aTemporaryRowHeights,r,p)}else if(!i&&this.aTemporaryRowHeights[r]){this.removePageFromTempArray(this.aTemporaryRowHeights,r,p);if(!this.aTemporaryRowHeights[r]){this.aCalculatedRowHeights[r]=null}}};sap.zen.crosstab.BaseArea.prototype.applyColWidthsToGranularityCells=function(c,f){var C=0;var o=null;var i=0;var w=0;var a=0;for(C=this.iRenderStartCol;C<this.aColGranularity.length;C++){o=this.aColGranularity[C];if(o){w=0;for(i=0;i<o.iColSpan;i++){a=c[C+i];w+=a;if(!this.aCalculatedColWidths[C+i]||f===true){this.aCalculatedColWidths[C+i]=a}}o.iWidth=w}}};sap.zen.crosstab.BaseArea.prototype.applyRowHeightsToGranularityCells=function(r,l){var R=0;var c=null;var i=0;var h=0;var C=0;for(R=this.iRenderStartRow;R<this.aRowGranularity.length;R++){c=this.aRowGranularity[R];if(c){h=0;for(i=0;i<c.iRowSpan;i++){C=r[R+i];h+=C;if(!this.aCalculatedRowHeights[R+i]||(l&&l[R+i])){this.aCalculatedRowHeights[R+i]=C}}c.iHeight=h}}};sap.zen.crosstab.BaseArea.prototype.getColGranularity=function(){return this.aColGranularity};sap.zen.crosstab.BaseArea.prototype.getRowGranularity=function(){return this.aRowGranularity};sap.zen.crosstab.BaseArea.prototype.getCellDirect=function(r,c){return this.oDataModel.getCellDirect(r,c)};sap.zen.crosstab.BaseArea.prototype.getCell=function(r,c){return this.oDataModel.getCell(r,c)};sap.zen.crosstab.BaseArea.prototype.renderBaseArea=function(r){this.oCrosstab.getRenderEngine().renderArea(this,r)};sap.zen.crosstab.BaseArea.prototype.setRowCnt=function(r){this.oDataModel.setRowCnt(r)};sap.zen.crosstab.BaseArea.prototype.getRowCnt=function(){return this.oDataModel.getRowCnt()};sap.zen.crosstab.BaseArea.prototype.setColCnt=function(c){this.oDataModel.setColCnt(c)};sap.zen.crosstab.BaseArea.prototype.getColCnt=function(){return this.oDataModel.getColCnt()};sap.zen.crosstab.BaseArea.prototype.clear=function(k,K){this.oDataModel.clear();this.iRenderStartRow=0;this.iRenderRowCnt=0;this.iRenderStartCol=0;this.iRenderColCnt=0;this.bHasContent=false;this.fRenderCellCallback=null;this.aColGranularity=[];this.aColWidths=[];this.aTemporaryColWidths=[];this.aRowGranularity=[];this.aRowHeights=[];this.aCalculatedRowHeights=[];this.aTemporaryRowHeights=[];this.iLoadingPageCnt=0;this.aLevelCells=[];this.oColUserWidth={};this.oColsWithSymbolException={};if(!k){this.oUserResizedCols={}}if(!K){this.aCalculatedColWidths=[]}this.oCellsWithLineBreakTexts=null};sap.zen.crosstab.BaseArea.prototype.getDataModel=function(){return this.oDataModel};sap.zen.crosstab.BaseArea.prototype.setDataModel=function(d){this.oDataModel=d};sap.zen.crosstab.BaseArea.prototype.getId=function(){return this.sId};sap.zen.crosstab.BaseArea.prototype.setId=function(i){this.sId=i};sap.zen.crosstab.BaseArea.prototype.getAreaType=function(){return this.sAreaType};sap.zen.crosstab.BaseArea.prototype.getCrosstab=function(){return this.oCrosstab};sap.zen.crosstab.BaseArea.prototype.getPageManager=function(){return this.oCrosstab.getPageManager()};sap.zen.crosstab.BaseArea.prototype.getCellWithColSpan=function(r,c,d){return this.oDataModel.getCellWithColSpan(r,c,d)};sap.zen.crosstab.BaseArea.prototype.getCellWithRowSpan=function(r,c,d){return this.oDataModel.getCellWithRowSpan(r,c,d)};sap.zen.crosstab.BaseArea.prototype.setRenderSize=function(r,R,i,a){this.iRenderStartRow=r;this.iRenderRowCnt=R;this.iRenderStartCol=i;this.iRenderColCnt=a};sap.zen.crosstab.BaseArea.prototype.setRenderStartRow=function(r){this.iRenderStartRow=r};sap.zen.crosstab.BaseArea.prototype.setRenderRowCnt=function(r){this.iRenderRowCnt=r};sap.zen.crosstab.BaseArea.prototype.setRenderStartCol=function(c){this.iRenderStartCol=c};sap.zen.crosstab.BaseArea.prototype.setRenderColCnt=function(c){this.iRenderColCnt=c};sap.zen.crosstab.BaseArea.prototype.getRenderStartRow=function(){return this.iRenderStartRow};sap.zen.crosstab.BaseArea.prototype.getRenderRowCnt=function(){return this.iRenderRowCnt};sap.zen.crosstab.BaseArea.prototype.getRenderStartCol=function(){return this.iRenderStartCol};sap.zen.crosstab.BaseArea.prototype.getRenderColCnt=function(){return this.iRenderColCnt};sap.zen.crosstab.BaseArea.prototype.getRenderedCellsByCol=function(c){return this.oDataModel.getCellsByCol(c,this.iRenderStartRow,this.iRenderRowCnt)};sap.zen.crosstab.BaseArea.prototype.getRenderedCellsByRow=function(r){return this.oDataModel.getCellsByRow(r,this.iRenderStartCol,this.iRenderColCnt)};sap.zen.crosstab.BaseArea.prototype.resetColWidth=function(c){this.aCalculatedColWidths[c]=0};sap.zen.crosstab.BaseArea.prototype.getColWidth=function(c){return this.aCalculatedColWidths[c]};sap.zen.crosstab.BaseArea.prototype.getColWidths=function(){return this.aCalculatedColWidths};sap.zen.crosstab.BaseArea.prototype.setColWidths=function(c){this.aCalculatedColWidths=c};sap.zen.crosstab.BaseArea.prototype.determineUserColWidth=function(c){var C=-1;if(!this.oUserResizedCols[c]){var w=this.oColUserWidth[c];var s=this.oColUserWidth['*'];if(w&&!w.ignore){C=w.width}else{if(s){if(w){if(!w.ignore){C=s.width}}else{C=s.width}}}}return C};sap.zen.crosstab.BaseArea.prototype.getFinalColWidth=function(c){var C=0;if(!this.hasLoadingPages()){C=this.getColWidth(c)}var u=this.determineUserColWidth(c);if(u>-1){C=u}return C};sap.zen.crosstab.BaseArea.prototype.getRowHeight=function(r){return this.aCalculatedRowHeights[r]};sap.zen.crosstab.BaseArea.prototype.getFinalRowHeight=function(r){var R=0;if(!this.hasLoadingPages()){R=this.getRowHeight(r)}return R};sap.zen.crosstab.BaseArea.prototype.hasContent=function(){return this.bHasContent};sap.zen.crosstab.BaseArea.prototype.registerRenderCellCallback=function(c){this.fRenderCellCallback=c};sap.zen.crosstab.BaseArea.prototype.removeRenderCellCallback=function(){this.fRenderCellCallback=null};sap.zen.crosstab.BaseArea.prototype.getRenderCellCallback=function(){return this.fRenderCellCallback};sap.zen.crosstab.BaseArea.prototype.isDimHeaderArea=function(){return this.sAreaType===sap.zen.crosstab.rendering.RenderingConstants.TYPE_DIMENSION_HEADER_AREA};sap.zen.crosstab.BaseArea.prototype.isRowHeaderArea=function(){return this.sAreaType===sap.zen.crosstab.rendering.RenderingConstants.TYPE_ROW_HEADER_AREA};sap.zen.crosstab.BaseArea.prototype.isColHeaderArea=function(){return this.sAreaType===sap.zen.crosstab.rendering.RenderingConstants.TYPE_COLUMN_HEADER_AREA};sap.zen.crosstab.BaseArea.prototype.isDataArea=function(){return this.sAreaType===sap.zen.crosstab.rendering.RenderingConstants.TYPE_DATA_AREA};sap.zen.crosstab.BaseArea.getArea=function(c,a){if(a===sap.zen.crosstab.rendering.RenderingConstants.TYPE_DIMENSION_HEADER_AREA){return c.getDimensionHeaderArea()}else if(a===sap.zen.crosstab.rendering.RenderingConstants.TYPE_ROW_HEADER_AREA){return c.getRowHeaderArea()}else if(a===sap.zen.crosstab.rendering.RenderingConstants.TYPE_COLUMN_HEADER_AREA){return c.getColumnHeaderArea()}else if(a===sap.zen.crosstab.rendering.RenderingConstants.TYPE_DATA_AREA){return c.getDataArea()}else{return null}};sap.zen.crosstab.BaseArea.prototype.increaseLoadingPageCnt=function(){this.iLoadingPageCnt++};sap.zen.crosstab.BaseArea.prototype.decreaseLoadingPageCnt=function(){if(this.iLoadingPageCnt>0){this.iLoadingPageCnt--}};sap.zen.crosstab.BaseArea.prototype.getLoadingPageCnt=function(){return this.iLoadingPageCnt};sap.zen.crosstab.BaseArea.prototype.openContainerCell=function(r,c){r.write("<td");r.addStyle("border-spacing","0px");r.addStyle("padding","0px");r.addStyle("border-width","0px");r.addStyle("margin","0px");r.writeStyles();if(c){r.writeAttribute("class",c)}r.write(">")};sap.zen.crosstab.BaseArea.prototype.closeContainerCell=function(r){r.write("</td>")};sap.zen.crosstab.BaseArea.prototype.openContainerTable=function(r){r.write("<table");r.writeAttribute("id",this.sId+"_container");r.addStyle("border-collapse","collapse");r.addStyle("border-spacing","0px");r.addStyle("padding","0px");r.addStyle("border-width","0px");r.addStyle("margin","0px");r.writeStyles();r.write(">")};sap.zen.crosstab.BaseArea.prototype.closeContainerTable=function(r){r.write("</table>")};sap.zen.crosstab.BaseArea.prototype.renderContainerStructure=function(r,s,v,h){this.openContainerTable(r);r.write("<tr>");this.openContainerCell(r);r.write("<table");r.writeAttribute("id",this.sId);r.writeAttribute("class",s);r.write(">");r.write("</table>");this.closeContainerCell(r);if(h){this.openContainerCell(r,"sapzencrosstab-HorizontalCutOff-"+this.getAreaType());r.write("<div");r.writeAttribute("class","sapzencrosstab-HorizontalCutOffSpacer");r.write(">");r.write("</div>");this.closeContainerCell(r)}r.write("</tr>");if(v){r.write("<tr>");this.openContainerCell(r,"sapzencrosstab-VerticalCutOff-"+this.getAreaType());r.write("<div");r.writeAttribute("class","sapzencrosstab-VerticalCutOffSpacer");r.write(">");r.write("</div>");this.closeContainerCell(r);if(h){this.openContainerCell(r,"sapzencrosstab-CutOffCorner");this.closeContainerCell(r)}r.write("</tr>")}this.closeContainerTable(r)};sap.zen.crosstab.BaseArea.prototype.columnHasSymbolException=function(c){this.oColsWithSymbolException[c]=null};sap.zen.crosstab.BaseArea.prototype.setColUserWidth=function(c,w,i){this.oColUserWidth[c]={"width":w,"ignore":i}};sap.zen.crosstab.BaseArea.prototype.clearColUserWidth=function(c){delete this.oColUserWidth[c]};sap.zen.crosstab.BaseArea.prototype.hasUserColWidths=function(){var h=this.oColUserWidth&&sap.zen.crosstab.utils.Utils.hasEntries(this.oColUserWidth);return h};sap.zen.crosstab.BaseArea.prototype.isFixedColWidthSet=function(c){if(!this.hasUserColWidths()&&!sap.zen.crosstab.utils.Utils.hasEntries(this.oUserResizedCols)){return false}if(this.oColUserWidth[c]!==undefined){return true}if(this.oUserResizedCols[c]!==undefined){return true}return false};sap.zen.crosstab.BaseArea.prototype.setColGranularityCalculatedAndMeasured=function(c){this.bColGranularityCalculatedAndMeasured=c};sap.zen.crosstab.BaseArea.prototype.setUserResizedCol=function(c){this.oUserResizedCols[c]=true};sap.zen.crosstab.BaseArea.prototype.clearUserResizedCol=function(c){delete this.oUserResizedCols[c]};sap.zen.crosstab.BaseArea.prototype.getCellsWithLineBreakTexts=function(){return this.oCellsWithLineBreakTexts}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.ColumnHeaderArea')){jQuery.sap.declare("sap.zen.crosstab.ColumnHeaderArea");sap.zen.crosstab.ColumnHeaderArea=function(c){"use strict";sap.zen.crosstab.BaseArea.call(this,c);this.sAreaType=sap.zen.crosstab.rendering.RenderingConstants.TYPE_COLUMN_HEADER_AREA;this.iRenderStartCol=0;this.iRenderColCnt=0;this.bLastPageLoaded=false};sap.zen.crosstab.ColumnHeaderArea.prototype=jQuery.sap.newObject(sap.zen.crosstab.BaseArea.prototype);sap.zen.crosstab.ColumnHeaderArea.prototype.renderArea=function(r){this.renderContainerStructure(r,"sapzencrosstab-ColumnHeaderArea",false,this.oCrosstab.isHCutOff())}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.DataArea')){jQuery.sap.declare("sap.zen.crosstab.DataArea");sap.zen.crosstab.DataArea=function(c){"use strict";sap.zen.crosstab.BaseArea.call(this,c);this.sAreaType=sap.zen.crosstab.rendering.RenderingConstants.TYPE_DATA_AREA};sap.zen.crosstab.DataArea.prototype=jQuery.sap.newObject(sap.zen.crosstab.BaseArea.prototype);sap.zen.crosstab.DataArea.prototype.renderArea=function(r){this.renderContainerStructure(r,"sapzencrosstab-DataArea",this.oCrosstab.isVCutOff(),this.oCrosstab.isHCutOff())};sap.zen.crosstab.DataArea.prototype.insertCell=function(c,r,C){sap.zen.crosstab.BaseArea.prototype.insertCell.call(this,c,r,C);if(C===this.oDataModel.getColCnt()-1&&c){c.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_LAST_IN_ROW)}if(r===this.oDataModel.getRowCnt()-1&&c){c.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_LAST_IN_COL)}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.DimensionHeaderArea')){jQuery.sap.declare("sap.zen.crosstab.DimensionHeaderArea");sap.zen.crosstab.DimensionHeaderArea=function(c){"use strict";sap.zen.crosstab.BaseArea.call(this,c);this.sAreaType=sap.zen.crosstab.rendering.RenderingConstants.TYPE_DIMENSION_HEADER_AREA};sap.zen.crosstab.DimensionHeaderArea.prototype=jQuery.sap.newObject(sap.zen.crosstab.BaseArea.prototype);sap.zen.crosstab.DimensionHeaderArea.prototype.renderArea=function(r){var c="sapzencrosstab-DimensionHeaderArea";if(this.oCrosstab.getPropertyBag().isMobileMode()){c+=" sapzencrosstab-MobileHeaderSeparator"}this.renderContainerStructure(r,c,false,false)};sap.zen.crosstab.DimensionHeaderArea.prototype.getPageManager=function(){return null}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.EventHandler')){jQuery.sap.declare("sap.zen.crosstab.EventHandler");sap.zen.crosstab.EventHandler=function(c){"use strict";var t=this;var C=c.getRenderEngine().getCrossRequestManager();var o=null;var s=null;var d=c.getDataArea();var r=c.getRowHeaderArea();var a=c.getColumnHeaderArea();var D=c.getDimensionHeaderArea();var h=null;var k=new sap.zen.crosstab.keyboard.CrosstabKeyboardNavHandler(c,this);var m=null;var p=false;var T=null;function b(e,i,c){var P=false;if(c.isDataSelectionMode()){if(e===i){P=true}}return P}this.removeHighlighting=function(H){var e=$('#'+H.getId());if(e.hasClass("sapzencrosstab-HighlightRowHeaderCell")||e.hasClass("sapzencrosstab-HighlightColHeaderCell")){this.applySelectionEffect(H,l(false))}};this.handleRowColSelection=function(e){if(!o&&c.getPropertyBag().isMobileMode()){o=g(e)}if(o){var i=t.getSelectedCell();if(!i){i=g(e);if(i){var F=j(true);t.applySelectionEffect(i,F);t.setSelectedCell(i);t.sendSelectCommand(i);sap.zen.crosstab.utils.Utils.cancelEvent(e)}}else{var x=g(e);if(x&&x.isSelectable&&x.isSelectable()){var y=false;if(i){y=b(i,x,c);if(!y){var F=j(false);t.applySelectionEffect(i,F)}}if(x===i){if(!y){i=null}}else{i=x}if(i){if(!y){t.highlightCells();var F=j(true);t.applySelectionEffect(i,F)}}if(!y){t.setSelectedCell(i);t.sendSelectCommand(i)}sap.zen.crosstab.utils.Utils.cancelEvent(e)}}if(c.getPropertyBag().isMobileMode()){o=null}return true}else{return false}};this.handleHierarchyClick=function(e,i,x){var y=v(i);var H=y.getHierarchyAction();var z=y.getDrillState();if(z!=="L"){if(y.getArea().isRowHeaderArea()){C.saveColWidths()}C.saveTableDimensions();C.saveHScrollInfo(x);C.saveVScrollInfo(x);w(H)}sap.zen.crosstab.utils.Utils.cancelEvent(e)};this.handleSortClick=function(e,i,x){var y=v(i);var S=y.getSortAction();if(S||c.getTestProxy().getTestAction()){C.saveVScrollInfo(x);C.saveHScrollInfo(x);C.saveColWidths();if(!c.getTestProxy().getTestAction()){w(S)}}sap.zen.crosstab.utils.Utils.cancelEvent(e)};this.handleDataCellSelection=function(e){if(o){if(!s){var F=j(true);t.applySelectionEffect(o,F);t.setSelectedCell(o);t.sendSelectCommand(o);sap.zen.crosstab.utils.Utils.cancelEvent(e)}else{var i=g(e);var x=d.getCell(s.iRow,s.iCol);var F=j(false);t.applySelectionEffect(x,F);if(i){if(i===x){x=null}else{x=i}if(x){var F=j(true);t.applySelectionEffect(x,F)}t.setSelectedCell(x);t.sendSelectCommand(x);sap.zen.crosstab.utils.Utils.cancelEvent(e)}}}};this.findTargetId=function(e){var i=null;var J=$(e).closest("div");if(J.length>0){var I=J.attr("id");if(I){var x=I.indexOf("_contentDiv");if(x>-1){i=I.slice(0,x)}}}return i};this.executeOnClickAction=function(e){if(p){return}m=null;p=false;var i=e.target.id;if(!i){i=t.findTargetId(e.target)}if(!i){return}var x=u(i);if(x==="sort"){t.handleSortClick(e,i,x)}else if(x==="hier"){t.handleHierarchyClick(e,i,x)}else if(x==="__ce"){if(c.hasLoadingPages()){sap.zen.crosstab.utils.Utils.cancelEvent(e);return}var I=c.getPropertyBag().isSelectionEnabled();if(I&&c.isSingleDataCellSelection()===true){t.handleDataCellSelection(e)}else if(I){var W=t.handleRowColSelection(e);if(!W){t.handleInputEnabledCell(i,-1,-1)}}else{t.handleInputEnabledCell(i,-1,-1)}}else if(x==="vhlp"){t.handleValueHelpClick(i)}sap.zen.crosstab.utils.Utils.cancelEvent(e)};this.getCellIdFromContenDivId=function(I){var i=I.indexOf("_contentDiv");if(i>-1){I=I.slice(0,i)}else{i=I.indexOf("_textContentDiv");if(i>-1){I=I.slice(0,i)}}return I};this.provideInputEnabledCell=function(M,i,x,S,y){var I=x.find("input");if(I.length===0){var R=x.text();var z=x.html();var A=M.getArea().isDataArea();var B=null;var E=function(V){var U=M.getUnit();if(U&&U!==""){var e=V.toUpperCase().indexOf(U.toUpperCase());if(e!==-1){if(e===0){V=V.substring(e+U.length)}else{V=V.substring(0,e)}}}var O=c.calculateOffset(M);V=$.trim(V);var L=c.getTransferDataCommand();L=L.replace("__ROW__",M.getRow()+"");L=L.replace("__COL__",(M.getCol()-O)+"");L=L.replace("__VALUE__",V);L=L.replace("__CTYPE__",M.getPassiveCellType());C.saveVScrollInfo("plan");C.saveHScrollInfo("plan");C.saveColWidths();w(L,true)};var F=function(e){if(I.val()!==R){E(I.val());var L=$('<div/>').text(R).html();z=z.replace(L,I.val())}H(e)};var G=function(e){var L=true;var i=null;var N=null;var O=null;if(e&&e.relatedTarget&&e.relatedTarget.id&&c.getValueHelpStatus()!==sap.zen.crosstab.VHLP_STATUS_OPENING){i=e.relatedTarget.id;O=$('#'+i);N=c.getTableDiv();L=O.closest(N).length>0}return L};var H=function(e){var L=$('#'+i+"_contentDiv");L.html(z);if(B&&A){L.width(B)}if(G(e)===true){L.focus()}else{k.reset()}};var J=function(e){if(e.which===27){H();sap.zen.crosstab.utils.Utils.cancelEvent(e)}if(e.which===13){if(I.val()!==R){sap.zen.crosstab.utils.Utils.cancelEvent(e);E(I.val())}else{H();if(c.isIE8Mode()){k.keyboardNavKeyHandler(e)}}}if(e.which===38||e.which===40){return true}if(e.which===37||e.which===39){if(!e.ctrkKey&&!e.altKey&&!e.shiftKey){sap.zen.crosstab.utils.Utils.stopEventPropagation(e)}return true}};var K=0;if(A){K=x.innerWidth();B=sap.zen.crosstab.utils.Utils.getWidthFromStyle(x)}x.html("<input id=\""+i+"_input"+"\" type=\"text\" value=\""+R+"\" />");if(A){x.width(K+"px")}I=$('#'+i+"_input");I.addClass("sapzencrosstab-EntryEnabledInput");I.keydown(J);I.focus();c.getUtils().selectTextInInputField(I,S,y);I.on("focusout",F)}else{c.getUtils().selectTextInInputField(I,S,y)}};this.handleValueHelpClick=function(e){var i=v(e);if(i){k.focusNewCell(i,-1,-1);var x=c.getCallValueHelpCommand();var O=c.calculateOffset(i);C.saveVScrollInfo("plan");C.saveHScrollInfo("plan");C.saveColWidths();x=x.replace("__ROW__",i.getRow());x=x.replace("__COL__",i.getCol()-O);x=x.replace("__DOM_REF_ID__",e);w(x,true)}};this.handleInputEnabledCell=function(e,S,i){if(e){e=this.getCellIdFromContenDivId(e);if(e){var M=sap.ui.getCore().getControl(e);if(M){if(M.getArea().isDataArea()||M.getArea().isRowHeaderArea()){k.focusNewCell(M,S,i)}}}}};this.sendSelectCommand=function(e){var R=-1;var i=-1;var A="";if(e){var x=e.getArea();if(x.isRowHeaderArea()){A="ROWS"}else if(x.isColHeaderArea()){A="COLUMNS"}else{A="DATA"}R=e.getRow();i=e.getCol()}var y=c.getOnSelectCommand();y=y.replace("__ROW__",R+"");y=y.replace("__COL__",i+"");y=y.replace("__AXIS__",A);w(y,true)};this.resetColWidths=function(e,U,L){var E=e.getCol()+e.getColSpan()-1;var i=0;var x=e.getCol()+e.getColSpan()-e.getEffectiveColSpan();for(i=E;i>=x;i--){U.resetColWidth(i);L.resetColWidth(i);U.setUserResizedCol(i);L.setUserResizedCol(i)}};this.doColResize=function(e){var U=e.getArea();if(U.isColHeaderArea()){var d=c.getDataArea();this.resetColWidths(e,U,d)}else if(U.isDimHeaderArea()){var r=c.getRowHeaderArea();this.resetColWidths(e,U,r)}c.invalidate()};this.executeOnDblClickAction=function(e){var i=e.target.id;var x=u(i);var y;if(x==="resi"){y=v(i);t.doColResize(y);sap.zen.crosstab.utils.Utils.cancelEvent(e)}};this.rowSelectAction=function(R,S,A,e){var i=0;var x=null;var y=S+A.getRenderColCnt();for(i=S;i<y;i++){x=A.getCell(R,i);if(x){var z=$('#'+x.getId());if(z&&z.length>0){e(z,x)}}}};this.colSelectAction=function(S,i,A,e){var R=0;var x=null;var y=S+A.getRenderRowCnt();for(R=S;R<y;R++){x=A.getCell(R,i);if(x){var z=$('#'+x.getId());if(z&&z.length>0){e(z,x)}}}};this.setSelectionInfo=function(A,P){if(!s){s={};if(A==="ROWS"){s.sAreaType=sap.zen.crosstab.rendering.RenderingConstants.TYPE_ROW_HEADER_AREA}else if(A==="COLUMNS"){s.sAreaType=sap.zen.crosstab.rendering.RenderingConstants.TYPE_COLUMN_HEADER_AREA}}if(A&&s){if(A==="ROWS"){if(s.sAreaType===sap.zen.crosstab.rendering.RenderingConstants.TYPE_ROW_HEADER_AREA){s.iRow=P}else{this.resetSelection()}}else if(A==="COLUMNS"){if(s.sAreaType===sap.zen.crosstab.rendering.RenderingConstants.TYPE_COLUMN_HEADER_AREA){s.iCol=P}else{this.resetSelection()}}else{this.resetSelection()}}else{this.resetSelection()}};this.setSingleDataCellSelectionInfo=function(R,i){if(!s){s={}}if(R>-1&&i>-1){s.iRow=R;s.iCol=i;s.sAreaType=sap.zen.crosstab.rendering.RenderingConstants.TYPE_DATA_AREA}else{this.resetSelection()}};this.setHighlightingInfo=function(H){h=H};this.getSelectedCellData=function(){return s};this.resetSelection=function(){s=null};this.setSelectedCell=function(e){if(e===null){s=null}else{if(!s){s={}}s.iRow=e.getRow();s.iCol=e.getCol();s.sAreaType=e.getArea().getAreaType()}};this.getSelectedCell=function(){var e=null;if(s){var A=sap.zen.crosstab.BaseArea.getArea(c,s.sAreaType);if(s.iCol===undefined){var i=A.getColCnt()-1;while(i>=0&&!e){e=A.getCell(s.iRow,i);if(e&&!((e.isSelectable&&e.isSelectable()))){e=null}i--}}else if(s.iRow===undefined){var R=A.getRowCnt()-1;while(R>=0&&!e){e=A.getCell(R,s.iCol);if(e&&!((e.isSelectable&&e.isSelectable()))){e=null}R--}}else{e=A.getCell(s.iRow,s.iCol)}}return e};this.restoreSelection=function(){var e=this.getSelectedCell();if(e&&((e.isSelectable&&e.isSelectable()||c.isSingleDataCellSelection()&&e.getArea().isDataArea())||e.isLoading())){var F=j(true);this.applySelectionEffect(e,F);this.setSelectedCell(e)}else{this.setSelectedCell(null)}o=null};this.doHighlighting=function(e,A,G,x){var i=0;var y=e.length;for(i=0;i<y;i++){var z=null;var B=e[i].pos;var E=G(A);while(E>=0&&!z){z=x(B,E,A);if(z&&!((z.isSelectable&&z.isSelectable()))){z=null}E--}if(z){this.applySelectionEffect(z,l(true))}}};this.highlightCells=function(){if(h){var e=h.rows;if(e){this.doHighlighting(e,c.getRowHeaderArea(),function(A){return A.getColCnt()-1},function(x,y,A){return A.getCell(x,y)})}var i=h.cols;if(i){this.doHighlighting(i,c.getColumnHeaderArea(),function(A){return A.getRowCnt()-1},function(x,y,A){return A.getCell(y,x)})}}};this.applySelectionEffect=function(e,F){var A=e.getArea();var R=e.getRow();var i=e.getCol();var S=null;if(A.isRowHeaderArea()){S=e;while(S&&S.isSelectable&&S.isSelectable()&&i>=0){i--;if(i>=0){S=A.getCell(R,i)}else{S=null}}this.rowSelectAction(R,i+1,A,F.fRowHeaderCellActionFunclet);this.rowSelectAction(R,d.getRenderStartCol(),d,F.fDataCellActionFunclet)}else if(A.isColHeaderArea()){S=e;while(S&&S.isSelectable&&S.isSelectable()&&R>=0){R--;if(R>=0){S=A.getCell(R,i)}else{S=null}}this.colSelectAction(R+1,i,A,F.fColHeaderCellActionFunclet);this.colSelectAction(d.getRenderStartRow(),i,d,F.fDataCellActionFunclet)}else if(A.isDataArea()){if(e){var x=$('#'+e.getId());if(x&&x.length>0){F.fDataCellActionFunclet(x,e)}}}};function g(e){var S=null;var i=0;var x=sap.ui.getCore().getControl(e.target.id);var y=null;var z=null;if(x&&(x.isSelectable&&x.isSelectable()||c.isSingleDataCellSelection())){S=x}else{var P=$(e.target).parents("td");if(P){for(i=0;i<P.length;i++){y=$(P[i]);z=y.attr("id");if(z&&z.length>0){x=sap.ui.getCore().getControl(z);if(x&&(x.isSelectable&&x.isSelectable()||c.isSingleDataCellSelection())){S=x;break}}}}}return S}this.executeOnMouseEnter=function(e){if(!o){if(!c.isSingleDataCellSelection()){o=g(e)}else if(c.isSingleDataCellSelection()===true){var i=g(e);if(i&&i.getArea().isDataArea()){o=i}}if(o){var F=f(true);t.applySelectionEffect(o,F);sap.zen.crosstab.utils.Utils.cancelEvent(e)}}};this.removeHoverEffect=function(){if(o){var F=f(false);t.applySelectionEffect(o,F);o=null}};this.executeOnMouseOut=function(e){if(o){var i=e.toElement||e.relatedTarget;var x=e.target;var F=null;var y=sap.ui.getCore().getControl(e.target.id);var z=null;var R=false;if(y&&(y.isSelectable&&y.isSelectable()||c.isSingleDataCellSelection()&&y.getArea().isDataArea())){if(y===o){F=$(x).find($(i));if(!(F&&F.length>0)){R=true}}}else{z=$('#'+o.getId());F=z.find($(x));if(F&&F.length>0){F=z.find($(i));if(!(F&&F.length>0)){R=true}}}if(R){t.removeHoverEffect();sap.zen.crosstab.utils.Utils.cancelEvent(e)}}};function f(H){var F={};if(H){F.fDataCellActionFunclet=function(e,i){e.addClass('sapzencrosstab-HoverDataCell');if(e.hasClass('sapzencrosstab-HighlightDataCell')){e.removeClass('sapzencrosstab-HighlightDataCell');i.bRestoreHighlight=true}};F.fRowHeaderCellActionFunclet=function(e,i){e.addClass('sapzencrosstab-HoverRowHeaderCell');if(e.hasClass('sapzencrosstab-HighlightRowHeaderCell')){e.removeClass('sapzencrosstab-HighlightRowHeaderCell');i.bRestoreHighlight=true}};F.fColHeaderCellActionFunclet=function(e,i){e.addClass('sapzencrosstab-HoverColHeaderCell');if(e.hasClass('sapzencrosstab-HighlightColHeaderCell')){e.removeClass('sapzencrosstab-HighlightColHeaderCell');i.bRestoreHighlight=true}}}else{F.fDataCellActionFunclet=function(e,i){e.removeClass('sapzencrosstab-HoverDataCell');if(i.bRestoreHighlight===true){i.bRestoreHighlight=false;e.addClass('sapzencrosstab-HighlightDataCell')}};F.fRowHeaderCellActionFunclet=function(e,i){e.removeClass('sapzencrosstab-HoverRowHeaderCell');if(i.bRestoreHighlight===true){i.bRestoreHighlight=false;e.addClass('sapzencrosstab-HighlightRowHeaderCell')}};F.fColHeaderCellActionFunclet=function(e,i){e.removeClass('sapzencrosstab-HoverColHeaderCell');if(i.bRestoreHighlight===true){i.bRestoreHighlight=false;e.addClass('sapzencrosstab-HighlightColheaderCell')}}}return F}function j(S){var F={};if(S){F.fDataCellActionFunclet=function(e,i){e.addClass('sapzencrosstab-SelectDataCell');e.removeClass('sapzencrosstab-HighlightDataCell');i.bRestoreHighlight=false};F.fRowHeaderCellActionFunclet=function(e,i){e.addClass('sapzencrosstab-SelectRowHeaderCell');e.removeClass('sapzencrosstab-HighlightRowHeaderCell');i.bRestoreHighlight=false};F.fColHeaderCellActionFunclet=function(e,i){e.addClass('sapzencrosstab-SelectColHeaderCell');e.removeClass('sapzencrosstab-HighlightColHeaderCell');i.bRestoreHighlight=false}}else{F.fDataCellActionFunclet=function(e,i){e.removeClass('sapzencrosstab-SelectDataCell')};F.fRowHeaderCellActionFunclet=function(e,i){e.removeClass('sapzencrosstab-SelectRowHeaderCell')};F.fColHeaderCellActionFunclet=function(e,i){e.removeClass('sapzencrosstab-SelectColHeaderCell')}}return F}function l(H){var F={};if(H){F.fDataCellActionFunclet=function(e,i){e.addClass('sapzencrosstab-HighlightDataCell')};F.fRowHeaderCellActionFunclet=function(e,i){e.addClass('sapzencrosstab-HighlightRowHeaderCell')};F.fColHeaderCellActionFunclet=function(e,i){e.addClass('sapzencrosstab-HighlightColHeaderCell')}}else{F.fDataCellActionFunclet=function(e,i){e.removeClass('sapzencrosstab-HighlightDataCell')};F.fRowHeaderCellActionFunclet=function(e,i){e.removeClass('sapzencrosstab-HighlightRowHeaderCell')};F.fColHeaderCellActionFunclet=function(e,i){e.removeClass('sapzencrosstab-HighlightColHeaderCell')}}return F}this.attachEvents=function(){var i=$("#"+c.getId()+"_renderSizeDiv");i.unbind("dblclick");i.bind("dblclick",this.executeOnDblClickAction);i.unbind("mousedown");i.bind("mousedown",this.executeOnMouseDown);if(c.getPropertyBag().isMobileMode()||c.getPropertyBag().isTestMobileMode()){i.unbind('click');i.bind('click',function(e){sap.zen.crosstab.utils.Utils.cancelEvent(e)});i.unbind('mousedown');i.bind('mousedown',function(e){sap.zen.crosstab.utils.Utils.cancelEvent(e)});T=new sap.zen.crosstab.TouchHandler(this,c);T.registerTouchEvents(i);k.setEnabled(false)}else{i.unbind("mouseup",this.executeOnMouseUp);i.bind("mouseup",this.executeOnMouseUp);i.unbind('click');i.bind('click',this.executeOnClickAction);if(c.getPropertyBag().isSelectionEnabled()){i.unbind('mouseover');i.bind('mouseover',this.executeOnMouseEnter);i.unbind('mouseout');i.bind('mouseout',this.executeOnMouseOut)}k.setEnabled(n());k.attachEvents(i)}};this.executeOnMouseDown=function(e){var i=e.target.id;var x=u(i);if(x==="resi"){sap.zen.crosstab.utils.Utils.cancelEvent(e)}else{m=i}};function n(){return(c.getTransferDataCommand()&&c.getTransferDataCommand()!=="")}function q(i,e){var I=false;var x=$('#'+i)[0];if(x){var R=x.getBoundingClientRect();var H=(R.left<e.clientX)&&(e.clientX<R.right);var V=(R.bottom>e.clientY)&&(e.clientY>R.top);I=H&&V}return I}this.executeOnMouseUp=function(e){p=false;if(m){var i=t.getCellIdFromContenDivId(m);if(q(i,e)){var x=sap.ui.getCore().getControl(i);if(x){if(n()){var y=$('#'+m)[0];var P=null;if(y){P=c.getUtils().getSelectionParams(y)}if(P.iSelectionStartPos>=0||P.iSelectionEndPos>=0){p=true;t.handleInputEnabledCell(e.target.id,P.iSelectionStartPos,P.iSelectionEndPos)}}}}else{sap.zen.crosstab.utils.Utils.cancelEvent(e);sap.zen.crosstab.utils.Utils.stopEventPropagation(e);p=true}}};this.restoreFocusOnCell=function(){k.restoreFocusOnCell()};function u(i){var A=i.slice(0,4);return A}function v(i){var e=i.slice(5);return sap.ui.getCore().getControl(e)}function w(A,e){if(A){if(!e){}var i=new Function(A);i()}}}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.RowHeaderArea')){jQuery.sap.declare("sap.zen.crosstab.RowHeaderArea");sap.zen.crosstab.RowHeaderArea=function(c){"use strict";sap.zen.crosstab.BaseArea.call(this,c);this.sAreaType=sap.zen.crosstab.rendering.RenderingConstants.TYPE_ROW_HEADER_AREA;this.iRenderStartRow=0;this.iRenderRowCnt=0;this.bLastPageLoaded=false};sap.zen.crosstab.RowHeaderArea.prototype=jQuery.sap.newObject(sap.zen.crosstab.BaseArea.prototype);sap.zen.crosstab.RowHeaderArea.prototype.renderArea=function(r){var c="sapzencrosstab-RowHeaderArea";if(this.oCrosstab.getPropertyBag().isMobileMode()){c+=" sapzencrosstab-MobileHeaderSeparator"}this.renderContainerStructure(r,c,this.oCrosstab.isVCutOff(),false)}};if(!jQuery.sap.isDeclared('sap.zen.crosstab.Crosstab')){jQuery.sap.declare("sap.zen.crosstab.Crosstab");jQuery.sap.require('sap.ui.core.Control');sap.ui.core.Control.extend("sap.zen.crosstab.Crosstab",{metadata:{library:"sap.zen.crosstab",properties:{"width":{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:null},"height":{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:null}}}});sap.zen.crosstab.Crosstab.prototype.init=function(){"use strict";this.scrolled=false;this.ensureIndexOf();var c=this.getId();var d=c+"_dataArea";this.dataArea=new sap.zen.crosstab.DataArea(this);this.dataArea.setId(d);var C=c+"_colHeaderArea";this.columnHeaderArea=new sap.zen.crosstab.ColumnHeaderArea(this);this.columnHeaderArea.setId(C);var r=c+"_rowHeaderArea";this.rowHeaderArea=new sap.zen.crosstab.RowHeaderArea(this);this.rowHeaderArea.setId(r);var D=c+"_dimHeaderArea";this.dimensionHeaderArea=new sap.zen.crosstab.DimensionHeaderArea(this);this.dimensionHeaderArea.setId(D);this.oPropertyBag=new sap.zen.crosstab.PropertyBag(this);this.oRenderEngine=new sap.zen.crosstab.rendering.RenderEngine(this);this.oEventHandler=new sap.zen.crosstab.EventHandler(this);this.oUtils=new sap.zen.crosstab.utils.Utils(this);this.iCalculatedWidth=-1;this.iCalculatedHeight=-1;this.fPageRequestHandler=null;this.bOnAfterRendering=true;this.bIsVResize=false;this.bIsHResize=false;this.iHierarchyIndentWidth=0;this.iHierarchyIndentHeight=0;this.iExceptionSymbolWidth=0;this.iRenderMode=sap.zen.crosstab.rendering.RenderingConstants.RENDERMODE_COMPACT;this.bRenderScrollbars=true;this.bHCutOff=false;this.bVCutOff=false;this.sOnSelectCommand=null;this.sTransferDataCommand=null;this.sCallValueHelpCommand=null;this.iTotalRowCnt=0;this.iTotalColCnt=0;this.oHScrollbar=null;this.oVScrollbar=null;this.oHorizontalHeaderScrollbar=null;this.iTimeoutCounter=0;this.oColHeaderHierarchyLevels={};this.oRowHeaderHierarchyLevels={};this.oTestProxy=new sap.zen.crosstab.CrosstabTestProxy(this,this.oEventHandler,this.oRenderEngine);this.bAdjustFrameDivs=true;this.iSavedWidthForPrepareDom=0;this.iSavedHeightForPrepareDom=0;this.bDataSelectionMode=false;this.oCellApi=null;this.iNewLinesCnt=0;this.sNewLinesPos="";this.bPlanningCheckMode=false;this.sScrollNotifyCommand=null;this.oContextMenu=null;this.iValueHelpStatus=0;this.bHeaderHScrolling=false;this.bWasRendered=false};sap.zen.crosstab.Crosstab.prototype.ensureIndexOf=function(){if(!Array.prototype.indexOf){Array.prototype.indexOf=function(s){"use strict";if(this==null){throw new TypeError()}var t=Object(this);var l=t.length>>>0;if(l===0){return-1}var n=0;if(arguments.length>1){n=Number(arguments[1]);if(n!=n){n=0}else if(n!=0&&n!=Infinity&&n!=-Infinity){n=(n>0||-1)*Math.floor(Math.abs(n))}}if(n>=l){return-1}var k=n>=0?n:Math.max(l-Math.abs(n),0);for(;k<l;k++){if(k in t&&t[k]===s){return k}}return-1}}};sap.zen.crosstab.Crosstab.prototype.getTableDiv=function(){var t=null;if(this.iRenderMode===sap.zen.crosstab.rendering.RenderingConstants.RENDERMODE_COMPACT){t=$('#'+this.getId()+"_altRenderModeTableDiv")}else{t=$('#'+this.getId())}return t};sap.zen.crosstab.Crosstab.prototype.ensurePageManager=function(){if(!this.oPageManager){this.oPageManager=new sap.zen.crosstab.paging.PageManager(this)}return this.oPageManager};sap.zen.crosstab.Crosstab.prototype.getIntWidth=function(){var w=-1;var W=this.getWidth();if(W&&W!=="auto"){w=parseInt(W,10)}else{w=this.iCalculatedWidth}return w};sap.zen.crosstab.Crosstab.prototype.getContentWidth=function(){var w=this.getIntWidth();var t=this.getRenderEngine().getTableDivValues();w=w-t.borders.iLeftBorderWidth-t.borders.iRightBorderWidth;return w};sap.zen.crosstab.Crosstab.prototype.getContentHeight=function(){var h=this.getIntHeight();var t=this.getRenderEngine().getTableDivValues();var T=this.oPropertyBag.getToolbarHeight();h=h-t.borders.iTopBorderWidth-t.borders.iBottomBorderWidth-T;return h};sap.zen.crosstab.Crosstab.prototype.getIntHeight=function(){var h=-1;var H=this.getHeight();if(H&&H!=="auto"){h=parseInt(H,10)}else{h=this.iCalculatedHeight}return h};sap.zen.crosstab.Crosstab.prototype.resize=function(e){var d=jQuery.sap.byId(this.getId());var n=parseInt(d.outerWidth(),10);var N=parseInt(d.outerHeight(),10);this.isHResize=n!==this.getIntWidth();this.isVResize=N!==this.getIntHeight();if(this.isHResize||this.isVResize){this.ensurePageManager().resizeEvent()}};sap.zen.crosstab.Crosstab.prototype.determineRenderMode=function(c){var n=-1;if(c){if(c.alwaysfill){n=sap.zen.crosstab.rendering.RenderingConstants.RENDERMODE_FILL}else{n=sap.zen.crosstab.rendering.RenderingConstants.RENDERMODE_COMPACT}}if(n===-1){n=sap.zen.crosstab.rendering.RenderingConstants.RENDERMODE_COMPACT}if(n!==this.iRenderMode){this.oRenderEngine.reset();this.iRenderMode=n}};sap.zen.crosstab.Crosstab.prototype.determineScrollMode=function(c){var n=c.pixelscrolling;if(n!==this.oPropertyBag.isPixelScrolling()){this.oRenderEngine.reset();this.oPropertyBag.setPixelScrolling(n)}};sap.zen.crosstab.Crosstab.prototype.applyControlProperties=function(c){this.bPlanningCheckMode=c.pvcheck!==null&&c.pvcheck!==undefined;var i=this.ensurePageManager().checkResponseConsistency(c);if(!i){this.reset(c)}if(!this.bPlanningCheckMode){this.determineRenderMode(c);this.determineScrollMode(c);this.ensurePageManager().receiveData(c)}else{this.handlePlanningCheckData(c)}this.bPlanningCheckMode=false};sap.zen.crosstab.Crosstab.prototype.calculateOffset=function(c){var o=0;var a=c.getArea();if(a.isRowHeaderArea()){for(var i=0;i<c.getCol();i++){var t=a.getCell(c.getRow(),i);if(!t){o++}else if(!t.isEntryEnabled()){o++}}}return o};sap.zen.crosstab.Crosstab.prototype.calculateRowHeaderColOffsetsForRow=function(t){var c={};var T=0;var C=null;var e=0;var m=this.rowHeaderArea.getColCnt();for(T=0;T<m;T++){C=this.getTableCell(t,T);if(C!==null&&C.isEntryEnabled()){c[e]=T;e++}}return c};sap.zen.crosstab.Crosstab.prototype.handlePlanningCheckData=function(c){var i=0;var C=c.pvcheck;var a=C.length;var o={};var b=null;var t=0;for(i=0;i<a;i++){var d=C[i];b=o[d.tabrow];if(!b){b=this.calculateRowHeaderColOffsetsForRow(d.tabrow);o[d.tabrow]=b}var t=b[d.tabcol]||d.tabcol;var e=this.getTableCell(d.tabrow,t);if(e){e.setText(d.text);if(d.valid===false){e.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_INVALID_VALUE)}else{e.removeStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_INVALID_VALUE)}if(d.newvalue===true){e.addStyle(sap.zen.crosstab.rendering.RenderingConstants.STYLE_NEW_VALUE)}this.oRenderEngine.updateRenderingOfInputCellAfterCheck(e)}}};sap.zen.crosstab.Crosstab.prototype.determineKeepUserColWidths=function(c){if(c.dataproviderchanged){return false}if(c.resultsetchanged&&c.rootcause===undefined){return false}return true};sap.zen.crosstab.Crosstab.prototype.determineKeepCalculatedColWidths=function(c){var v=(c.v_pos||1)-1;var s=c.sentdatarows||0;var C=c.clientvpos||0;var t=c.totaldatarows||0;var h=(c.h_pos||1)-1;var S=c.sentdatacols||0;var i=c.clienthpos||0;var T=c.totaldatacols||0;var I=c.ispaging||false;var k=false;var K=false;if(this.bWasRendered===true&&!I){if((C>0)&&(C<=t)&&(C>(v+s))){K=true}if((i>0)&&(i<=T)&&(i>(h+S))){k=true}if(K===true||k===true){return true}}return false};sap.zen.crosstab.Crosstab.prototype.reset=function(c){var k=this.determineKeepUserColWidths(c);var K=this.determineKeepCalculatedColWidths(c);this.getDimensionHeaderArea().clear(k,K);this.getColumnHeaderArea().clear(k,K);this.getRowHeaderArea().clear(k,K);this.getDataArea().clear(k,K);this.oRenderEngine.reset();this.oPageManager.reset()};sap.zen.crosstab.Crosstab.prototype.updateControlProperties=function(c){if(c&&c.changed){this.reset(c)}this.applyControlProperties(c)};sap.zen.crosstab.Crosstab.prototype.expectOnAfterRenderingCall=function(){this.bOnAfterRendering=false};sap.zen.crosstab.Crosstab.prototype.onAfterRendering=function(){if(this.bOnAfterRendering||((typeof sap.zen.Dispatcher!='undefined')&&sap.zen.Dispatcher.instance.isDeferredRendering())){this.doRendering()}};sap.zen.crosstab.Crosstab.prototype.setSelectionInfo=function(a,p){this.oEventHandler.setSelectionInfo(a,p)};sap.zen.crosstab.Crosstab.prototype.setHighlightingInfo=function(h){this.oEventHandler.setHighlightingInfo(h)};sap.zen.crosstab.Crosstab.prototype.getSelectedCellData=function(){return this.oEventHandler.getSelectedCellData()};sap.zen.crosstab.Crosstab.prototype.restoreSelection=function(){this.oEventHandler.restoreSelection()};sap.zen.crosstab.Crosstab.prototype.restoreFocusOnCell=function(){this.oEventHandler.restoreFocusOnCell()};sap.zen.crosstab.Crosstab.prototype.highlightCells=function(){this.oEventHandler.highlightCells()};sap.zen.crosstab.Crosstab.prototype.prepareExistingDom=function(){if(!this.bPlanningCheckMode){var d=$('#'+this.getDimensionHeaderArea().getId()).find("tbody");d.empty();d=$('#'+this.getRowHeaderArea().getId()).find("tbody");d.empty();d=$('#'+this.getColumnHeaderArea().getId()).find("tbody");d.empty();d=$('#'+this.getDataArea().getId()).find("tbody");d.empty();this.bRenderScrollbars=false;this.determineNeedToAdjustOuterDivs()}};sap.zen.crosstab.Crosstab.prototype.determineNeedToAdjustOuterDivs=function(){var w=this.getIntWidth();var h=this.getIntHeight();this.bAdjustFrameDivs=true;if(w===this.iSavedWidthForPrepareDom&&h===this.iSavedHeightForPrepareDom){this.bAdjustFrameDivs=false}else{this.getRenderEngine().removeOuterDivBorders()}if(!this.getDataArea().hasLoadingPages()){this.iSavedWidthForPrepareDom=w;this.iSavedHeightForPrepareDom=h}};sap.zen.crosstab.Crosstab.prototype.determineHierarchyIndents=function(){var d=$('#'+this.getId()+"_measureDiv");if(d&&d.length>0){d.css("visibility","visible");this.iHierarchyIndentWidth=parseInt(d.outerWidth(),10);this.iHierarchyIndentHeight=parseInt(d.outerHeight(),10);d.css("visibility","none")}};sap.zen.crosstab.Crosstab.prototype.determineAlertSymbolDimensions=function(){var d=$('#'+this.getId()+"_exceptionMeasureDiv");if(d&&d.length>0){d.css("visibility","visible");this.iExceptionSymbolWidth=parseInt(d.outerWidth(),10);d.css("visibility","none")}};sap.zen.crosstab.Crosstab.prototype.isRenderingPossible=function(){if((typeof sap.zen.Dispatcher!='undefined')&&sap.zen.Dispatcher.instance.suppressRendering()){if(!sap.zen.Dispatcher.instance.isSingleDelta(this.getId())){sap.zen.Dispatcher.instance.registerForDeferredRendering(this);return false}}var e=[];e.push($('#'+this.getId()));e.push($('#'+this.getId()+'_upperSection'));e.push($('#'+this.getId()+'_lowerSection'));e.push($('#'+this.getId()+'_dimHeaderArea'));e.push($('#'+this.getId()+'_colHeaderArea'));e.push($('#'+this.getId()+'_dataArea'));for(var i=0;i<e.length;i++){if(e[i].length!==1){this.bOnAfterRendering=true;return false}}return true};sap.zen.crosstab.Crosstab.prototype.determineCrosstabSize=function(){var s={};s.bContinueRendering=true;s.bAutoHeight=false;s.bAutoWidth=false;if(!this.getWidth()||!this.getHeight()){s.bContinueRendering=false}else{if(this.getWidth()==="auto"){s.bAutoWidth=true;var w=jQuery.sap.byId(this.getId()).parent().outerWidth();if(w&&w>0){this.iCalculatedWidth=w}}if(this.getHeight()==="auto"){s.bAutoHeight=true;var h=jQuery.sap.byId(this.getId()).parent().outerHeight();if(h&&h>0){this.iCalculatedHeight=h}}}return s};sap.zen.crosstab.Crosstab.prototype.doRendering=function(){if(this.bPlanningCheckMode===true){return}if(!this.isRenderingPossible()){return}var s=this.determineCrosstabSize();if(!s.bContinueRendering){return}if((s.bAutoWidth&&this.iCalculatedWidth<=10)||(s.bAutoHeight&&this.iCalculatedHeight<=10)){this.iTimeoutCounter++;if(this.iTimeoutCounter>1000){return}setTimeout((function(a){return function(){a.doRendering()}})(this),10);return}this.determineHierarchyIndents();if(this.getPropertyBag().isDisplayExceptions()){this.determineAlertSymbolDimensions()}var r=this.getRenderEngine();r.setAdjustFrameDivs(this.bAdjustFrameDivs);if(r.hasCrosstabSizeChanged()){this.ensurePageManager().resizeEvent()}if(this.oPropertyBag.hasToolbar()){var t=$('#'+this.getId()+"_toolbar");var T=t.outerHeight();this.oPropertyBag.setToolbarHeight(T)}r.beginRendering();r.renderDimensionHeaderArea();r.setUserColWidths(this.getDimensionHeaderArea());r.renderRowHeaderArea(this.getRowHeaderArea().getRenderStartRow());r.setUserColWidths(this.getRowHeaderArea());r.adjustColWidths(this.getDimensionHeaderArea(),this.getRowHeaderArea());r.forceHeaderWidth();r.renderColHeaderArea(this.getColumnHeaderArea().getRenderStartCol());r.setUserColWidths(this.getColumnHeaderArea());r.renderDataArea();r.setUserColWidths(this.getDataArea());r.adjustColWidths(this.getColumnHeaderArea(),this.getDataArea());r.adjustRowHeights(this.getDimensionHeaderArea(),this.getColumnHeaderArea());r.adjustRowHeights(this.getRowHeaderArea(),this.getDataArea());r.calculateRenderSizeDivSize();if(!this.oPropertyBag.isPixelScrolling()){r.appendColumnsAfterResize();r.appendRowsAfterResize()}if(this.bRenderScrollbars){r.renderScrollbars()}r.adjustRenderSizeDivSize();if(this.bRenderScrollbars){r.setScrollbarSteps()}r.adjustScrollDivSizes();if(!this.bRenderScrollbars){r.checkScrollbarSize()}r.adjustScrollPositions(this.bRenderScrollbars);if(!this.oPropertyBag.isPixelScrolling()){r.moveScrollDivs()}r.updateHeaderScrollbarSizes();r.finishRendering();this.oEventHandler.attachEvents();this.bOnAfterRendering=true;this.bRenderScrollbars=true;this.bAdjustFrameDivs=true;this.bWasRendered=true};sap.zen.crosstab.Crosstab.prototype.scrollHorizontal=function(c){this.oRenderEngine.scrollHorizontal(c)};sap.zen.crosstab.Crosstab.prototype.scrollVertical=function(r){this.oRenderEngine.scrollVertical(r)};sap.zen.crosstab.Crosstab.prototype.scrollHeaderHorizontal=function(p){this.oRenderEngine.scrollHeaderHorizontal(p)};sap.zen.crosstab.Crosstab.prototype.getVScrollPos=function(){var v=-1;if(this.oVScrollbar){v=this.oVScrollbar.getScrollPosition()}return v};sap.zen.crosstab.Crosstab.prototype.getHScrollPos=function(){var h=-1;if(this.oHScrollbar){h=this.oHScrollbar.getScrollPosition()}return h};sap.zen.crosstab.Crosstab.prototype.renderResizeOutline=function(){this.oRenderEngine.renderResizeOutline()};sap.zen.crosstab.Crosstab.prototype.removeResizeOutline=function(){this.oRenderEngine.removeResizeOutline()};sap.zen.crosstab.Crosstab.prototype.registerPageRequestHandler=function(h){this.fPageRequestHandler=h};sap.zen.crosstab.Crosstab.prototype.unregisterPageRequestHandler=function(){this.fPageRequestHandler=null};sap.zen.crosstab.Crosstab.prototype.getPageRequestHandler=function(){return this.fPageRequestHandler};sap.zen.crosstab.Crosstab.prototype.getReceivedPages=function(){return this.ensurePageManager().getReceivedPages()};sap.zen.crosstab.Crosstab.prototype.getHierarchyIndentWidth=function(){return this.iHierarchyIndentWidth};sap.zen.crosstab.Crosstab.prototype.getExceptionSymbolWidth=function(){return this.iExceptionSymbolWidth};sap.zen.crosstab.Crosstab.prototype.getHierarchyIndentHeight=function(){return this.iHierarchyIndentHeight};sap.zen.crosstab.Crosstab.prototype.hideLoadingIndicator=function(){this.oRenderEngine.hideLoadingIndicator()};sap.zen.crosstab.Crosstab.prototype.showLoadingIndicator=function(){this.oRenderEngine.showLoadingIndicator()};sap.zen.crosstab.Crosstab.prototype.setHCutOff=function(h){this.bHCutOff=h};sap.zen.crosstab.Crosstab.prototype.isHCutOff=function(){return this.bHCutOff};sap.zen.crosstab.Crosstab.prototype.setVCutOff=function(v){this.bVCutOff=v};sap.zen.crosstab.Crosstab.prototype.isVCutOff=function(){return this.bVCutOff};sap.zen.crosstab.Crosstab.prototype.getTotalRows=function(){return this.iTotalRowCnt};sap.zen.crosstab.Crosstab.prototype.getTotalCols=function(){return this.iTotalColCnt};sap.zen.crosstab.Crosstab.prototype.setTotalCols=function(c){this.iTotalColCnt=c};sap.zen.crosstab.Crosstab.prototype.setTotalRows=function(r){this.iTotalRowCnt=r};sap.zen.crosstab.Crosstab.prototype.setHScrollbar=function(h){this.oHScrollbar=h};sap.zen.crosstab.Crosstab.prototype.setVScrollbar=function(v){this.oVScrollbar=v};sap.zen.crosstab.Crosstab.prototype.getVScrollbar=function(){return this.oVScrollbar};sap.zen.crosstab.Crosstab.prototype.getHScrollbar=function(){return this.oHScrollbar};sap.zen.crosstab.Crosstab.prototype.getTestProxy=function(){return this.oTestProxy};sap.zen.crosstab.Crosstab.prototype.setOnSelectCommand=function(o){this.sOnSelectCommand=o};sap.zen.crosstab.Crosstab.prototype.getOnSelectCommand=function(){return this.sOnSelectCommand};sap.zen.crosstab.Crosstab.prototype.setTransferDataCommand=function(t){this.sTransferDataCommand=t};sap.zen.crosstab.Crosstab.prototype.getTransferDataCommand=function(){return this.sTransferDataCommand};sap.zen.crosstab.Crosstab.prototype.setCallValueHelpCommand=function(c){this.sCallValueHelpCommand=c};sap.zen.crosstab.Crosstab.prototype.getCallValueHelpCommand=function(){return this.sCallValueHelpCommand};sap.zen.crosstab.Crosstab.prototype.getRenderMode=function(){return this.iRenderMode};sap.zen.crosstab.Crosstab.prototype.getUtils=function(){return this.oUtils};sap.zen.crosstab.Crosstab.prototype.getDataArea=function(){return this.dataArea};sap.zen.crosstab.Crosstab.prototype.getDimensionHeaderArea=function(){return this.dimensionHeaderArea};sap.zen.crosstab.Crosstab.prototype.getColumnHeaderArea=function(){return this.columnHeaderArea};sap.zen.crosstab.Crosstab.prototype.getRowHeaderArea=function(){return this.rowHeaderArea};sap.zen.crosstab.Crosstab.prototype.getRenderEngine=function(){return this.oRenderEngine};sap.zen.crosstab.Crosstab.prototype.hResize=function(){return this.isHResize};sap.zen.crosstab.Crosstab.prototype.vResize=function(){return this.isVResize};sap.zen.crosstab.Crosstab.prototype.getPageManager=function(){return this.oPageManager};sap.zen.crosstab.Crosstab.prototype.isRenderScrollbars=function(){return this.bRenderScrollbars};sap.zen.crosstab.Crosstab.prototype.getPropertyBag=function(){return this.oPropertyBag};sap.zen.crosstab.Crosstab.prototype.hasToolbar=function(){return this.bHasToolbar};sap.zen.crosstab.Crosstab.prototype.setColHeaderHierarchyLevels=function(l){this.oColHeaderHierarchyLevels=l};sap.zen.crosstab.Crosstab.prototype.getColHeaderHierarchyLevels=function(){return this.oColHeaderHierarchyLevels};sap.zen.crosstab.Crosstab.prototype.setRowHeaderHierarchyLevels=function(l){this.oRowHeaderHierarchyLevels=l};sap.zen.crosstab.Crosstab.prototype.getRowHeaderHierarchyLevels=function(){return this.oRowHeaderHierarchyLevels};sap.zen.crosstab.Crosstab.prototype.isIE8Mode=function(){return this.oRenderEngine.isIE8Mode()};sap.zen.crosstab.Crosstab.prototype.hasDimensionHeaderArea=function(){var r=false;if(this.dimensionHeaderArea!==undefined){r=(this.dimensionHeaderArea.getColCnt()>0&&this.dimensionHeaderArea.getRowCnt()>0)}return r};sap.zen.crosstab.Crosstab.prototype.hasRowHeaderArea=function(){var r=false;if(this.rowHeaderArea!==undefined){r=(this.rowHeaderArea.getColCnt()>0&&this.rowHeaderArea.getRowCnt()>0)}return r};sap.zen.crosstab.Crosstab.prototype.hasColHeaderArea=function(){var r=false;if(this.columnHeaderArea!==undefined){r=(this.columnHeaderArea.getColCnt()>0&&this.columnHeaderArea.getRowCnt()>0)}return r};sap.zen.crosstab.Crosstab.prototype.hasDataArea=function(){var r=false;if(this.dataArea!==undefined){r=(this.dataArea.getColCnt()>0&&this.dataArea.getRowCnt()>0)}return r};sap.zen.crosstab.Crosstab.prototype.setDataSelectionMode=function(i){this.bDataSelectionMode=i};sap.zen.crosstab.Crosstab.prototype.isDataSelectionMode=function(){return this.bDataSelectionMode};sap.zen.crosstab.Crosstab.prototype.setSingleDataCellSelection=function(i){this.bSingleDataCellSelection=i};sap.zen.crosstab.Crosstab.prototype.isSingleDataCellSelection=function(){return this.bSingleDataCellSelection};sap.zen.crosstab.Crosstab.prototype.setSingleDataCellSelectionInfo=function(r,c){this.oEventHandler.setSingleDataCellSelectionInfo(r,c)};sap.zen.crosstab.Crosstab.prototype.getTableCell=function(t,T){return this.oCellApi.getTableCell(t,T)};sap.zen.crosstab.Crosstab.prototype.getTableCellWithSpans=function(r,c){return this.oCellApi.getTableCellWithSpans(r,c)};sap.zen.crosstab.Crosstab.prototype.getTableRowCnt=function(t,T){return this.oCellApi.getTableRowCnt()};sap.zen.crosstab.Crosstab.prototype.getTableColCnt=function(t,T){return this.oCellApi.getTableColCnt()};sap.zen.crosstab.Crosstab.prototype.getTableFixedRowHeaderColCnt=function(){return this.oCellApi.getTableFixedRowHeaderColCnt()};sap.zen.crosstab.Crosstab.prototype.getTableFixedColHeaderRowCnt=function(){return this.oCellApi.getTableFixedColHeaderRowCnt()};sap.zen.crosstab.Crosstab.prototype.getTableMaxScrollColCnt=function(){return this.oCellApi.getTableMaxScrollColCnt()};sap.zen.crosstab.Crosstab.prototype.getTableMaxScrollRowCnt=function(){return this.oCellApi.getTableMaxScrollRowCnt()};sap.zen.crosstab.Crosstab.prototype.setCellApi=function(p){this.oCellApi=p};sap.zen.crosstab.Crosstab.prototype.hasLoadingPages=function(){return this.dataArea.hasLoadingPages()||this.rowHeaderArea.hasLoadingPages()||this.columnHeaderArea.hasLoadingPages()};sap.zen.crosstab.Crosstab.prototype.getRenderRowCnt=function(){if(this.dataArea){return this.dataArea.getRenderRowCnt()}else if(this.rowHeaderArea){return this.rowHeaderArea.getRenderRowCnt()}};sap.zen.crosstab.Crosstab.prototype.getRenderStartRow=function(){if(this.dataArea){return this.dataArea.getRenderStartRow()}else if(this.rowHeaderArea){return this.rowHeaderArea.getRenderStartRow()}};sap.zen.crosstab.Crosstab.prototype.getRenderColCnt=function(){if(this.dataArea){return this.dataArea.getRenderColCnt()}else if(this.columnHeaderArea){return this.columnHeaderArea.getRenderColCnt()}};sap.zen.crosstab.Crosstab.prototype.getRenderStartCol=function(){if(this.dataArea){return this.dataArea.getRenderStartCol()}else if(this.columnHeaderArea){return this.columnHeaderArea.getRenderStartCol()}};sap.zen.crosstab.Crosstab.prototype.setNewLinesCnt=function(n){this.iNewLinesCnt=n};sap.zen.crosstab.Crosstab.prototype.getNewLinesCnt=function(){return this.iNewLinesCnt};sap.zen.crosstab.Crosstab.prototype.setNewLinesPos=function(n){this.sNewLinesPos=n};sap.zen.crosstab.Crosstab.prototype.getNewLinesPos=function(){return this.sNewLinesPos};sap.zen.crosstab.Crosstab.prototype.isNewLinesTop=function(){if(!this.sNewLinesPos){return false}return(this.sNewLinesPos==="TOP")};sap.zen.crosstab.Crosstab.prototype.isNewLinesBottom=function(){if(!this.sNewLinesPos){return false}return(this.sNewLinesPos==="BOTTOM")};sap.zen.crosstab.Crosstab.prototype.setScrollNotifyCommand=function(s){this.sScrollNotifyCommand=s};sap.zen.crosstab.Crosstab.prototype.getScrollNotifyCommand=function(){return this.sScrollNotifyCommand};sap.zen.crosstab.Crosstab.prototype.getContextMenuAction=function(c,d){var a=null;if(this.oContextMenu){a=this.oContextMenu.getContextMenuAction(c,d)}return a};sap.zen.crosstab.Crosstab.prototype.createContextMenu=function(){if(!this.oContextMenu){this.oContextMenu=new sap.zen.crosstab.CrosstabContextMenu(this)}};sap.zen.crosstab.Crosstab.prototype.setValueHelpStatus=function(v){this.iValueHelpStatus=v};sap.zen.crosstab.Crosstab.prototype.getValueHelpStatus=function(){return this.iValueHelpStatus};sap.zen.crosstab.Crosstab.prototype.getHorizontalHeaderScrollbar=function(){return this.oHorizontalHeaderScrollbar};sap.zen.crosstab.Crosstab.prototype.setHorizontalHeaderScrollbar=function(h){this.oHorizontalHeaderScrollbar=h};sap.zen.crosstab.Crosstab.prototype.setHeaderHScrolling=function(h){this.bHeaderHScrolling=h;if(!this.bHeaderHScrolling){this.oHorizontalHeaderScrollbar=null}};sap.zen.crosstab.Crosstab.prototype.isHeaderHScrolling=function(){return this.bHeaderHScrolling}};
